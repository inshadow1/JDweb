"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["9362"],{6932:function(e,n,t){t.r(n),t.d(n,{default:()=>h,frontMatter:()=>o,metadata:()=>r,assets:()=>c,toc:()=>a,contentTitle:()=>i});var r=JSON.parse('{"id":"npm \u5305/xlsx","title":"xlsx","description":"Create by fall on 06 02 2023","source":"@site/my-docs/npm \u5305/xlsx.md","sourceDirName":"npm \u5305","slug":"/npm \u5305/xlsx","permalink":"/docs/npm \u5305/xlsx","draft":false,"unlisted":false,"editUrl":"https://github.com/my-docs/npm \u5305/xlsx.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"webpack","permalink":"/docs/npm \u5305/webpack"},"next":{"title":"yarn","permalink":"/docs/npm \u5305/yarn"}}'),l=t("2676"),s=t("3663");let o={},i=void 0,c={},a=[{value:"xlsx",id:"xlsx",level:2},{value:"\u5BFC\u5165\u6587\u4EF6",id:"\u5BFC\u5165\u6587\u4EF6",level:3},{value:"\u5BFC\u51FA",id:"\u5BFC\u51FA",level:3},{value:"\u53C2\u8003\u6587\u7AE0",id:"\u53C2\u8003\u6587\u7AE0",level:2}];function d(e){let n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["Create by ",(0,l.jsx)(n.strong,{children:"fall"})," on 06 02 2023\r\nRecently revised in 06 02 2023"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"xlsx",children:"xlsx"}),"\n",(0,l.jsx)(n.p,{children:"\u8BE5\u63D2\u4EF6\u53EF\u4EE5\u7528\u4E8E\u5904\u7406 excel \u6587\u4EF6\uFF0C\u5B9E\u73B0 excel \u6587\u4EF6\u7684\u5BFC\u5165\u5BFC\u51FA"}),"\n",(0,l.jsx)(n.p,{children:"\u5176\u4E2D\u6709\u4E24\u4E2A\u91CD\u8981\u7684\u5BF9\u8C61"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"WorkBook \u6574\u4E2A\u5DE5\u4F5C\u533A\uFF0C\u7C7B\u4F3C\u4E8E\u4E00\u4E2A excel \u6587\u4EF6\uFF0C\u5305\u62EC\u591A\u4E2A sheet"}),"\n",(0,l.jsx)(n.li,{children:"WorkSheet \u5355\u4E2A\u8868\u683C\uFF0C\u7C7B\u4F3C\u4E8E excel \u4E2D\u7684 sheet\uFF0C\u4EC5\u4E3A\u4E00\u4E2A\u8868\u683C"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u5BFC\u5165\u6587\u4EF6",children:"\u5BFC\u5165\u6587\u4EF6"}),"\n",(0,l.jsx)(n.p,{children:"\u4E00\u822C\u5BFC\u5165\u6587\u4EF6\u4F1A\u4F7F\u7528 input \u6807\u7B7E\uFF0C\u5E76\u5229\u7528 input \u6807\u7B7E\u4E0A\u7684 files \u5B9E\u73B0\u6587\u4EF6\u8BFB\u53D6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-jsx",children:"import XLSX from 'xlsx'\r\nfunction ExcelInport(){\r\n  async function onUploadFile(ev){\r\n    const file = ev.target.files[0]\r\n    const data = await file.arrayBuffer() // \u5C06 file \u8F6C\u6362\u4E3A ArrayBuffer\uFF0C\u4E8C\u8FDB\u5236\u6570\u636E\r\n    const wb = XLSX.read(data)\r\n    // wb \u4E0A\u9762\u603B\u5171\u6709\u4E24\u4E2A\u5BF9\u8C61\uFF0CSheetName\uFF0C\u5C31\u662F\u653E\u7F6E\u8868\u683C\u540D\u79F0\u7684\u6570\u7EC4\u3001Sheets\uFF0C\u5C31\u662F\u8868\u683C\u540D\u79F0\u5BF9\u5E94\u7684\u8868\u683C\r\n    const workSheet = wb.Sheets[wb.SheetNames[0]]\r\n    // \u751F\u6210 html \u6587\u4EF6\uFF0C\u5185\u5D4C\u5230\u9875\u9762\u4E2D\r\n    XLSX.utils.sheet_to_html(ws, { id: 'tabeller' })\r\n    // \u5C06\u4E8C\u8FDB\u5236\u8F6C\u6362\u4E3A JSON \u6570\u636E\uFF0C\u8FD9\u4E9B\u6570\u636E\u53EA\u6709\u8868\u683C\u4E2D\u7684\u5185\u5BB9\r\n    XLSX.utils.sheet_to_json(ws)\r\n  }\r\n  return <input id=\"excel\" onChange={(ev)=>onUploadFile(ev)}>\r\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5BFC\u51FA",children:"\u5BFC\u51FA"}),"\n",(0,l.jsx)(n.p,{children:"\u901A\u8FC7 table \u6807\u7B7E\u8FDB\u884C\u5BFC\u51FA"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:'const json = [\r\n  {name:"foo",age:42,creer:"manager"},\r\n  {name:"fall",age:24,creer:"developer"}\r\n]\r\nconst workSheet = XLSX.utils.json_to_sheet(json)\r\nconst wb = XLSX.utils.book_new()\r\nXLSX.book_append_sheet(wb,workSheet,\'sheetName\')\r\nXLSX.writeFile(wb,"\u65B0\u5EFAsheet.xlsx")\r\n\r\n/* \u901A\u8FC7\u6DFB\u52A0\u5230\u70B9\u51FB\u4E8B\u4EF6\u4E0A\uFF0C\u53EF\u4EE5\u751F\u6210 xlsx \u6587\u4EF6 */\r\nconst table = document.getElementById("tabeller");\r\nconst wb = XLSX.utils.table_to_book(table);\r\n/* \u5BFC\u51FA\u4E3A\u6587\u4EF6 */\r\nXLSX.writeFile(wb, "SheetJSIntro.xlsx");\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u53C2\u8003\u6587\u7AE0",children:"\u53C2\u8003\u6587\u7AE0"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u4F5C\u8005"}),(0,l.jsx)(n.th,{children:"\u94FE\u63A5"})]})}),(0,l.jsx)(n.tbody,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5199\u4EE3\u7801\u7684\u6D77\u602A"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://juejin.cn/post/6998000575203770376",children:"https://juejin.cn/post/6998000575203770376"})})]})})]})]})}function h(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},3663:function(e,n,t){t.d(n,{Z:function(){return i},a:function(){return o}});var r=t(5271);let l={},s=r.createContext(l);function o(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);