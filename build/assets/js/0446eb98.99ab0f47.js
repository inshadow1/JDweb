"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["9250"],{4934:function(e,n,r){r.r(n),r.d(n,{default:()=>h,frontMatter:()=>i,metadata:()=>t,assets:()=>c,toc:()=>o,contentTitle:()=>l});var t=JSON.parse('{"id":"\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9/5.4-\u7F51\u7AD9\u76D1\u63A7","title":"5.4-\u7F51\u7AD9\u76D1\u63A7","description":"Create by fall on 06 Feb 2025","source":"@site/my-docs/\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9/5.4-\u7F51\u7AD9\u76D1\u63A7.md","sourceDirName":"\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9","slug":"/\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9/5.4-\u7F51\u7AD9\u76D1\u63A7","permalink":"/docs/\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9/5.4-\u7F51\u7AD9\u76D1\u63A7","draft":false,"unlisted":false,"editUrl":"https://github.com/my-docs/\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9/5.4-\u7F51\u7AD9\u76D1\u63A7.md","tags":[],"version":"current","sidebarPosition":99,"frontMatter":{"sidebar_position":99},"sidebar":"tutorialSidebar","previous":{"title":"5.3-\u6027\u80FD\u6307\u6807\u3001\u4F18\u5316","permalink":"/docs/\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9/5.3-\u6027\u80FD\u6307\u6807\u3001\u4F18\u5316"},"next":{"title":"6.1-\u7F51\u7AD9\u5B89\u5168","permalink":"/docs/\u5927\u524D\u7AEF\u77E5\u8BC6\u70B9/6.1-\u7F51\u7AD9\u5B89\u5168"}}'),d=r("2676"),s=r("3663");let i={sidebar_position:99},l=void 0,c={},o=[{value:"\u7F51\u7AD9\u76D1\u63A7",id:"\u7F51\u7AD9\u76D1\u63A7",level:2},{value:"\u76D1\u63A7\u65B9\u5411",id:"\u76D1\u63A7\u65B9\u5411",level:3},{value:"\u76D1\u63A7\u6D41\u7A0B",id:"\u76D1\u63A7\u6D41\u7A0B",level:3},{value:"\u76D1\u63A7\u5B9E\u73B0",id:"\u76D1\u63A7\u5B9E\u73B0",level:2},{value:"\u6355\u83B7 js \u5F02\u5E38",id:"\u6355\u83B7-js-\u5F02\u5E38",level:3},{value:"\u9875\u9762\u662F\u5426\u767D\u5C4F",id:"\u9875\u9762\u662F\u5426\u767D\u5C4F",level:3},{value:"\u52A0\u8F7D\u65F6\u95F4",id:"\u52A0\u8F7D\u65F6\u95F4",level:3},{value:"\u9636\u6BB5\u542B\u4E49",id:"\u9636\u6BB5\u542B\u4E49",level:4},{value:"\u9636\u6BB5\u8BA1\u7B97",id:"\u9636\u6BB5\u8BA1\u7B97",level:4},{value:"\u6570\u636E\u7ED3\u6784",id:"\u6570\u636E\u7ED3\u6784",level:4},{value:"\u5B9E\u73B0",id:"\u5B9E\u73B0",level:4},{value:"\u4E3B\u8981\u6027\u80FD\u6307\u6807",id:"\u4E3B\u8981\u6027\u80FD\u6307\u6807",level:3},{value:"\u6570\u636E\u8BBE\u8BA1",id:"\u6570\u636E\u8BBE\u8BA1",level:4},{value:"\u5B9E\u73B0",id:"\u5B9E\u73B0-1",level:4},{value:"\u5361\u987F",id:"\u5361\u987F",level:3},{value:"\u6570\u636E\u8BBE\u8BA1",id:"\u6570\u636E\u8BBE\u8BA1-1",level:4},{value:"\u5B9E\u73B0",id:"\u5B9E\u73B0-2",level:4},{value:"PV\u3001UV\u3001\u7528\u6237\u505C\u7559\u65F6\u95F4",id:"pvuv\u7528\u6237\u505C\u7559\u65F6\u95F4",level:3},{value:"\u6570\u636E\u8BBE\u8BA1",id:"\u6570\u636E\u8BBE\u8BA1-2",level:4},{value:"\u5B9E\u73B0",id:"\u5B9E\u73B0-3",level:4},{value:"\u53C2\u8003\u6587\u7AE0",id:"\u53C2\u8003\u6587\u7AE0",level:2}];function a(e){let n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:["Create by ",(0,d.jsx)(n.strong,{children:"fall"})," on 06 Feb 2025\r\nRecently revised in 28 Feb 2025"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"\u7F51\u7AD9\u76D1\u63A7",children:"\u7F51\u7AD9\u76D1\u63A7"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u4E3B\u52A8\u53D1\u73B0\u95EE\u9898\u548C\u89E3\u51B3\u95EE\u9898"}),"\n",(0,d.jsx)(n.li,{children:"\u505A\u4EA7\u54C1\u7684\u51B3\u7B56\u4F9D\u636E"}),"\n",(0,d.jsx)(n.li,{children:"\u4E3A\u4E1A\u52A1\u6269\u5C55\u63D0\u4F9B\u4E86\u66F4\u591A\u53EF\u80FD\u6027"}),"\n",(0,d.jsx)(n.li,{children:"\u63D0\u5347\u524D\u7AEF\u5DE5\u7A0B\u5E08\u7684\u6280\u672F\u6DF1\u5EA6\u548C\u5E7F\u5EA6\uFF08\u7B80\u5386\u4EAE\u70B9\uFF09"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u76D1\u63A7\u65B9\u5411",children:"\u76D1\u63A7\u65B9\u5411"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u7CFB\u7EDF\u7A33\u5B9A\u6027"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u811A\u672C\u6267\u884C\u9519\u8BEF"}),"\n",(0,d.jsx)(n.li,{children:"\u8D44\u6E90\u9519\u8BEF\uFF08\u52A0\u8F7D\u5F02\u5E38"}),"\n",(0,d.jsx)(n.li,{children:"\u8BF7\u6C42\u5F02\u5E38"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u7528\u6237\u4F53\u9A8C"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"FID\uFF1Afirst input delay\uFF08\u9996\u6B21\u8F93\u5165\u5EF6\u8FDF\uFF09"}),"\n",(0,d.jsx)(n.li,{children:"FCP\uFF1A\u9996\u5C4F\u6E32\u67D3\u65F6\u95F4\uFF0C\u4E00\u822C\u9700\u8981\u5728\u4E00\u79D2\u5185"}),"\n",(0,d.jsx)(n.li,{children:"LCP\uFF1ALargest ContentFul Paint \uFF08\u6700\u5927\u5185\u5BB9\u7ED8\u5236\uFF09"}),"\n",(0,d.jsx)(n.li,{children:"TTI\uFF1ATime to Interreactive\uFF08\u53EF\u4EE5\u4F7F\u7528\u9875\u9762\u4E2D\u7684\u5185\u5BB9\u7684\u65F6\u95F4\uFF09"}),"\n",(0,d.jsx)(n.li,{children:"INP\uFF1AInteraction to Next Paint\uFF08\u4ECE\u8F93\u5165\u5230\u4E0B\u4E00\u4E2A\u753B\u9762\u7684\u65F6\u95F4\uFF09"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u4E1A\u52A1"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u9875\u9762\u6D4F\u89C8\u548C\u70B9\u51FB\u91CF\uFF08pageview\uFF09"}),"\n",(0,d.jsx)(n.li,{children:"\u8BBF\u95EE\u9875\u9762\u4E0D\u540C ip \u7684\u4EBA\u6570\uFF08unique visitor\uFF09"}),"\n",(0,d.jsx)(n.li,{children:"\u505C\u7559\u65F6\u95F4"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u76D1\u63A7\u6D41\u7A0B",children:"\u76D1\u63A7\u6D41\u7A0B"}),"\n",(0,d.jsx)(n.p,{children:"\u524D\u7AEF\u57CB\u70B9\u3001\u6570\u636E\u4E0A\u62A5\u3001\u52A0\u5DE5\u6C47\u603B\u3001\u53EF\u89C6\u5316\u5C55\u793A\u3001\u76D1\u63A7\u9884\u8B66"}),"\n",(0,d.jsx)(n.h2,{id:"\u76D1\u63A7\u5B9E\u73B0",children:"\u76D1\u63A7\u5B9E\u73B0"}),"\n",(0,d.jsx)(n.h3,{id:"\u6355\u83B7-js-\u5F02\u5E38",children:"\u6355\u83B7 js \u5F02\u5E38"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",children:'// \u4E00\u822C JS \u8FD0\u884C\u65F6\u9519\u8BEF\u4F7F\u7528 window.onerror \u6355\u83B7\u5904\u7406\r\nwindow.addEventListener(\r\n  "error",\r\n  function (event) {\r\n    let lastEvent = getLastEvent();\r\n    // \u6709 e.target.src(href) \u7684\u8BA4\u5B9A\u4E3A\u8D44\u6E90\u52A0\u8F7D\u9519\u8BEF\r\n    if (event.target && (event.target.src || event.target.href)) {\r\n      tracker.send({\r\n        // \u8D44\u6E90\u52A0\u8F7D\u9519\u8BEF\r\n        type: "error", // resource\r\n        subType:\'resource-error\'\r\n        // ...\r\n      });\r\n    } else {\r\n      tracker.send({\r\n        type: "error", //error\r\n        errorType: "js-error",\r\n      });\r\n    }\r\n  },\r\n  true\r\n); // true\u4EE3\u8868\u5728\u6355\u83B7\u9636\u6BB5\u8C03\u7528,false\u4EE3\u8868\u5728\u5192\u6CE1\u9636\u6BB5\u6355\u83B7,\u4F7F\u7528true\u6216false\u90FD\u53EF\u4EE5\n'})}),"\n",(0,d.jsx)(n.p,{children:"\u6355\u83B7 promise \u5F02\u5E38"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",children:'//\u5F53 Promise \u88AB reject \u4E14\u6CA1\u6709 reject \u5904\u7406\u5668\u7684\u65F6\u5019\uFF0C\u4F1A\u89E6\u53D1 unhandledrejection \u4E8B\u4EF6\r\nwindow.addEventListener("unhandledrejection",\r\n  function (event) {\r\n    let lastEvent = getLastEvent();\r\n    let message = "";\r\n    let line = 0;\r\n    let column = 0;\r\n    let file = "";\r\n    let stack = "";\r\n    if (typeof event.reason === "string") {\r\n      message = event.reason;\r\n    } else if (typeof event.reason === "object") {\r\n      message = event.reason.message;\r\n    }\r\n    let reason = event.reason;\r\n    if (typeof reason === "object") {\r\n      if (reason.stack) {\r\n        var matchResult = reason.stack.match(/at\\s+(.+):(\\d+):(\\d+)/);\r\n        if (matchResult) {\r\n          file = matchResult[1];\r\n          line = matchResult[2];\r\n          column = matchResult[3];\r\n        }\r\n        stack = getLines(reason.stack);\r\n      }\r\n    }\r\n    tracker.send({\r\n      //\u672A\u6355\u83B7\u7684promise\u9519\u8BEF\r\n      kind: "stability", //\u7A33\u5B9A\u6027\u6307\u6807\r\n      type: "error", //jsError\r\n      errorType: "promiseError", //unhandledrejection\r\n      message: message, //\u6807\u7B7E\u540D\r\n      filename: file,\r\n      position: line + ":" + column, //\u884C\u5217\r\n      stack,\r\n      selector: lastEvent\r\n        ? getSelector(lastEvent.path || lastEvent.target)\r\n        : "",\r\n    });\r\n  },\r\n  true\r\n); // true\u4EE3\u8868\u5728\u6355\u83B7\u9636\u6BB5\u8C03\u7528,false\u4EE3\u8868\u5728\u5192\u6CE1\u9636\u6BB5\u6355\u83B7,\u4F7F\u7528true\u6216false\u90FD\u53EF\u4EE5\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u9875\u9762\u662F\u5426\u767D\u5C4F",children:"\u9875\u9762\u662F\u5426\u767D\u5C4F"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",children:'import tracker from "../util/tracker";\r\nimport onload from "../util/onload";\r\nfunction getSelector(element) {\r\n  var selector;\r\n  if (element.id) {\r\n    selector = `#${element.id}`;\r\n  } else if (element.className && typeof element.className === "string") {\r\n    selector =\r\n      "." +\r\n      element.className\r\n        .split(" ")\r\n        .filter(function (item) {\r\n          return !!item;\r\n        })\r\n        .join(".");\r\n  } else {\r\n    selector = element.nodeName.toLowerCase();\r\n  }\r\n  return selector;\r\n}\r\nexport function blankScreen() {\r\n  const wrapperSelectors = ["body", "html", "#container", ".content"];\r\n  let emptyPoints = 0;\r\n  function isWrapper(element) {\r\n    let selector = getSelector(element);\r\n    if (wrapperSelectors.indexOf(selector) >= 0) {\r\n      emptyPoints++;\r\n    }\r\n  }\r\n  onload(function () {\r\n    let xElements, yElements;\r\n    debugger;\r\n    for (let i = 1; i <= 9; i++) {\r\n      xElements = document.elementsFromPoint(\r\n        (window.innerWidth * i) / 10,\r\n        window.innerHeight / 2\r\n      );\r\n      yElements = document.elementsFromPoint(\r\n        window.innerWidth / 2,\r\n        (window.innerHeight * i) / 10\r\n      );\r\n      isWrapper(xElements[0]);\r\n      isWrapper(yElements[0]);\r\n    }\r\n    if (emptyPoints >= 0) {\r\n      let centerElements = document.elementsFromPoint(\r\n        window.innerWidth / 2,\r\n        window.innerHeight / 2\r\n      );\r\n      tracker.send({\r\n        kind: "stability",\r\n        type: "blank",\r\n        emptyPoints: "" + emptyPoints,\r\n        screen: window.screen.width + "x" + window.screen.height,\r\n        viewPoint: window.innerWidth + "x" + window.innerHeight,\r\n        selector: getSelector(centerElements[0]),\r\n      });\r\n    }\r\n  });\r\n}\r\n// window.innerWidth \u53BB\u9664\u5DE5\u5177\u6761\u4E0E\u6EDA\u52A8\u6761\u7684\u7A97\u53E3\u5BBD\u5EA6\r\n// window.innerHeight \u53BB\u9664\u5DE5\u5177\u6761\u4E0E\u6EDA\u52A8\u6761\u7684\u7A97\u53E3\u9AD8\u5EA6\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u52A0\u8F7D\u65F6\u95F4",children:"\u52A0\u8F7D\u65F6\u95F4"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceNavigationTiming",children:"PerformanceNavigationTiming"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://developer.mozilla.org/zh-CN/docs/Web/Events/DOMContentLoaded",children:"DOMContentLoaded"})}),"\n"]}),"\n",(0,d.jsx)(n.h4,{id:"\u9636\u6BB5\u542B\u4E49",children:"\u9636\u6BB5\u542B\u4E49"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"https://camo.githubusercontent.com/0eb3b5120656b4a8e0dd5675ee35698819dee8edf1e8145e68223e7508644a09/68747470733a2f2f70332d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f37643330383031333133363934623862626631653839373762386438626434357e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",children:(0,d.jsx)(n.img,{src:"https://camo.githubusercontent.com/0eb3b5120656b4a8e0dd5675ee35698819dee8edf1e8145e68223e7508644a09/68747470733a2f2f70332d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f37643330383031333133363934623862626631653839373762386438626434357e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",alt:"image.png"})})}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u5B57\u6BB5"}),(0,d.jsx)(n.th,{children:"\u542B\u4E49"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"navigationStart"}),(0,d.jsx)(n.td,{children:"\u521D\u59CB\u5316\u9875\u9762\uFF0C\u5728\u540C\u4E00\u4E2A\u6D4F\u89C8\u5668\u4E0A\u4E0B\u6587\u4E2D\u524D\u4E00\u4E2A\u9875\u9762unload\u7684\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u6CA1\u6709\u524D\u4E00\u4E2A\u9875\u9762\u7684unload\uFF0C\u5219\u4E0EfetchStart\u503C\u76F8\u7B49"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"redirectStart"}),(0,d.jsx)(n.td,{children:"\u7B2C\u4E00\u4E2AHTTP\u91CD\u5B9A\u5411\u53D1\u751F\u7684\u65F6\u95F4,\u6709\u8DF3\u8F6C\u4E14\u662F\u540C\u57DF\u7684\u91CD\u5B9A\u5411,\u5426\u5219\u4E3A0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"redirectEnd"}),(0,d.jsx)(n.td,{children:"\u6700\u540E\u4E00\u4E2A\u91CD\u5B9A\u5411\u5B8C\u6210\u65F6\u7684\u65F6\u95F4,\u5426\u5219\u4E3A0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"fetchStart"}),(0,d.jsx)(n.td,{children:"\u6D4F\u89C8\u5668\u51C6\u5907\u597D\u4F7F\u7528http\u8BF7\u6C42\u83B7\u53D6\u6587\u6863\u7684\u65F6\u95F4,\u8FD9\u53D1\u751F\u5728\u68C0\u67E5\u7F13\u5B58\u4E4B\u524D"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domainLookupStart"}),(0,d.jsx)(n.td,{children:"DNS\u57DF\u540D\u5F00\u59CB\u67E5\u8BE2\u7684\u65F6\u95F4,\u5982\u679C\u6709\u672C\u5730\u7684\u7F13\u5B58\u6216keep-alive\u5219\u65F6\u95F4\u4E3A0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domainLookupEnd"}),(0,d.jsx)(n.td,{children:"DNS\u57DF\u540D\u7ED3\u675F\u67E5\u8BE2\u7684\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"connectStart"}),(0,d.jsxs)(n.td,{children:["TCP\u5F00\u59CB\u5EFA\u7ACB\u8FDE\u63A5\u7684\u65F6\u95F4,\u5982\u679C\u662F\u6301\u4E45\u8FDE\u63A5,\u5219\u4E0E",(0,d.jsx)(n.code,{children:"fetchStart"}),"\u503C\u76F8\u7B49"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"secureConnectionStart"}),(0,d.jsx)(n.td,{children:"https \u8FDE\u63A5\u5F00\u59CB\u7684\u65F6\u95F4,\u5982\u679C\u4E0D\u662F\u5B89\u5168\u8FDE\u63A5\u5219\u4E3A0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"connectEnd"}),(0,d.jsxs)(n.td,{children:["TCP\u5B8C\u6210\u63E1\u624B\u7684\u65F6\u95F4\uFF0C\u5982\u679C\u662F\u6301\u4E45\u8FDE\u63A5\u5219\u4E0E",(0,d.jsx)(n.code,{children:"fetchStart"}),"\u503C\u76F8\u7B49"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"requestStart"}),(0,d.jsx)(n.td,{children:"HTTP\u8BF7\u6C42\u8BFB\u53D6\u771F\u5B9E\u6587\u6863\u5F00\u59CB\u7684\u65F6\u95F4,\u5305\u62EC\u4ECE\u672C\u5730\u7F13\u5B58\u8BFB\u53D6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"requestEnd"}),(0,d.jsx)(n.td,{children:"HTTP\u8BF7\u6C42\u8BFB\u53D6\u771F\u5B9E\u6587\u6863\u7ED3\u675F\u7684\u65F6\u95F4,\u5305\u62EC\u4ECE\u672C\u5730\u7F13\u5B58\u8BFB\u53D6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"responseStart"}),(0,d.jsx)(n.td,{children:"\u8FD4\u56DE\u6D4F\u89C8\u5668\u4ECE\u670D\u52A1\u5668\u6536\u5230\uFF08\u6216\u4ECE\u672C\u5730\u7F13\u5B58\u8BFB\u53D6\uFF09\u7B2C\u4E00\u4E2A\u5B57\u8282\u65F6\u7684Unix\u6BEB\u79D2\u65F6\u95F4\u6233"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"responseEnd"}),(0,d.jsx)(n.td,{children:"\u8FD4\u56DE\u6D4F\u89C8\u5668\u4ECE\u670D\u52A1\u5668\u6536\u5230\uFF08\u6216\u4ECE\u672C\u5730\u7F13\u5B58\u8BFB\u53D6\uFF0C\u6216\u4ECE\u672C\u5730\u8D44\u6E90\u8BFB\u53D6\uFF09\u6700\u540E\u4E00\u4E2A\u5B57\u8282\u65F6\u7684 Unix \u6BEB\u79D2\u65F6\u95F4\u6233"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"unloadEventStart"}),(0,d.jsx)(n.td,{children:"\u524D\u4E00\u4E2A\u9875\u9762\u7684 unload \u7684\u65F6\u95F4\u6233 \u5982\u679C\u6CA1\u6709\u5219\u4E3A 0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"unloadEventEnd"}),(0,d.jsxs)(n.td,{children:["\u4E0E",(0,d.jsx)(n.code,{children:"unloadEventStart"}),"\u76F8\u5BF9\u5E94\uFF0C\u8FD4\u56DE\u7684\u662F",(0,d.jsx)(n.code,{children:"unload"}),"\u51FD\u6570\u6267\u884C\u5B8C\u6210\u7684\u65F6\u95F4\u6233"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domLoading"}),(0,d.jsxs)(n.td,{children:["\u8FD4\u56DE\u5F53\u524D\u7F51\u9875DOM\u7ED3\u6784\u5F00\u59CB\u89E3\u6790\u65F6\u7684\u65F6\u95F4\u6233,\u6B64\u65F6",(0,d.jsx)(n.code,{children:"document.readyState"}),"\u53D8\u6210loading,\u5E76\u5C06\u629B\u51FA",(0,d.jsx)(n.code,{children:"readyStateChange"}),"\u4E8B\u4EF6"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domInteractive"}),(0,d.jsxs)(n.td,{children:["\u8FD4\u56DE\u5F53\u524D\u7F51\u9875DOM\u7ED3\u6784\u7ED3\u675F\u89E3\u6790\u3001\u5F00\u59CB\u52A0\u8F7D\u5185\u5D4C\u8D44\u6E90\u65F6\u65F6\u95F4\u6233,",(0,d.jsx)(n.code,{children:"document.readyState"})," \u53D8\u6210",(0,d.jsx)(n.code,{children:"interactive"}),"\uFF0C\u5E76\u5C06\u629B\u51FA",(0,d.jsx)(n.code,{children:"readyStateChange"}),"\u4E8B\u4EF6(\u6CE8\u610F\u53EA\u662FDOM\u6811\u89E3\u6790\u5B8C\u6210,\u8FD9\u65F6\u5019\u5E76\u6CA1\u6709\u5F00\u59CB\u52A0\u8F7D\u7F51\u9875\u5185\u7684\u8D44\u6E90)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domContentLoadedEventStart"}),(0,d.jsx)(n.td,{children:"\u7F51\u9875 domContentLoaded \u4E8B\u4EF6\u53D1\u751F\u7684\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domContentLoadedEventEnd"}),(0,d.jsx)(n.td,{children:"\u7F51\u9875 domContentLoaded \u4E8B\u4EF6\u811A\u672C\u6267\u884C\u5B8C\u6BD5\u7684\u65F6\u95F4\uFF0CdomReady \u7684\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domComplete"}),(0,d.jsxs)(n.td,{children:["DOM \u6811\u89E3\u6790\u5B8C\u6210\uFF0C\u4E14\u8D44\u6E90\u4E5F\u51C6\u5907\u5C31\u7EEA\u7684\u65F6\u95F4\uFF0C",(0,d.jsx)(n.code,{children:"document.readyState"}),"\u53D8\u6210",(0,d.jsx)(n.code,{children:"complete"}),".\u5E76\u5C06\u629B\u51FA ",(0,d.jsx)(n.code,{children:"readystatechange"})," \u4E8B\u4EF6"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"loadEventStart"}),(0,d.jsx)(n.td,{children:"load \u4E8B\u4EF6\u53D1\u9001\u7ED9\u6587\u6863\uFF0C\u4E5F\u5373load\u56DE\u8C03\u51FD\u6570\u5F00\u59CB\u6267\u884C\u7684\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"loadEventEnd"}),(0,d.jsx)(n.td,{children:"load \u56DE\u8C03\u51FD\u6570\u6267\u884C\u5B8C\u6210\u7684\u65F6\u95F4"})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"\u9636\u6BB5\u8BA1\u7B97",children:"\u9636\u6BB5\u8BA1\u7B97"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u5B57\u6BB5"}),(0,d.jsx)(n.th,{children:"\u63CF\u8FF0"}),(0,d.jsx)(n.th,{children:"\u8BA1\u7B97\u65B9\u5F0F"}),(0,d.jsx)(n.th,{children:"\u610F\u4E49"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"unload"}),(0,d.jsx)(n.td,{children:"\u524D\u4E00\u4E2A\u9875\u9762\u5378\u8F7D\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"unloadEventEnd \u2013 unloadEventStart"}),(0,d.jsx)(n.td,{children:"-"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"redirect"}),(0,d.jsx)(n.td,{children:"\u91CD\u5B9A\u5411\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"redirectEnd \u2013 redirectStart"}),(0,d.jsx)(n.td,{children:"\u91CD\u5B9A\u5411\u7684\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"appCache"}),(0,d.jsx)(n.td,{children:"\u7F13\u5B58\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"domainLookupStart \u2013 fetchStart"}),(0,d.jsx)(n.td,{children:"\u8BFB\u53D6\u7F13\u5B58\u7684\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"dns"}),(0,d.jsx)(n.td,{children:"DNS \u89E3\u6790\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"domainLookupEnd \u2013 domainLookupStart"}),(0,d.jsx)(n.td,{children:"\u53EF\u89C2\u5BDF\u57DF\u540D\u89E3\u6790\u670D\u52A1\u662F\u5426\u6B63\u5E38"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"tcp"}),(0,d.jsx)(n.td,{children:"TCP \u8FDE\u63A5\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"connectEnd \u2013 connectStart"}),(0,d.jsx)(n.td,{children:"\u5EFA\u7ACB\u8FDE\u63A5\u7684\u8017\u65F6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"ssl"}),(0,d.jsx)(n.td,{children:"SSL \u5B89\u5168\u8FDE\u63A5\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"connectEnd \u2013 secureConnectionStart"}),(0,d.jsx)(n.td,{children:"\u53CD\u6620\u6570\u636E\u5B89\u5168\u8FDE\u63A5\u5EFA\u7ACB\u8017\u65F6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"ttfb"}),(0,d.jsx)(n.td,{children:"Time to First Byte \uFF08TTFB\uFF09\u7F51\u7EDC\u8BF7\u6C42\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"responseStart \u2013 requestStart"}),(0,d.jsx)(n.td,{children:"TTFB \u662F\u53D1\u51FA\u9875\u9762\u8BF7\u6C42\u5230\u63A5\u6536\u5230\u5E94\u7B54\u6570\u636E\u7B2C\u4E00\u4E2A\u5B57\u8282\u6240\u82B1\u8D39\u7684\u6BEB\u79D2\u6570"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"response"}),(0,d.jsx)(n.td,{children:"\u54CD\u5E94\u6570\u636E\u4F20\u8F93\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"responseEnd \u2013 responseStart"}),(0,d.jsx)(n.td,{children:"\u89C2\u5BDF\u7F51\u7EDC\u662F\u5426\u6B63\u5E38"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"dom"}),(0,d.jsx)(n.td,{children:"DOM\u89E3\u6790\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"domInteractive \u2013 responseEnd"}),(0,d.jsx)(n.td,{children:"\u89C2\u5BDFDOM\u7ED3\u6784\u662F\u5426\u5408\u7406\uFF0C\u662F\u5426\u6709JS\u963B\u585E\u9875\u9762\u89E3\u6790"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"dcl"}),(0,d.jsx)(n.td,{children:"DOMContentLoaded \u4E8B\u4EF6\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"domContentLoadedEventEnd \u2013 domContentLoadedEventStart"}),(0,d.jsx)(n.td,{children:"\u5F53 HTML \u6587\u6863\u88AB\u5B8C\u5168\u52A0\u8F7D\u548C\u89E3\u6790\u5B8C\u6210\u4E4B\u540E\uFF0CDOMContentLoaded \u4E8B\u4EF6\u88AB\u89E6\u53D1\uFF0C\u65E0\u9700\u7B49\u5F85\u6837\u5F0F\u8868\u3001\u56FE\u50CF\u548C\u5B50\u6846\u67B6\u7684\u5B8C\u6210\u52A0\u8F7D"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"resources"}),(0,d.jsx)(n.td,{children:"\u8D44\u6E90\u52A0\u8F7D\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"domComplete \u2013 domContentLoadedEventEnd"}),(0,d.jsx)(n.td,{children:"\u53EF\u89C2\u5BDF\u6587\u6863\u6D41\u662F\u5426\u8FC7\u5927"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"domReady"}),(0,d.jsx)(n.td,{children:"DOM\u9636\u6BB5\u6E32\u67D3\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"domContentLoadedEventEnd \u2013 fetchStart"}),(0,d.jsxs)(n.td,{children:["DOM \u6811\u548C\u9875\u9762\u8D44\u6E90\u52A0\u8F7D\u5B8C\u6210\u65F6\u95F4\uFF0C\u4F1A\u89E6\u53D1",(0,d.jsx)(n.code,{children:"domContentLoaded"}),"\u4E8B\u4EF6"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u9996\u6B21\u6E32\u67D3\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"\u9996\u6B21\u6E32\u67D3\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"responseEnd-fetchStart"}),(0,d.jsx)(n.td,{children:"\u52A0\u8F7D\u6587\u6863\u5230\u770B\u5230\u7B2C\u4E00\u5E27\u975E\u7A7A\u56FE\u50CF\u7684\u65F6\u95F4\uFF0C\u4E5F\u53EB\u767D\u5C4F\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u9996\u6B21\u53EF\u4EA4\u4E92\u65F6\u95F4"}),(0,d.jsx)(n.td,{children:"\u9996\u6B21\u53EF\u4EA4\u4E92\u65F6\u95F4"}),(0,d.jsx)(n.td,{children:"domInteractive-fetchStart"}),(0,d.jsx)(n.td,{children:"DOM \u6811\u89E3\u6790\u5B8C\u6210\u65F6\u95F4\uFF0C\u6B64\u65F6document.readyState \u4E3A interactive"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u9996\u5305\u65F6\u95F4\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"\u9996\u5305\u65F6\u95F4"}),(0,d.jsx)(n.td,{children:"responseStart-domainLookupStart"}),(0,d.jsx)(n.td,{children:"DNS\u89E3\u6790\u5230\u54CD\u5E94\u8FD4\u56DE\u7ED9\u6D4F\u89C8\u5668\u7B2C\u4E00\u4E2A\u5B57\u8282\u7684\u65F6\u95F4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u9875\u9762\u5B8C\u5168\u52A0\u8F7D\u65F6\u95F4"}),(0,d.jsx)(n.td,{children:"\u9875\u9762\u5B8C\u5168\u52A0\u8F7D\u65F6\u95F4"}),(0,d.jsx)(n.td,{children:"loadEventStart - fetchStart"}),(0,d.jsx)(n.td,{children:"-"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"onLoad"}),(0,d.jsx)(n.td,{children:"onLoad\u4E8B\u4EF6\u8017\u65F6"}),(0,d.jsx)(n.td,{children:"loadEventEnd \u2013 loadEventStart"}),(0,d.jsx)(n.td,{})]})]})]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"https://camo.githubusercontent.com/7e02fa16dbdf00df774a4daf3db853d8c6e07602a21158b1075c8e13085c67b5/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f31396163323731313430663734353232623133646162653035636234613063387e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",children:(0,d.jsx)(n.img,{src:"https://camo.githubusercontent.com/7e02fa16dbdf00df774a4daf3db853d8c6e07602a21158b1075c8e13085c67b5/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f31396163323731313430663734353232623133646162653035636234613063387e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",alt:"image.png"})})}),"\n",(0,d.jsx)(n.h4,{id:"\u6570\u636E\u7ED3\u6784",children:"\u6570\u636E\u7ED3\u6784"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\r\n  "programName": "\u524D\u7AEF\u76D1\u63A7\u7CFB\u7EDF",\r\n  "type": "performance",\r\n  "subType": "FCP",\r\n  "message": "someVar is not defined",\r\n  "userAgent": "Chrome", // \u7528\u6237\u6D4F\u89C8\u5668\u7C7B\u578B\r\n  "deviceInfo":{\r\n    "CPU":"",\r\n    "GPU":"",\r\n  },\r\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"\u5B9E\u73B0",children:"\u5B9E\u73B0"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",children:'import onload from "../util/onload";\r\nimport tracker from "../util/tracker";\r\nimport formatTime from "../util/formatTime";\r\nimport getLastEvent from "../util/getLastEvent";\r\nimport getSelector from "../util/getSelector";\r\nexport function timing() {\r\n  onload(function () {\r\n    setTimeout(() => {\r\n      const {\r\n        fetchStart,\r\n        connectStart,\r\n        connectEnd,\r\n        requestStart,\r\n        responseStart,\r\n        responseEnd,\r\n        domLoading,\r\n        domInteractive,\r\n        domContentLoadedEventStart,\r\n        domContentLoadedEventEnd,\r\n        loadEventStart,\r\n      } = performance.timing;\r\n      tracker.send({\r\n        kind: "experience",\r\n        type: "timing",\r\n        connectTime: connectEnd - connectStart, //TCP\u8FDE\u63A5\u8017\u65F6\r\n        ttfbTime: responseStart - requestStart, //ttfb\r\n        responseTime: responseEnd - responseStart, //Response\u54CD\u5E94\u8017\u65F6\r\n        parseDOMTime: loadEventStart - domLoading, //DOM\u89E3\u6790\u6E32\u67D3\u8017\u65F6\r\n        domContentLoadedTime:\r\n          domContentLoadedEventEnd - domContentLoadedEventStart, //DOMContentLoaded\u4E8B\u4EF6\u56DE\u8C03\u8017\u65F6\r\n        timeToInteractive: domInteractive - fetchStart, //\u9996\u6B21\u53EF\u4EA4\u4E92\u65F6\u95F4\r\n        loadTime: loadEventStart - fetchStart, //\u5B8C\u6574\u7684\u52A0\u8F7D\u65F6\u95F4\r\n      });\r\n    }, 3000);\r\n  });\r\n}\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u4E3B\u8981\u6027\u80FD\u6307\u6807",children:"\u4E3B\u8981\u6027\u80FD\u6307\u6807"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceObserver/observe",children:"PerformanceObserver.observe"})," \u65B9\u6CD5\u7528\u4E8E\u89C2\u5BDF\u4F20\u5165\u7684\u53C2\u6570\u4E2D\u6307\u5B9A\u7684\u6027\u80FD\u6761\u76EE\u7C7B\u578B\u7684\u96C6\u5408\u3002\u5F53\u8BB0\u5F55\u4E00\u4E2A\u6307\u5B9A\u7C7B\u578B\u7684\u6027\u80FD\u6761\u76EE\u65F6\uFF0C\u6027\u80FD\u76D1\u6D4B\u5BF9\u8C61\u7684\u56DE\u8C03\u51FD\u6570\u5C06\u4F1A\u88AB\u8C03\u7528"]}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceEntry/entryType",children:"entryType"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://w3c.github.io/paint-timing/",children:"paint-timing"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://wicg.github.io/event-timing/",children:"event-timing"})}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"https://camo.githubusercontent.com/01c5c96e0d1b8f75d0da1dfdc4027609793f049a9379df1c946b6b12603f135d/68747470733a2f2f70332d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f33343231613038623431353134356130386434333864633435376235373836307e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",children:(0,d.jsx)(n.img,{src:"https://camo.githubusercontent.com/01c5c96e0d1b8f75d0da1dfdc4027609793f049a9379df1c946b6b12603f135d/68747470733a2f2f70332d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f33343231613038623431353134356130386434333864633435376235373836307e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",alt:"image.png"})})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"https://camo.githubusercontent.com/95307637fa16400e6045fd2fa1f73a07ded8e567b7f047efca06dc968e2388e7/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f62396134636333376438656234346265383833666334306632643030393365317e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",children:(0,d.jsx)(n.img,{src:"https://camo.githubusercontent.com/95307637fa16400e6045fd2fa1f73a07ded8e567b7f047efca06dc968e2388e7/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f62396134636333376438656234346265383833666334306632643030393365317e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",alt:"image.png"})})}),"\n",(0,d.jsx)(n.h4,{id:"\u6570\u636E\u8BBE\u8BA1",children:"\u6570\u636E\u8BBE\u8BA1"}),"\n",(0,d.jsx)(n.p,{children:"paint"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\r\n  "title": "\u524D\u7AEF\u76D1\u63A7\u7CFB\u7EDF",\r\n  "url": "http://localhost:8080/",\r\n  "timestamp": "1590828364186",\r\n  "userAgent": "chrome",\r\n  "kind": "experience",\r\n  "type": "paint",\r\n  "firstPaint": "102",\r\n  "firstContentPaint": "2130",\r\n  "firstMeaningfulPaint": "2130",\r\n  "largestContentfulPaint": "2130"\r\n}\n'})}),"\n",(0,d.jsx)(n.p,{children:"firstInputDelay"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\r\n  "title": "\u524D\u7AEF\u76D1\u63A7\u7CFB\u7EDF",\r\n  "url": "http://localhost:8080/",\r\n  "timestamp": "1590828477284",\r\n  "userAgent": "chrome",\r\n  "kind": "experience",\r\n  "type": "firstInputDelay",\r\n  "inputDelay": "3",\r\n  "duration": "8",\r\n  "startTime": "4812.344999983907",\r\n  "selector": "HTML BODY #container .content H1"\r\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"\u5B9E\u73B0-1",children:"\u5B9E\u73B0"}),"\n",(0,d.jsx)(n.p,{children:"\u5173\u952E\u65F6\u95F4\u8282\u70B9\u901A\u8FC7 window.performance.timing \u83B7\u53D6"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"https://camo.githubusercontent.com/96ba81873a07e050fa0b1f3f62b723c8cec878dc2db7546310ffb683dfae0989/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f39333639303734666632353534373130616261643136396338626137373262617e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",children:(0,d.jsx)(n.img,{src:"https://camo.githubusercontent.com/96ba81873a07e050fa0b1f3f62b723c8cec878dc2db7546310ffb683dfae0989/68747470733a2f2f70312d6a75656a696e2e62797465696d672e636f6d2f746f732d636e2d692d6b3375316662706663702f39333639303734666632353534373130616261643136396338626137373262617e74706c762d6b3375316662706663702d77617465726d61726b2e696d6167653f",alt:"image.png"})})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",children:'import tracker from "../utils/tracker";\r\nimport onload from "../utils/onload";\r\nimport getLastEvent from "../utils/getLastEvent";\r\nimport getSelector from "../utils/getSelector";\r\n\r\nexport function timing() {\r\n  let FMP, LCP;\r\n  // \u589E\u52A0\u4E00\u4E2A\u6027\u80FD\u6761\u76EE\u7684\u89C2\u5BDF\u8005\r\n  new PerformanceObserver((entryList, observer) => {\r\n    const perfEntries = entryList.getEntries();\r\n    FMP = perfEntries[0];\r\n    observer.disconnect(); // \u4E0D\u518D\u89C2\u5BDF\u4E86\r\n  }).observe({ entryTypes: ["element"] }); // \u89C2\u5BDF\u9875\u9762\u4E2D\u6709\u610F\u4E49\u7684\u5143\u7D20\r\n  // \u589E\u52A0\u4E00\u4E2A\u6027\u80FD\u6761\u76EE\u7684\u89C2\u5BDF\u8005\r\n  new PerformanceObserver((entryList, observer) => {\r\n    const perfEntries = entryList.getEntries();\r\n    const lastEntry = perfEntries[perfEntries.length - 1];\r\n    LCP = lastEntry;\r\n    observer.disconnect(); // \u4E0D\u518D\u89C2\u5BDF\u4E86\r\n  }).observe({ entryTypes: ["largest-contentful-paint"] }); // \u89C2\u5BDF\u9875\u9762\u4E2D\u6700\u5927\u7684\u5143\u7D20\r\n  // \u589E\u52A0\u4E00\u4E2A\u6027\u80FD\u6761\u76EE\u7684\u89C2\u5BDF\u8005\r\n  new PerformanceObserver((entryList, observer) => {\r\n    const lastEvent = getLastEvent();\r\n    const firstInput = entryList.getEntries()[0];\r\n    if (firstInput) {\r\n      // \u5F00\u59CB\u5904\u7406\u7684\u65F6\u95F4 - \u5F00\u59CB\u70B9\u51FB\u7684\u65F6\u95F4\uFF0C\u5DEE\u503C\u5C31\u662F\u5904\u7406\u7684\u5EF6\u8FDF\r\n      let inputDelay = firstInput.processingStart - firstInput.startTime;\r\n      let duration = firstInput.duration; // \u5904\u7406\u7684\u8017\u65F6\r\n      if (inputDelay > 0 || duration > 0) {\r\n        tracker.send({\r\n          kind: "experience", // \u7528\u6237\u4F53\u9A8C\u6307\u6807\r\n          type: "firstInputDelay", // \u9996\u6B21\u8F93\u5165\u5EF6\u8FDF\r\n          inputDelay: inputDelay ? formatTime(inputDelay) : 0, // \u5EF6\u8FDF\u7684\u65F6\u95F4\r\n          duration: duration ? formatTime(duration) : 0,\r\n          startTime: firstInput.startTime, // \u5F00\u59CB\u5904\u7406\u7684\u65F6\u95F4\r\n          selector: lastEvent\r\n            ? getSelector(lastEvent.path || lastEvent.target)\r\n            : "",\r\n        });\r\n      }\r\n    }\r\n    observer.disconnect(); // \u4E0D\u518D\u89C2\u5BDF\u4E86\r\n  }).observe({ type: "first-input", buffered: true }); // \u7B2C\u4E00\u6B21\u4EA4\u4E92\r\n\r\n  // \u521A\u5F00\u59CB\u9875\u9762\u5185\u5BB9\u4E3A\u7A7A\uFF0C\u7B49\u9875\u9762\u6E32\u67D3\u5B8C\u6210\uFF0C\u518D\u53BB\u505A\u5224\u65AD\r\n  onload(function () {\r\n    setTimeout(() => {\r\n      const {\r\n        fetchStart,\r\n        connectStart,\r\n        connectEnd,\r\n        requestStart,\r\n        responseStart,\r\n        responseEnd,\r\n        domLoading,\r\n        domInteractive,\r\n        domContentLoadedEventStart,\r\n        domContentLoadedEventEnd,\r\n        loadEventStart,\r\n      } = window.performance.timing;\r\n      // \u53D1\u9001\u65F6\u95F4\u6307\u6807\r\n      tracker.send({\r\n        kind: "experience", // \u7528\u6237\u4F53\u9A8C\u6307\u6807\r\n        type: "timing", // \u7EDF\u8BA1\u6BCF\u4E2A\u9636\u6BB5\u7684\u65F6\u95F4\r\n        connectTime: connectEnd - connectStart, // TCP\u8FDE\u63A5\u8017\u65F6\r\n        ttfbTime: responseStart - requestStart, // \u9996\u5B57\u8282\u5230\u8FBE\u65F6\u95F4\r\n        responseTime: responseEnd - responseStart, // response\u54CD\u5E94\u8017\u65F6\r\n        parseDOMTime: loadEventStart - domLoading, // DOM\u89E3\u6790\u6E32\u67D3\u7684\u65F6\u95F4\r\n        domContentLoadedTime:\r\n          domContentLoadedEventEnd - domContentLoadedEventStart, // DOMContentLoaded\u4E8B\u4EF6\u56DE\u8C03\u8017\u65F6\r\n        timeToInteractive: domInteractive - fetchStart, // \u9996\u6B21\u53EF\u4EA4\u4E92\u65F6\u95F4\r\n        loadTime: loadEventStart - fetchStart, // \u5B8C\u6574\u7684\u52A0\u8F7D\u65F6\u95F4\r\n      });\r\n      // \u53D1\u9001\u6027\u80FD\u6307\u6807\r\n      let FP = performance.getEntriesByName("first-paint")[0];\r\n      let FCP = performance.getEntriesByName("first-contentful-paint")[0];\r\n      console.log("FP", FP);\r\n      console.log("FCP", FCP);\r\n      console.log("FMP", FMP);\r\n      console.log("LCP", LCP);\r\n      tracker.send({\r\n        kind: "experience",\r\n        type: "paint",\r\n        firstPaint: FP ? formatTime(FP.startTime) : 0,\r\n        firstContentPaint: FCP ? formatTime(FCP.startTime) : 0,\r\n        firstMeaningfulPaint: FMP ? formatTime(FMP.startTime) : 0,\r\n        largestContentfulPaint: LCP\r\n          ? formatTime(LCP.renderTime || LCP.loadTime)\r\n          : 0,\r\n      });\r\n    }, 3000);\r\n  });\r\n}\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u5361\u987F",children:"\u5361\u987F"}),"\n",(0,d.jsx)(n.p,{children:"\u54CD\u5E94\u7528\u6237\u4EA4\u4E92\u7684\u54CD\u5E94\u65F6\u95F4\u5982\u679C\u5927\u4E8E 100ms\uFF0C\u7528\u6237\u5C31\u4F1A\u611F\u89C9\u5361\u987F"}),"\n",(0,d.jsx)(n.h4,{id:"\u6570\u636E\u8BBE\u8BA1-1",children:"\u6570\u636E\u8BBE\u8BA1"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\r\n  "title": "\u524D\u7AEF\u76D1\u63A7\u7CFB\u7EDF",\r\n  "url": "http://localhost:8080/",\r\n  "timestamp": "1590828656781",\r\n  "userAgent": "chrome",\r\n  "kind": "experience",\r\n  "type": "longTask",\r\n  "eventType": "mouseover",\r\n  "startTime": "9331",\r\n  "duration": "200",\r\n  "selector": "HTML BODY #container .content"\r\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"\u5B9E\u73B0-2",children:"\u5B9E\u73B0"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"new PerformanceObserver"}),"\n",(0,d.jsx)(n.li,{children:"entry.duration > 100 \u5224\u65AD\u5927\u4E8E 100ms\uFF0C\u5373\u53EF\u8BA4\u5B9A\u4E3A\u957F\u4EFB\u52A1"}),"\n",(0,d.jsx)(n.li,{children:"\u4F7F\u7528 requestIdleCallback\u4E0A\u62A5\u6570\u636E"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",children:'import tracker from "../util/tracker";\r\nimport formatTime from "../util/formatTime";\r\nimport getLastEvent from "../util/getLastEvent";\r\nimport getSelector from "../util/getSelector";\r\nexport function longTask() {\r\n  new PerformanceObserver((list) => {\r\n    list.getEntries().forEach((entry) => {\r\n      if (entry.duration > 100) {\r\n        let lastEvent = getLastEvent();\r\n        requestIdleCallback(() => {\r\n          tracker.send({\r\n            kind: "experience",\r\n            type: "longTask",\r\n            eventType: lastEvent.type,\r\n            startTime: formatTime(entry.startTime), // \u5F00\u59CB\u65F6\u95F4\r\n            duration: formatTime(entry.duration), // \u6301\u7EED\u65F6\u95F4\r\n            selector: lastEvent\r\n              ? getSelector(lastEvent.path || lastEvent.target)\r\n              : "",\r\n          });\r\n        });\r\n      }\r\n    });\r\n  }).observe({ entryTypes: ["longtask"] });\r\n}\n'})}),"\n",(0,d.jsx)(n.h3,{id:"pvuv\u7528\u6237\u505C\u7559\u65F6\u95F4",children:"PV\u3001UV\u3001\u7528\u6237\u505C\u7559\u65F6\u95F4"}),"\n",(0,d.jsx)(n.p,{children:"PV\uFF08page view\uFF09\u662F\u9875\u9762\u6D4F\u89C8\u91CF\uFF0CUV\uFF08Unique visitor\uFF09\u7528\u6237\u8BBF\u95EE\u91CF\u3002PV \u53EA\u8981\u8BBF\u95EE\u4E00\u6B21\u9875\u9762\u5C31\u7B97\u4E00\u6B21\uFF0CUV \u540C\u4E00\u5929\u5185\u591A\u6B21\u8BBF\u95EE\u53EA\u7B97\u4E00\u6B21\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u5BF9\u4E8E\u524D\u7AEF\u6765\u8BF4\uFF0C\u53EA\u8981\u6BCF\u6B21\u8FDB\u5165\u9875\u9762\u4E0A\u62A5\u4E00\u6B21 PV \u5C31\u884C\uFF0CUV \u7684\u7EDF\u8BA1\u653E\u5728\u670D\u52A1\u7AEF\u6765\u505A\uFF0C\u4E3B\u8981\u662F\u5206\u6790\u4E0A\u62A5\u7684\u6570\u636E\u6765\u7EDF\u8BA1\u5F97\u51FA UV\u3002"}),"\n",(0,d.jsx)(n.h4,{id:"\u6570\u636E\u8BBE\u8BA1-2",children:"\u6570\u636E\u8BBE\u8BA1"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'{\r\n  "title": "\u524D\u7AEF\u76D1\u63A7\u7CFB\u7EDF",\r\n  "url": "http://localhost:8080/",\r\n  "timestamp": "1590829304423",\r\n  "userAgent": "chrome",\r\n  "kind": "business",\r\n  "type": "pv",\r\n  "effectiveType": "4g",\r\n  "rtt": "50",\r\n  "screen": "2049x1152"\r\n}\n'})}),"\n",(0,d.jsx)(n.h4,{id:"\u5B9E\u73B0-3",children:"\u5B9E\u73B0"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",children:'import tracker from "../util/tracker";\r\nexport function pv() {\r\n  tracker.send({\r\n    kind: "business",\r\n    type: "pv",\r\n    startTime: performance.now(),\r\n    pageURL: getPageURL(),\r\n    referrer: document.referrer,\r\n    uuid: getUUID(),\r\n  });\r\n  let startTime = Date.now();\r\n  window.addEventListener(\r\n    "beforeunload",\r\n    () => {\r\n      let stayTime = Date.now() - startTime;\r\n      tracker.send({\r\n        kind: "business",\r\n        type: "stayTime",\r\n        stayTime,\r\n        pageURL: getPageURL(),\r\n        uuid: getUUID(),\r\n      });\r\n    },\r\n    false\r\n  );\r\n}\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u53C2\u8003\u6587\u7AE0",children:"\u53C2\u8003\u6587\u7AE0"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u4F5C\u8005"}),(0,d.jsx)(n.th,{children:"\u94FE\u63A5"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"miracle90"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.a,{href:"https://github.com/miracle90/monitor",children:"https://github.com/miracle90/monitor"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{}),(0,d.jsx)(n.td,{})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{}),(0,d.jsx)(n.td,{})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{}),(0,d.jsx)(n.td,{})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{}),(0,d.jsx)(n.td,{})]})]})]})]})}function h(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},3663:function(e,n,r){r.d(n,{Z:function(){return l},a:function(){return i}});var t=r(5271);let d={},s=t.createContext(d);function i(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);