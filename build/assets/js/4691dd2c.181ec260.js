"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["820"],{50:function(e,r,n){n.r(r),n.d(r,{default:()=>h,frontMatter:()=>o,metadata:()=>s,assets:()=>l,toc:()=>c,contentTitle:()=>i});var s=JSON.parse('{"id":"npm \u5305/axios","title":"axios","description":"Create by fall on 2020-08-15","source":"@site/my-docs/npm \u5305/axios.md","sourceDirName":"npm \u5305","slug":"/npm \u5305/axios","permalink":"/docs/npm \u5305/axios","draft":false,"unlisted":false,"editUrl":"https://github.com/my-docs/npm \u5305/axios.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"npm \u5305","permalink":"/docs/category/npm-\u5305"},"next":{"title":"babel","permalink":"/docs/npm \u5305/babel"}}'),a=n("5893"),t=n("65");let o={},i=void 0,l={},c=[{value:"axios",id:"axios",level:2},{value:"\u8BF7\u6C42",id:"\u8BF7\u6C42",level:3},{value:"\u8FD4\u56DE\u5BF9\u8C61",id:"\u8FD4\u56DE\u5BF9\u8C61",level:3},{value:"\u5168\u5C40\u914D\u7F6E",id:"\u5168\u5C40\u914D\u7F6E",level:3},{value:"\u62E6\u622A\u5668",id:"\u62E6\u622A\u5668",level:3},{value:"\u9002\u914D\u5668",id:"\u9002\u914D\u5668",level:3},{value:"\u914D\u7F6E",id:"\u914D\u7F6E",level:3},{value:"\u63D2\u4EF6",id:"\u63D2\u4EF6",level:2},{value:"axios-mock-adapter",id:"axios-mock-adapter",level:3},{value:"\u5EFA\u8BAE\u914D\u7F6E",id:"\u5EFA\u8BAE\u914D\u7F6E",level:2},{value:"\u53C2\u8003\u6587\u7AE0",id:"\u53C2\u8003\u6587\u7AE0",level:2}];function d(e){let r={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsxs)(r.p,{children:["Create by ",(0,a.jsx)(r.strong,{children:"fall"})," on 2020-08-15\r\nRecently revised in 2022-12-17"]}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"axios",children:"axios"}),"\n",(0,a.jsx)(r.p,{children:"\u57FA\u4E8E Promise\uFF0C\u7528\u4E8E\u6D4F\u89C8\u5668\u548C node.js \u7684 HTTP \u5BA2\u6237\u7AEF\uFF08\u53EF\u4EE5\u8C03\u7528\u4E00\u4E2A http \u7684\u63A5\u53E3\uFF09\uFF0C\u80FD\u62E6\u622A\u8BF7\u6C42\u548C\u54CD\u5E94\uFF0C\u81EA\u52A8\u8F6C\u5316 json \u6570\u636E\u3002"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Promise \u5F02\u6B65\u5904\u7406"}),"\n",(0,a.jsx)(r.li,{children:"\u62E6\u622A\u8BF7\u6C42\u548C\u76F8\u5E94"}),"\n",(0,a.jsxs)(r.li,{children:["\u652F\u6301\u9632\u5FA1 ",(0,a.jsx)(r.a,{href:"https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCross-site_request_forgery",children:"CSRF"})," \u653B\u51FB"]}),"\n",(0,a.jsx)(r.li,{children:"\u8F6C\u6362\u8BF7\u6C42\u548C\u54CD\u5E94\u6570\u636E"}),"\n",(0,a.jsx)(r.li,{children:"\u540C\u65F6\u652F\u6301\u6D4F\u89C8\u5668\u548C Node.js \u73AF\u5883\uFF1B"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"axios.get('/data')\r\n//\u4E5F\u53EF\u4EE5\u4F7F\u7528 restful\u65B9\u5F0F\u8FDB\u884C\u4F20\u8F93 axios.get('/data')\r\n.then(res=>{\r\n  console.log(res.data) // res.data\u83B7\u53D6\u540E\u53F0\u54CD\u5E94\u7684\u6570\u636E\r\n})\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\u8BF7\u6C42",children:"\u8BF7\u6C42"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\u76F4\u63A5\u8BF7\u6C42"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"axios('http://localhost:2525'{\r\n	method:\"get\"\r\n}).then(res)\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"get \u65B9\u5F0F\u8BF7\u6C42\u6570\u636E"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'axios.get({\r\n    url:"/hello",\r\n  // params \u53EF\u4EE5\u81EA\u52A8\u5C06\u5BF9\u8C61\u6570\u636E\u8F6C\u6362\u6210\u62FC\u63A5\u5B57\u7B26\u4E32\u8FDB\u884C\u4F20\u8F93\r\n  params:{\r\n    id:233\r\n  }\r\n}).then((res)=>{console.log(res.data)})\n'})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"post \u6570\u636E\u7684\u4F20\u8F93"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"// \u7B2C\u4E00\u79CD post \u6570\u636E\u4F20\u8F93\u65B9\u5F0F\r\naxios.post('/data',postData).then(function(res){\r\n  console.log(res.data)\r\n})\r\n// \u7B2C\u4E8C\u79CD post \u6570\u636E\u7684\u4F20\u8F93\u65B9\u6CD5\r\nconst params = new URLSearchParams()\r\nparams.append('name','lihua')// \u53EF\u4EE5\u901A\u8FC7\u8BE5\u65B9\u6CD5\u5199\u591A\u4E2A\u6570\u636E\r\naxios.post('/data',params).then(res=>{\r\n  console.log(res.data)\r\n})\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"put \u6570\u636E\u7684\u4F20\u8F93"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"axios.put('/data',{\r\n  id:10010,\r\n  data:\"\u8BF7\u4E0D\u8981\u56DE\u5E94\"\r\n})\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\u8FD4\u56DE\u5BF9\u8C61",children:"\u8FD4\u56DE\u5BF9\u8C61"}),"\n",(0,a.jsx)(r.p,{children:"data\uFF1A\u8FD4\u56DE\u7684\u6570\u636E"}),"\n",(0,a.jsx)(r.p,{children:"headers\uFF1A\u54CD\u5E94\u5934\u4FE1\u606F"}),"\n",(0,a.jsx)(r.p,{children:"status\uFF1A\u54CD\u5E94\u72B6\u6001\u5417"}),"\n",(0,a.jsx)(r.p,{children:"statusTest\uFF1A\u54CD\u5E94\u72B6\u6001\u4FE1\u606F"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"axios.put('/data',{\r\n  username:'liushaoye'\r\n}).then(data=>{\r\n  console.log(data.status)\r\n  console.log(data.headers)\r\n})\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\u5168\u5C40\u914D\u7F6E",children:"\u5168\u5C40\u914D\u7F6E"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"axios.defaults.timeout = 5000 // \u54CD\u5E94\u8D85\u65F6\u65F6\u95F4\r\naxios.defaults.baseURL = 'http://localhost:3000' // \u9ED8\u8BA4\u57FA\u51C6\u5730\u5740\r\naxios.defaults.headers['mytoken'] = 'adacocizuzxoui322ucuzcoiu' // \u8BBE\u7F6E\u54CD\u5E94\u5934\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\u62E6\u622A\u5668",children:"\u62E6\u622A\u5668"}),"\n",(0,a.jsx)(r.p,{children:"\u62E6\u622A\u5668\u6307\u5728\u7528\u6237\u8BF7\u6C42\uFF0C\u5728\u8BF7\u6C42\u53D1\u9001\u5230\u670D\u52A1\u5668\u4E4B\u524D\u6DFB\u52A0\u4E00\u4E9B\u64CD\u4F5C"}),"\n",(0,a.jsx)(r.p,{children:"\u4E00\u822C\u4F1A\u7528\u4E8E\u7528\u6237\u7684\u8BA4\u8BC1\uFF0C\u8BA4\u8BC1\u901A\u8FC7\u540E\uFF0C\u9700\u8981\u5728\u6BCF\u4E2A\u8BF7\u6C42\u4E0A\u90FD\u6DFB\u52A0\u8BA4\u8BC1\u4FE1\u606F\u3002\u6216\u8005\u662F\u5728\u670D\u52A1\u5668\u72B6\u6001\u7801\u4E3A 401\u65F6\uFF0C\u81EA\u52A8\u8DF3\u8F6C\u5230\u767B\u5F55\u754C\u9762\u3002"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\u8BF7\u6C42\u62E6\u622A\u5668"})}),"\n",(0,a.jsx)(r.p,{children:"\u53D1\u9001\u7684\u8BF7\u6C42\u9700\u8981\u7ECF\u8FC7\u8BF7\u6C42\u62E6\u622A\u5668\u624D\u80FD\u8FDB\u884C\u53D1\u9001\uFF0C\u9001\u5F80\u670D\u52A1\u5668\u3002"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"// \u53EF\u4EE5\u5411 use \u4E2D\u63D0\u4F9B\u4E24\u4E2A\u51FD\u6570\u4F5C\u4E3A\u53C2\u6570\uFF0C\u5728\u6210\u529F\u65F6\u6267\u884C\uFF0C\u6216\u8005\u5931\u8D25\u65F6\u6267\u884C\r\naxios.interceptors.request.use((config)=>{\r\n  console.log(config.url)\r\n  config.headers.mytoken = 'hello' // \u5728\u8BF7\u6C42\u5934\uFF08header\uFF09\u4E2D\u6DFB\u52A0\u4E86 mytoken : hello\r\n  return config\r\n},function(err){\r\n  console.log(err)\r\n})\n"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\u54CD\u5E94\u62E6\u622A\u5668"})}),"\n",(0,a.jsx)(r.p,{children:"\u63A5\u53D7\u7684\u54CD\u5E94\uFF0C\u7ECF\u8FC7\u54CD\u5E94\u62E6\u622A\u5668\uFF0C\u8FDB\u884C\u52A0\u5DE5\u5904\u7406\u4E4B\u540E\u624D\u4F1A\u88ABaxios\u8FDB\u884C\u5904\u7406"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"axios.interreceptors.response.use(function(res){\r\n  // \u5BF9\u8FD4\u56DE\u7684\u6570\u636E\u8FDB\u884C\u5904\u7406\uFF0C\u53EA\u83B7\u53D6\u76F8\u5E94\u7684\u6570\u636E\uFF0C\u4E0D\u9700\u8981\u54CD\u5E94\u5934\u5185\u5BB9\r\n  const data = res.data\r\n  return data // \u5FC5\u987B\u8981\u8FD4\u56DE\u5185\u5BB9\uFF0C\u7ED9\u4E0B\u4E00\u5C42 then \u8C03\u7528\r\n},function(err){\r\n  console.log('\u6709\u9519\u8BEF\u4FE1\u606F'+err)\r\n  // \u5904\u7406\u54CD\u5E94\u9519\u8BEF\u4FE1\u606F\r\n})\r\naxios.get('/data').then((res)=>{\r\n  console.log(res)// \u4E0A\u9762\u8FD4\u56DE\u7684\u662F\u5C31\u662Fres.data,\u6240\u4EE5\u53D6\u51FA\u7684\u503C\u4E3Ares.data\r\n})\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u4E2D\u65AD\uFF08\u53D6\u6D88\uFF09\u8BF7\u6C42"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"var CancelToken = axios.CancelToken\r\nvar source = CancelToken = CancelToken.source()\r\naxios.get('user',{\r\n  cancelToken:source.token\r\n})\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\u9002\u914D\u5668",children:"\u9002\u914D\u5668"}),"\n",(0,a.jsx)(r.p,{children:"\u901A\u8FC7\u9002\u914D\u5668\uFF0Caxios \u652F\u6301\u6D4F\u89C8\u5668\u548C node\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u901A\u8FC7\u81EA\u5B9A\u4E49\u9002\u914D\u5668\u7684\u65B9\u5F0F"}),"\n",(0,a.jsx)(r.p,{children:"axios \u662F\u5982\u4F55\u533A\u5206 node \u8FD8\u662F\u6D4F\u89C8\u5668\u73AF\u5883\u7684"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"function getDefaultAdapter() {\r\n  var adapter;\r\n  // \u901A\u8FC7\u6D4F\u89C8\u5668\u548C node \u72EC\u6709\u7684 API \u786E\u5B9A\u5F53\u524D\u73AF\u5883\r\n  if (typeof XMLHttpRequest !== 'undefined') {\r\n    // For browsers use XHR adapter\r\n    adapter = require('./adapters/xhr');\r\n  } else if (typeof process !== 'undefined' && \r\n    Object.prototype.toString.call(process) === '[object process]') {\r\n    // For node use HTTP adapter\r\n    adapter = require('./adapters/http');\r\n  }\r\n  return adapter;\r\n}\n"})}),"\n",(0,a.jsx)(r.h3,{id:"\u914D\u7F6E",children:"\u914D\u7F6E"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js"})}),"\n",(0,a.jsx)(r.p,{children:"\u89E3\u51B3\u8DE8\u57DF\u95EE\u9898"}),"\n",(0,a.jsxs)(r.p,{children:["\u5982\u679C ",(0,a.jsx)(r.code,{children:"server"})," \u7AEF\u662F\u81EA\u5DF1\u5F00\u53D1\u7684\uFF0C\u90A3\u4E48\u4FEE\u6539\u76F8\u5173\u4EE3\u7801\u652F\u6301\u8DE8\u57DF\u5373\u53EF\u3002\u5982\u679C\u4E0D\u662F\u81EA\u5DF1\u5F00\u53D1\u7684\uFF0C\u90A3\u4E48\u53EF\u4EE5\u81EA\u5DF1\u5199\u4E2A\u540E\u7AEF\u8F6C\u53D1\u8BE5\u8BF7\u6C42\uFF0C\u7528\u4EE3\u7406\u7684\u65B9\u5F0F\u5B9E\u73B0\u3002"]}),"\n",(0,a.jsxs)(r.p,{children:["\u8DE8\u57DF\u8FD9\u4E2A\u884C\u4E3A\u662F",(0,a.jsx)(r.strong,{children:"\u6D4F\u89C8\u5668\u7981\u6B62"}),"\uFF08\u6D4F\u89C8\u5668\u4E0D\u5141\u8BB8\u5F53\u524D\u9875\u9762\u7684\u6240\u5728\u7684\u6E90\u53BB\u8BF7\u6C42\u53E6\u4E00\u4E2A\u6E90\u7684\u6570\u636E\uFF09\u7684\uFF0C\u4F46\u662F\u670D\u52A1\u7AEF\u5E76\u4E0D\u7981\u6B62\u3002"]}),"\n",(0,a.jsx)(r.h2,{id:"\u63D2\u4EF6",children:"\u63D2\u4EF6"}),"\n",(0,a.jsx)(r.h3,{id:"axios-mock-adapter",children:"axios-mock-adapter"}),"\n",(0,a.jsx)(r.p,{children:"\u5B9E\u73B0 mock \u8BF7\u6C42"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'var axios = require("axios");\r\nvar MockAdapter = require("axios-mock-adapter");\r\n// \u5728\u9ED8\u8BA4\u7684Axios\u5B9E\u4F8B\u4E0A\u8BBE\u7F6Emock\u9002\u914D\u5668\r\nvar mock = new MockAdapter(axios);\r\n// \u6A21\u62DF GET /users \u8BF7\u6C42\r\nmock.onGet("/users").reply(200, {\r\n  users: [{ id: 1, name: "John Smith" }],\r\n});\r\n// \u8FDB\u884C\u8BF7\u6C42\r\naxios.get("/users").then(function (response) {\r\n  console.log(response.data);\r\n});\n'})}),"\n",(0,a.jsx)(r.h2,{id:"\u5EFA\u8BAE\u914D\u7F6E",children:"\u5EFA\u8BAE\u914D\u7F6E"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["\u6DFB\u52A0 ",(0,a.jsx)(r.code,{children:"token"})," \u9A8C\u8BC1"]}),"\n",(0,a.jsx)(r.li,{children:"\u63A7\u5236\u67D0\u4E9B\u8BF7\u6C42\u7684\u8C03\u7528\u9891\u7387"}),"\n",(0,a.jsx)(r.li,{children:"\u6DFB\u52A0\u4E00\u4E9B\u5168\u5C40\u6D88\u606F\u63D0\u9192"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"import axios form 'axios'\r\naxios.defaults.timeout = 5000 // \u54CD\u5E94\u8D85\u65F6\u65F6\u95F4\r\naxios.defaults.baseURL = 'http://localhost:3000' // \u9ED8\u8BA4\u57FA\u51C6\u5730\u5740\r\naxios.interceptors.request.use((config)=>{\r\n  // ... \u5176\u5B83\u903B\u8F91\r\n  config.headers.token = \"input your token\"\r\n  return config // \u5FC5\u987B\u8FD4\u56DE\u914D\u7F6E\r\n})\r\nimport config from './config'\r\nconst httpFetch = axios.create(config)\r\n// \u914D\u7F6E\u62E6\u622A\u8BF7\u6C42\r\nhttpFetch.interreceptors.request.use(req=>{\r\n  // setting\r\n  req.headers.token = 'set your token'\r\n})\r\nhttpFetch.interreceptors.response.use(res=>{\r\n  if(res.data && typeof res.data == 'string'){\r\n    res.data = JSON.parse(res.data)\r\n  }\r\n  // \u5176\u4ED6\u64CD\u4F5C\r\n})\n"})}),"\n",(0,a.jsx)(r.h2,{id:"\u53C2\u8003\u6587\u7AE0",children:"\u53C2\u8003\u6587\u7AE0"}),"\n",(0,a.jsxs)(r.table,{children:[(0,a.jsx)(r.thead,{children:(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.th,{children:"\u4F5C\u8005"}),(0,a.jsx)(r.th,{children:"\u6587\u7AE0\u5730\u5740"})]})}),(0,a.jsxs)(r.tbody,{children:[(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"\u3010vue\u5B66\u4E60\u3011axios"}),(0,a.jsx)(r.td,{children:(0,a.jsx)(r.a,{href:"https://www.jianshu.com/p/d771bbc61dab",children:"https://www.jianshu.com/p/d771bbc61dab"})})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"\u963F\u5B9D\u54E5"}),(0,a.jsx)(r.td,{children:(0,a.jsx)(r.a,{href:"https://juejin.cn/post/6885471967714115597",children:"https://juejin.cn/post/6885471967714115597"})})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{}),(0,a.jsx)(r.td,{})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{}),(0,a.jsx)(r.td,{})]})]})]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"export const handleRequestHeader = (config) => {\r\n  config.header['token'] = localStorage.getItem('token') || token || ''\r\n  config['xxxx'] = 'xxx'\r\n  return config\r\n}\r\nexport const handleLogout = ()=>{\r\n  message.info(\"\u7528\u6237\u5DF2\u767B\u51FA\")\r\n}\r\nexport const handleNetworkError = (errStatus) => {\r\n  let errMessage = '\u672A\u77E5\u9519\u8BEF'\r\n  if (errStatus) {\r\n    switch (errStatus) {\r\n      case 400:\r\n        errMessage = '\u9519\u8BEF\u7684\u8BF7\u6C42';        break\r\n      case 401:\r\n        errMessage = '\u672A\u6388\u6743\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55';        break\r\n      case 403:\r\n        errMessage = '\u62D2\u7EDD\u8BBF\u95EE';        break\r\n      case 404:\r\n        errMessage = '\u8BF7\u6C42\u9519\u8BEF,\u672A\u627E\u5230\u8BE5\u8D44\u6E90';        break\r\n      case 405:\r\n        errMessage = '\u8BF7\u6C42\u65B9\u6CD5\u672A\u5141\u8BB8';        break\r\n      case 408:\r\n        errMessage = '\u8BF7\u6C42\u8D85\u65F6';        break\r\n      case 500:\r\n        errMessage = '\u670D\u52A1\u5668\u7AEF\u51FA\u9519';        break\r\n      case 501:\r\n        errMessage = '\u7F51\u7EDC\u672A\u5B9E\u73B0';        break\r\n      case 502:\r\n        errMessage = '\u7F51\u7EDC\u9519\u8BEF';        break\r\n      case 503:\r\n        errMessage = '\u670D\u52A1\u4E0D\u53EF\u7528';        break\r\n      case 504:\r\n        errMessage = '\u7F51\u7EDC\u8D85\u65F6';        break\r\n      case 505:\r\n        errMessage = 'http\u7248\u672C\u4E0D\u652F\u6301\u8BE5\u8BF7\u6C42';        break\r\n      default:\r\n        errMessage = `\u5176\u4ED6\u8FDE\u63A5\u9519\u8BEF --${errStatus}`\r\n    }\r\n  } else {\r\n    errMessage = `\u65E0\u6CD5\u8FDE\u63A5\u5230\u670D\u52A1\u5668\uFF01`\r\n  }\r\n  message.error(errMessage)\r\n}\r\nexport const handleAuthError = (errno) => {\r\n  const authErrMap = {\r\n    '10031': '\u767B\u5F55\u5931\u6548\uFF0C\u9700\u8981\u91CD\u65B0\u767B\u5F55', // token \u5931\u6548\r\n    '10032': '\u60A8\u592A\u4E45\u6CA1\u767B\u5F55\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55~', // token \u8FC7\u671F\r\n    '10033': '\u8D26\u6237\u672A\u7ED1\u5B9A\u89D2\u8272\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u7ED1\u5B9A\u89D2\u8272',\r\n    '10034': '\u8BE5\u7528\u6237\u672A\u6CE8\u518C\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u6CE8\u518C\u7528\u6237',\r\n    '10035': 'code \u65E0\u6CD5\u83B7\u53D6\u5BF9\u5E94\u7B2C\u4E09\u65B9\u5E73\u53F0\u7528\u6237',\r\n    '10036': '\u8BE5\u8D26\u6237\u672A\u5173\u8054\u5458\u5DE5\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u505A\u5173\u8054',\r\n    '10037': '\u8D26\u53F7\u5DF2\u65E0\u6548',\r\n    '10038': '\u8D26\u53F7\u672A\u627E\u5230',\r\n  }\r\n  if (authErrMap.hasOwnProperty(errno)) {\r\n    message.error(authErrMap[errno])\r\n    // \u6388\u6743\u9519\u8BEF\uFF0C\u767B\u51FA\u8D26\u6237\r\n    handleLogout()\r\n    return false\r\n  }\r\n  return true\r\n}\r\nconst handleGeneralError = (errno, errmsg) => {\r\n  if (err.errno !== '0') {\r\n    meessage.error(err.errmsg)\r\n    return false\r\n  }\r\n  return true\r\n}\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"import axios from 'axios'\r\nimport { message } from 'antd'\r\nimport {\r\n  handleChangeRequestHeader,\r\n  handleConfigureAuth,\r\n  handleAuthError,\r\n  handleGeneralError,\r\n  handleNetworkError\r\n} from './tools'\r\ntype Fn = (data: FcResponse<any>) => unknown\r\naxios.interceptors.request.use((config) => {\r\n  config = handleChangeRequestHeader(config)\r\n  config = handleConfigureAuth(config)\r\n  return config\r\n})\r\naxios.interceptors.response.use(\r\n  (response) => {\r\n    if (response.status !== 200) return Promise.reject(response.data)\r\n    handleAuthError(response.data.errno)\r\n    handleGeneralError(response.data.errno, response.data.errmsg)\r\n    return response\r\n  },\r\n  (err) => {\r\n    handleNetworkError(err.response.status)\r\n    Promise.reject(err.response)\r\n  }\r\n)\r\nexport const Get = <T,>(url, params, clearFn) => new Promise((resolve) => {\r\n  axios.get(url, { params }).then((result) => {\r\n    let res: FcResponse<T>\r\n      if (clearFn !== undefined) {\r\n        res = clearFn(result.data) as unknown as FcResponse<T>\r\n      } else {\r\n        res = result.data as FcResponse<T>\r\n      }\r\n        resolve([null, res as FcResponse<T>])\r\n      })\r\n        .catch((err) => {\r\n          resolve([err, undefined])\r\n        })\r\n      })\r\nexport const Post = (url, data, params) => {\r\n    return new Promise((resolve) => {\r\n      axios.post(url, data, { params }).then((result) => {\r\n        resolve([null, result.data as FcResponse<T>])\r\n      })\r\n        .catch((err) => {\r\n        resolve([err, undefined])\r\n      })\r\n    })\r\n  }\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'import { userApi } from "./path/user"\r\nimport { shoporderApi } from "./path/shoporder"\r\nexport const api = {\r\n	...userApi,\r\n	...shoporderApi\r\n}\n'})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'import { Get } from "../server"\r\nexport function getUserInfo(id) { ... }\r\nexport function getUserName(id) { ... }\r\nexport const userApi = {\r\n	getUserInfo,\r\n	getUserName\r\n}\n'})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'import { Get } from "../server"\r\nfunction getShoporderDetail() { ... }\r\nfunction getShoporderList() { ... }\r\nexport const shoporderApi = {\r\n	getShoporderDetail,\r\n	getShoporderList\r\n}\n'})})]})}function h(e={}){let{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},65:function(e,r,n){n.d(r,{Z:function(){return i},a:function(){return o}});var s=n(7294);let a={},t=s.createContext(a);function o(e){let r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);