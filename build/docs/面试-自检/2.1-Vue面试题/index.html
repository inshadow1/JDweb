<!doctype html><html lang=zh-CN dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-面试-自检/2.1-Vue面试题" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>2.1-Vue面试题 | Yelv的笔记本</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://yelv.site/docs/面试-自检/2.1-Vue面试题><meta data-rh=true property=og:locale content=zh_CN><meta data-rh=true name=docusaurus_locale content=zh-CN><meta data-rh=true name=docsearch:language content=zh-CN><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="2.1-Vue面试题 | Yelv的笔记本"><meta data-rh=true name=description content=Vue三大功能><meta data-rh=true property=og:description content=Vue三大功能><link data-rh=true rel=icon href=/./svg/fallen_leaf.svg><link data-rh=true rel=canonical href=https://yelv.site/docs/面试-自检/2.1-Vue面试题><link data-rh=true rel=alternate href=https://yelv.site/docs/面试-自检/2.1-Vue面试题 hreflang=zh-CN><link data-rh=true rel=alternate href=https://yelv.site/docs/面试-自检/2.1-Vue面试题 hreflang=x-default><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Yelv的笔记本 RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Yelv的笔记本 Atom Feed"><link rel=stylesheet href=/assets/css/styles.dec9d19f.css><script src=/assets/js/runtime~main.1cedaab2.js defer></script><script src=/assets/js/main.778ab905.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label=跳到主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳到主要内容</a></div><nav aria-label=主导航 class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class=navbar__items><button aria-label=切换导航栏 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/./svg/boy_avatar.svg alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/./svg/boy_avatar.svg alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Yelv 的笔记本</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/docs/前端环境搭建>笔记</a><a class="navbar__item navbar__link" href=/blog>Blog</a></div><div class="navbar__items navbar__items--right"><a href=https://github.com/inshadow1 target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title=切换浅色/暗黑模式（当前为浅色模式） aria-label=切换浅色/暗黑模式（当前为浅色模式） aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=回到顶部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/><img src=/./svg/boy_avatar.svg alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/./svg/boy_avatar.svg alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Yelv 的笔记本</b></a><nav aria-label=文档侧边栏 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/html-和-css>HTML 和 CSS</a><button aria-label="展开侧边栏分类 'HTML 和 CSS'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/javascript--typescript>JavaScript & TypeScript</a><button aria-label="展开侧边栏分类 'JavaScript & TypeScript'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/大前端知识点>大前端知识点</a><button aria-label="展开侧边栏分类 '大前端知识点'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/npm-包>npm 包</a><button aria-label="展开侧边栏分类 'npm 包'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/vue>Vue</a><button aria-label="展开侧边栏分类 'Vue'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/react>React</a><button aria-label="展开侧边栏分类 'React'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/后端>后端</a><button aria-label="展开侧边栏分类 '后端'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/linux--命令行>Linux & 命令行</a><button aria-label="展开侧边栏分类 'Linux & 命令行'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/数据库>数据库</a><button aria-label="展开侧边栏分类 '数据库'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/多平台开发>多平台开发</a><button aria-label="展开侧边栏分类 '多平台开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/其它语言>其它语言</a><button aria-label="展开侧边栏分类 '其它语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/软件工程知识>软件工程知识</a><button aria-label="展开侧边栏分类 '软件工程知识'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/category/人工智能>人工智能</a><button aria-label="展开侧边栏分类 '人工智能'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/category/面试-自检>面试-自检</a><button aria-label="折叠侧边栏分类 '面试-自检'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href="/docs/面试-自检/-- 自检清单">-- 自检清单</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/面试-自检/1.1-HTML、CSS知识点>1.1-HTML、CSS知识点</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/面试-自检/1.2-JS知识点>1.2-JS知识点</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/面试-自检/1.3-网络知识点>1.3-网络知识点</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/面试-自检/1.4-前端知识点>1.4-前端知识点</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/面试-自检/2.1-Vue面试题>2.1-Vue面试题</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href="/docs/面试-自检/2.2-React 面试题">2.2-React 面试题</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href="/docs/面试-自检/3.1-node 知识点">3.1-node 知识点</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href="/docs/面试-自检/3.2-npm 包相关知识">3.2-npm 包相关知识</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/面试-自检/4.1-选择面试题>4.1-选择面试题</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/面试-自检/4.2-读代码>4.2-读代码</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/docs/面试-自检/4.3-算法题>4.3-算法题</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/面试-自检/legacy/Vue2>legacy</a></div></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/git工具>git工具</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href="/docs/npm 和 nvm 的使用">npm 和 nvm 的使用</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/前端环境搭建>前端环境搭建</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/学习资料>学习资料</a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=页面路径><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label=主页面 class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/category/面试-自检><span itemprop=name>面试-自检</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>2.1-Vue面试题</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>2.1-Vue面试题</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue三大功能>Vue三大功能<a href=#vue三大功能 class=hash-link aria-label=Vue三大功能的直接链接 title=Vue三大功能的直接链接>​</a></h2>
<ul>
<li>响应式：监听到数据变化</li>
<li>模板引擎：解析模板</li>
<li>渲染原理：如何将监听到的数据变化和解析后的 HTML 渲染</li>
</ul>
<p><strong>响应式</strong>：vue2 使用的是 <code>Object.defineProperty</code>，vue3 使用的是 Proxy</p>
<p><strong>模板引擎</strong>：使用正则进行解析，解析成 JS 代码，然后使用</p>
<p><strong>渲染原理</strong>：虚拟 DOM</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=简单>简单<a href=#简单 class=hash-link aria-label=简单的直接链接 title=简单的直接链接>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=组件通讯方式有哪些方法>组件通讯方式有哪些方法<a href=#组件通讯方式有哪些方法 class=hash-link aria-label=组件通讯方式有哪些方法的直接链接 title=组件通讯方式有哪些方法的直接链接>​</a></h3>
<ul>
<li><code>props</code> 和 <code>$emit</code> 父组件向子组件传递数据是通过 prop 传递的，子组件传递数据给父组件是通过 <code>$emit</code> 触发事件来做到的</li>
<li><code>$parent</code>，<code>$children</code> 获取当前组件的父组件和当前组件的子组件</li>
<li><code>$attrs</code> 和 <code>$listeners A->B->C</code>。Vue 2.4 开始提供了 <code>$attrs</code> 和 <code>$listeners</code> 来解决这个问题</li>
<li>父组件中通过 <code>provide</code> 来提供变量，然后在子组件中通过 <code>inject</code> 来注入变量。</li>
<li><code>$refs</code> 和 <code>ref</code> 获取组件实例，变量在组合式 API 中需要 <code>defineExpose</code> 或者显示导出</li>
<li><code>envetBus</code> 兄弟组件数据传递，这种情况下可以使用事件总线的方式</li>
<li><code>vuex</code> 状态管理</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=nexttick-原理>nextTick 原理<a href=#nexttick-原理 class=hash-link aria-label="nextTick 原理的直接链接" title="nextTick 原理的直接链接">​</a></h3>
<p>nextTick 中的回调是在下次 DOM 更新循环结束之后执行的延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM。主要思路就是采用微任务优先的方式调用异步方法去执行 nextTick 包装的方法</p>
<p>相关代码如下</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> callbacks </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> pending </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>flushCallbacks</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  pending </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//把标志还原为false</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 依次执行回调</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> callbacks</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">length</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    callbacks</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> timerFunc</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//定义异步方法  采用优雅降级</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>typeof</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"undefined"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 如果支持promise</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> p </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>resolve</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    p</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>then</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>typeof</span><span class="token plain"> </span><span class="token maybe-class-name">MutationObserver</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"undefined"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// MutationObserver 主要是监听 dom 变化，也是一个异步方法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> counter </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> observer </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">MutationObserver</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> textNode </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token dom variable" style=color:#36acaa>document</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>createTextNode</span><span class="token punctuation" style=color:#393A34>(</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">counter</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  observer</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>observe</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">textNode</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token literal-property property" style=color:#36acaa>characterData</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    counter </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">counter </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    textNode</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">data</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">counter</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>typeof</span><span class="token plain"> setImmediate </span><span class="token operator" style=color:#393A34>!==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"undefined"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 如果前面都不支持 判断setImmediate</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>setImmediate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>else</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 最后降级采用 setTimeout</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>setTimeout</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword module" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>nextTick</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">cb</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 除了渲染 watcher 还有用户自己手动调用的nextTick 一起被收集到数组</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  callbacks</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">cb</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token plain">pending</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 如果多次调用 nextTick 只会执行一次异步 等异步队列清空之后再把标志变为 false</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pending </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>timerFunc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue30-了解多少>vue3.0 了解多少<a href=#vue30-了解多少 class=hash-link aria-label="vue3.0 了解多少的直接链接" title="vue3.0 了解多少的直接链接">​</a></h3>
<ul>
<li>响应式原理的改变 Vue3.x 使用 Proxy 取代 Vue2.x 版本的 <code>Object.defineProperty</code></li>
<li>组件声明方式 Vue3.x 新增了 Composition API（组合式 API），Vue2 是选项式 API。</li>
<li>模板语法变化 slot 具名插槽语法，自定义指令 v-model 升级</li>
<li>其它方面的更改 Suspense 支持 Fragment（多个根节点）和 Protal（在 dom 其他部分渲染组建内容）组件，针对一些特殊的场景做了处理。基于 treeshaking 优化，提供了更多的内置功能。</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-diff-原理>Vue diff 原理<a href=#vue-diff-原理 class=hash-link aria-label="Vue diff 原理的直接链接" title="Vue diff 原理的直接链接">​</a></h3>
<ul>
<li>先对比标签（标签是否相同）</li>
<li>元素标签不同直接替换</li>
<li>元素标签相同<!-- -->
<ul>
<li>标签一致后查看属性是否一致（不一致的进行替换</li>
<li>对比子元素<!-- -->
<ul>
<li>都有子元素，进行指针方式对比是否为同一个节点，是则复用</li>
<li>新有子元素，旧无子元素，将子元素虚拟节点转换为真实节点后进行插入</li>
<li>新的无子元素，旧有子元素，直接清空 <code>innerHtml</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=mvc-和-mvvm-区别>MVC 和 MVVM 区别<a href=#mvc-和-mvvm-区别 class=hash-link aria-label="MVC 和 MVVM 区别的直接链接" title="MVC 和 MVVM 区别的直接链接">​</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=mvc>MVC<a href=#mvc class=hash-link aria-label=MVC的直接链接 title=MVC的直接链接>​</a></h4>
<p>MVC 全名是 Model View Controller，是模型（model）－视图（view）－控制器（controller）的缩写，一种软件设计典范</p>
<ul>
<li>Model（模型）：是应用程序中用于处理应用程序数据逻辑的部分。通常模型对象负责在数据库中存取数据</li>
<li>View（视图）：是应用程序中处理数据显示的部分。通常视图是依据模型数据创建的</li>
<li>Controller（控制器）：是应用程序中处理用户交互的部分。通常控制器负责从视图读取数据，控制用户输入，并向模型发送数据</li>
</ul>
<img src=https://filescdn.proginn.com/8d0163ed29f2ed3be88558271f2db16e/8c2f2df56c0b575539f3f5ba37ebecb9.webp alt=img>
<p>MVC 的思想：一句话描述就是 Controller 负责将 Model 的数据用 View 显示出来，换句话说就是在 Controller 里面把 Model 的数据赋值给 View。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=mvvm>MVVM<a href=#mvvm class=hash-link aria-label=MVVM的直接链接 title=MVVM的直接链接>​</a></h4>
<p>MVVM 新增了 VM 类</p>
<ul>
<li>ViewModel 层：做了两件事达到了数据的双向绑定 一是将【模型】转化成【视图】，即将后端传递的数据转化成所看到的页面。实现的方式是：数据绑定。二是将【视图】转化成【模型】，即将所看到的页面转化成后端的数据。实现的方式是：DOM 事件监听。</li>
</ul>
<p><img decoding=async loading=lazy src=https://filescdn.proginn.com/08efd2b341653b42fd006390554e400c/a5b5d809e339c21cd63b46d616b1fdd4.webp alt=img class=img_ev3q>mvvm.png</p>
<p>MVVM 与 MVC 最大的区别就是：它实现了 View 和 Model 的自动同步，也就是当 Model 的属性改变时，我们不用再自己手动操作 Dom 元素，来改变 View 的显示，而是改变属性后该属性对应 View 层显示会自动改变（对应Vue数据驱动的思想）</p>
<p>整体看来，MVVM 比 MVC 精简很多，不仅简化了业务与界面的依赖，还解决了数据频繁更新的问题，不用再用选择器操作 DOM 元素。因为在 MVVM 中，View 不知道 Model 的存在，Model 和 ViewModel 也观察不到 View，这种低耦合模式提高代码的可重用性</p>
<blockquote>
<p>注意：Vue 并没有完全遵循 MVVM 的思想 这一点官网自己也有说明：</p>
<p>引自官网：<a href=https://v2.cn.vuejs.org/v2/guide/instance.html target=_blank rel="noopener noreferrer">https://v2.cn.vuejs.org/v2/guide/instance.html</a></p>
<p>严格的 MVVM 要求 View 不能和 Model 直接通信，而 Vue 提供了$refs 这个属性，让 Model 可以直接操作 View，违反了这一规定，所以说 Vue 没有完全遵循 MVVM。</p>
<p>Vue3 官网已经找不到关于 MVVM 模型的描述</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=data-为什么是函数>data 为什么是函数<a href=#data-为什么是函数 class=hash-link aria-label="data 为什么是函数的直接链接" title="data 为什么是函数的直接链接">​</a></h3>
<p>组件中的 data 写成一个函数，数据以函数返回值形式定义，这样每复用一次组件，就会返回一份新的 data，类似于给每个组件实例创建一个私有的数据空间，让各个组件实例维护各自的数据。而单纯的写成对象形式，就使得所有组件实例共用了一份 data，会造成一个组件的实例值改变，其它组件实例全都会变的结果。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=生命周期方法有哪些一般在哪一步发请求>生命周期方法有哪些一般在哪一步发请求<a href=#生命周期方法有哪些一般在哪一步发请求 class=hash-link aria-label=生命周期方法有哪些一般在哪一步发请求的直接链接 title=生命周期方法有哪些一般在哪一步发请�求的直接链接>​</a></h3>
<ul>
<li><code>beforeCreate</code>：在实例初始化之后，数据观测（<code>data observer</code>）和 <code>event/watcher</code> 事件配置之前被调用。在当前阶段 data、methods、computed 以及 watch 上的数据和方法都不能被访问</li>
<li><code>created</code>：实例已经创建完成之后被调用。在这一步，实例已完成以下的配置：数据观测（data observer），属性和方法的运算， watch/event 事件回调。此时 DOM 还没有渲染，如果非要想与进行交互，可以通过 nextTick 来访问 DOM</li>
<li><code>beforeMount</code>：在挂载开始之前被调用：render 函数首次被调用。</li>
<li><code>mounted</code>：在挂载完成后发生，在当前阶段，真实的 Dom 挂载完毕，数据完成双向绑定，可以访问到 DOM 节点。</li>
<li><code>beforeUpdate</code>：数据更新时调用，发生在虚拟 DOM 重新渲染和打补丁（patch）之前。可以在这个钩子中进一步地更改状态，这不会触发附加的重渲染过程。</li>
<li><code>updated</code>：发生在更新完成之后，当前阶段组件 DOM 已完成更新。要注意的是避免在此期间更改数据，因为这可能会导致无限循环的更新，该钩子在服务器端渲染期间不被调用。</li>
<li><code>beforeDestroy</code>：实例销毁之前调用。在这一步，实例仍然完全可用。我们可以在这时进行善后收尾工作，比如清除计时器。</li>
<li><code>destroyed</code>：Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。该钩子在服务器端渲染期间不被调用。</li>
</ul>
<p>还有两个生命周期的方法只在 keep-alive 的组件中触发，缓存树中的后代组件也同样适用。</p>
<ul>
<li><code>activated</code>：在首次挂载，以及组件从不活跃再次到活跃状态时调用</li>
<li><code>deactivated</code>：在从 DOM 上移除、进入缓存组件以及组件卸载时调用</li>
</ul>
<p>异步请求通常在哪个生命周期发起？</p>
<p>可以在钩子函数 <code>created</code>、<code>beforeMount</code>、<code>mounted</code> 中进行异步请求，因为在这三个钩子函数中，data 已经创建，可以将服务端端返回的数据进行赋值。</p>
<p>如果异步请求不需要依赖 DOM 推荐在 created 钩子函数中调用异步请求，原因如下：</p>
<ul>
<li>在 created 钩子函数中调用异步请求能更快获取到服务端数据，减少页面 loading 时间</li>
<li>只有 <code>beforeCreate</code> 和 <code>created</code> 这两个钩子会在 SSR 期间被调用，SSR 不支持 <code>beforeMount</code>、<code>mounted</code> 钩子函数。</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=v-if-和-v-show-的区别>v-if 和 v-show 的区别<a href=#v-if-和-v-show-的区别 class=hash-link aria-label="v-if 和 v-show 的区别的直接链接" title="v-if 和 v-show 的区别的直接链接">​</a></h3>
<p>v-if 在编译过程中会被转化成三元表达式，条件不满足时不渲染此节点。</p>
<p>v-show 会被编译成指令，条件不满足时控制样式将对应节点隐藏（<code>display:none</code>）</p>
<p><strong>使用场景</strong></p>
<p>v-if 适用于在运行时很少改变条件，不需要频繁切换条件的场景</p>
<p>v-show 适用于需要非常频繁切换条件的场景</p>
<blockquote>
<p>扩展补充：<code>display:none</code>、<code>visibility:hidden</code> 和 <code>opacity:0</code> 之间的区别？</p>
<ul>
<li><code>display:none</code>：DOM 隐藏</li>
<li><code>visibility:hidden</code>：不可见，且无法触发事件</li>
<li><code>opacity:0</code>：只是不可见，还可以触发 DOM 的事件，比如 input</li>
</ul>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=内置指令都有那些>内置指令都有那些<a href=#内置指令都有那些 class=hash-link aria-label=内置指令都有那些的直接链接 title=内置指令都有那些的直接链接>​</a></h3>
<ul>
<li><code>v-text</code>：更新元素的文本内容。</li>
<li><code>v-html</code>：更新元素的 <code>innerHTML</code>。</li>
<li><code>v-show</code>：基于表达式值的真假，改变元素的可见性。</li>
<li><code>v-if</code>、<code>v-else-if</code>、<code>v-else</code>：基于表达式值的真假，条件性地渲染元素或者模板片段。</li>
<li><code>v-for </code>：基于原始数据多次渲染元素或模板块。</li>
<li><code>v-on</code>：给元素绑定事件监听器。</li>
<li><code>v-bind</code>：动态的绑定一个或多个 attribute，也可以是组件的 prop。</li>
<li><code>v-model</code>：在表单输入元素或组件上创建双向绑定。</li>
<li><code>v-slot</code>：用于声明具名插槽或是期望接收 props 的作用域插槽。</li>
<li><code>v-pre</code>：跳过该元素及其所有子元素的编译。</li>
<li><code>v-once</code>：该组件及所有节点只渲染一次，首次渲染后，不会随着数据的变化重新渲染，而是被视为静态内容。</li>
<li><code>v-memo</code>：缓存一个模板的子树。传入一个数组，数组中的每个值都与最后一次的渲染相同，整个子树将跳过更新。</li>
<li><code>v-cloak</code>：用于隐藏尚未完成编译的 DOM 模板（<strong>仅在不需要构建的环境下使用</strong>）</li>
</ul>
<blockquote>
<p><code>v-for</code> 使用 <code>v-memo</code>，确保两者都绑定在同一个元素上。<strong><code>v-memo</code> 不能用在 <code>v-for</code> 内部。</strong></p>
</blockquote>
<p><a href=#%E5%A6%82%E4%BD%95%E5%86%99%E4%B8%80%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4>自定义指令</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=如何写一个自定义指令>如何写一个自定义指令<a href=#如何写一个自定义指令 class=hash-link aria-label=如何写一个自定义指令��的直接链接 title=如何写一个自定义指令的直接链接>​</a></h3>
<p>指令本质上是装饰器，是 vue 对 HTML 元素的扩展，给 HTML 元素增加自定义功能。vue 编译 DOM 时，会找到指令对象，执行指令的相关方法。</p>
<p>自定义指令生命周期和组件相同，分别是 created、beforeMount、mounted、beforeUpdate、updated、beforeUnmount、unmounted</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>directive</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'focus'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 在绑定元素的 attribute 前</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 或事件监听器应用前调用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>created</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">el</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> vnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> prevVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 下面会介绍各个参数的细节</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 在元素被插入到 DOM 前调用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>beforeMount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">el</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> vnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> prevVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 在绑定元素的父组件</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 及他自己的所有子节点都挂载完成后调用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>mounted</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">el</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> vnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> prevVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 绑定元素的父组件更新前调用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>beforeUpdate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">el</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> vnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> prevVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 在绑定元素的父组件</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 及他自己的所有子节点都更新后调用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>updated</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">el</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> vnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> prevVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 绑定元素的父组件卸载前调用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>beforeUnmount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">el</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> vnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> prevVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 绑定元素的父组件卸载后调用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function" style=color:#d73a49>unmounted</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">el</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> vnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> prevVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<ul>
<li><code>el</code>：指令绑定到的元素。这可以用于直接操作 DOM。</li>
<li><code>binding</code>：一个对象，包含以下属性。<!-- -->
<ul>
<li><code>value</code>：传递给指令的值。例如在 <code>v-my-directive="1 + 1"</code> 中，值是 <code>2</code>。</li>
<li><code>oldValue</code>：之前的值，仅在 <code>beforeUpdate</code> 和 <code>updated</code> 中可用。无论值是否更改，它都可用。</li>
<li><code>arg</code>：传递给指令的参数 (如果有的话)。例如在 <code>v-my-directive:foo</code> 中，参数是 <code>"foo"</code>。</li>
<li><code>modifiers</code>：一个包含修饰符的对象 (如果有的话)。例如在 <code>v-my-directive.foo.bar</code> 中，修饰符对象是 <code>{ foo: true, bar: true }</code>。</li>
<li><code>instance</code>：使用该指令的组件实例。</li>
<li><code>dir</code>：指令的定义对象。</li>
</ul>
</li>
<li><code>vnode</code>：代表绑定元素的底层 VNode。</li>
<li><code>prevNode</code>：代表之前的渲染中指令所绑定元素的 VNode。仅在 <code>beforeUpdate</code> 和 <code>updated</code> 钩子中可用。</li>
</ul>
<blockquote>
<p>当应用到一个多根组件时，指令将会被忽略且抛出一个警告。</p>
</blockquote>
<p><strong>原理</strong></p>
<ul>
<li>在生成 ast 语法树时，遇到指令会给当前元素添加 directives 属性</li>
<li>通过 genDirectives 生成指令代码</li>
<li>在 patch 前将指令的钩子提取到 cbs 中，在 patch 过程中调用对应的钩子</li>
<li>当执行指令对应钩子函数时，调用对应指令定义的方法</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=怎样理解-vue-的单向数据流>怎样理解 Vue 的单向数据流<a href=#怎样理解-vue-的单向数据流 class=hash-link aria-label="怎样理解 Vue 的单向数据流的直接链接" title="怎样理解 Vue 的单向数据流的直接链接">​</a></h3>
<p>数据总是从父组件传到子组件，子组件没有权利修改父组件传过来的数据，只能请求父组件对原始数据进行修改。这样会防止从子组件意外改变父级组件的状态，从而导致你的应用的数据流向难以理解。</p>
<blockquote>
<p>注意：在子组件直接用 v-model 绑定父组件传过来的 prop 这样是不规范的写法，开发环境会报警告</p>
</blockquote>
<p>如果实在要改变父组件的 prop 值 可以再 data 里面定义一个变量 并用 prop 的值初始化它 之后用 $emit 通知父组件去修改</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=computed-和-watch-的区别和运用的场景>computed 和 watch 的区别和运用的场景<a href=#computed-和-watch-的区别和运用的场景 class=hash-link aria-label="computed 和 watch 的区别和运用的场景的直接链接" title="computed 和 watch 的区别和运用的场景的直接链接">​</a></h3>
<p>computed 是计算属性，依赖其他属性计算值，并且 computed 的值有缓存，只有当计算值变化才会返回内容，它可以设置 getter 和 setter。</p>
<p>watch 监听到值的变化就会执行回调，在回调中可以进行一些逻辑操作。</p>
<p>计算属性一般用在模板渲染中，某个值是依赖了其它的响应式对象甚至是计算属性计算而来；而侦听属性适用于观测某个值的变化去完成一段复杂的业务逻辑</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=v-if-与-v-for-为什么不建议一起使用>v-if 与 v-for 为什么不建议一起使用<a href=#v-if-与-v-for-为什么不建议一起使用 class=hash-link aria-label="v-if 与 v-for 为什么不建议一起使用的直接链接" title="v-if 与 v-for 为什么不建议一起使用的直接链接">​</a></h3>
<p>2.x 版本中在一个元素上同时使用 <code>v-if</code> 和 <code>v-for</code> 时，<code>v-for</code> 会优先作用。</p>
<p>3.x 版本中 <code>v-if</code> 总是优先于 <code>v-for</code> 生效。</p>
<p>v-for 和 v-if 不要在同一个标签中使用，因为容易导致逻辑混乱。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-事件绑定原理>Vue 事件绑定原理<a href=#vue-事件绑定原理 class=hash-link aria-label="Vue 事件绑定原理的直接链接" title="Vue 事件绑定原理的直接链接">​</a></h3>
<p>原生事件绑定是通过 <code>addEventListener</code> 绑定给真实元素的，组件事件绑定是通过 Vue 自定义的 $on 实现的。如果要在组件上使用原生事件，需要加 .native 修饰符，这样就相当于在父组件中把子组件当做普通 html 标签，然后加上原生事件。</p>
<p>emit 是基于发布订阅模式的，维护一个事件中心，on 的时候将事件按名称存在事件中心里，称之为订阅者，然后 emit 将对应的事件进行发布，去执行事件中心里的对应的监听器</p>
<p>手写发布订阅原理 传送门</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=scoped-样式穿透是什么>Scoped 样式穿透是什么<a href=#scoped-样式穿透是什么 class=hash-link aria-label="Scoped 样式穿透是什么的直接链接" title="Scoped 样式穿透是什么的直接链接">​</a></h3>
<p>scoped 是 style 标签的一个属性，当在 style 标签中定义了 scoped 时，style 标签中的所有属性就只作用于当前组件的样式，实现组件样式私有化，从而也就不会造成样式全局污染。</p>
<p>项目开发中，多数情况下不能避免引用第三方组件，而第三方组件的样式又不全是我们想要的，就需要在组件中局部修改第三方组件的样式，但同时又不想去除 scoped 属性和避免样式污染。此时只能通过穿透 scoped，写法如下。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">&lt;style scoped></span><br></span><span class=token-line style=color:#393A34><span class="token plain"> 外层 > 第三方组件 {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  样式</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;/style></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=中等>中等<a href=#中等 class=hash-link aria-label=中等的直接链接 title=中等的直接链接>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=为什么要使用-proxy>为什么要使用 proxy<a href=#为什么要使用-proxy class=hash-link aria-label="为什么要使用 proxy的直接链接" title="为什么要使用 proxy的直接链接">​</a></h3>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue30-和-20-的响应式原理区别>Vue3.0 和 2.0 的响应式原理区别<a href=#vue30-和-20-的响应式原理区别 class=hash-link aria-label="Vue3.0 和 2.0 的响应式原理区别的直接链接" title="Vue3.0 和 2.0 的响应式原理区别的直接链接">​</a></h3>
<p>在 Vue2 中， <code>Object.defineProperty</code> 会改变原始数据，而 Proxy 是创建对象的虚拟表示，并提供 set 、get 和 deleteProperty 等处理器，这些处理器可在访问或修改原始对象上的属性时进行拦截，有以下特点∶</p>
<ul>
<li>不需用使用 <code>Vue.$set</code> 或 <code>Vue.$delete</code> 触发响应式。</li>
<li>全方位的数组变化检测，消除了 Vue2 无效的边界情况。</li>
<li>支持 Map，Set，WeakMap 和 WeakSet。</li>
</ul>
<p>Proxy 实现的响应式原理与 Vue2 的实现原理相同，实现方式大同小异∶</p>
<ul>
<li>get 收集依赖</li>
<li>Set、delete 等触发依赖</li>
<li>对于集合类型，就是对集合对象的方法做一层包装：原方法执行后执行依赖相关的收集或触发逻辑。</li>
</ul>
<p>Vue3.x 改用 Proxy 替代 Object.defineProperty。因为 Proxy 可以直接监听对象和数组的变化，并且有多达 13 种拦截方法。</p>
<p>相关代码如下</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword module" style=color:#00009f>import</span><span class="token plain"> </span><span class="token imports punctuation" style=color:#393A34>{</span><span class="token imports"> mutableHandlers </span><span class="token imports punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword module" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"./baseHandlers"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// 代理相关逻辑</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword module" style=color:#00009f>import</span><span class="token plain"> </span><span class="token imports punctuation" style=color:#393A34>{</span><span class="token imports"> isObject </span><span class="token imports punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword module" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"./util"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// 工具方法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword module" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>reactive</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">target</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 根据不同参数创建不同响应式对象</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>createReactiveObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mutableHandlers</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>createReactiveObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">target</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> baseHandler</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token function" style=color:#d73a49>isObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">target</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> target</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> observed </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">Proxy</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> baseHandler</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> observed</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> get </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>createGetter</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> set </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>createSetter</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>createGetter</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">target</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> key</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> receiver</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 对获取的值进行放射</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> res </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token known-class-name class-name">Reflect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> receiver</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"属性获取"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>isObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">res</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// 如果获取的值是对象类型，则返回当前对象的代理对象</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>reactive</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">res</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> res</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>createSetter</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>set</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">target</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> key</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> value</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> receiver</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> oldValue </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> target</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> hadKey </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>hasOwn</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> result </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token known-class-name class-name">Reflect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>set</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">target</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> receiver</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token plain">hadKey</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"属性新增"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>hasChanged</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> oldValue</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"属性值被修改"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> key</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> result</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword module" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> mutableHandlers </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  get</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// 当获取属性时调用此方法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  set</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// 当修改属性时调用此方法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=相比-vue-2vue-3-有哪些性能方面的提升>相比 Vue 2，Vue 3 有哪些性能方面的提升。<a href=#相比-vue-2vue-3-有哪些性能方面的提升 class=hash-link aria-label="相比 Vue 2，Vue 3 有哪些性能方面的提升。的直接链接" title="相比 Vue 2，Vue 3 有哪些性能方面的提升。的直接链接">​</a></h3>
<p>对于这个问题，我们可以从编译阶段、源码体积和响应式系统三个方面进行回答。</p>
<p>在编译阶段，Vue 3 做了如下一些优化：</p>
<ul>
<li>diff 算法优化</li>
<li>静态提升</li>
<li>事件监听缓存</li>
<li>SSR 优化</li>
</ul>
<p><strong>diff 算法优化</strong></p>
<p>vue3 在 diff 算法中相比 vue2 增加了静态标记。关于这个静态标记，其作用是为了会发生变化的地方添加一个 flag 标记，下次发生变化的时候直接找该地方进行比较，性能得到了进一步的提高。</p>
<p><strong>静态提升</strong></p>
<p>Vue3 中对不参与更新的元素，会做静态提升，只会被创建一次，在渲染时直接复用这样就免去了重复的创建节点，大型应用会受益于这个改动，免去了重复的创建操作，优化了运行时候的内存占用。</p>
<p><strong>事件监听缓存</strong></p>
<p>默认情况下绑定事件行为会被视为动态绑定，所以每次都会去追踪它的变化。开启了缓存后，没有了静态标记，也就是说下次 diff 算法的时候直接使用。</p>
<p><em><strong>*SSR优化*</strong></em></p>
<p>当静态内容大到一定量级时候，会用 createStaticVNode 方法在客户端去生成一个 static node，这些静态 node，会被直接 innerHtml，就不需要创建对象，然后根据对象渲染。</p>
<p>详细内容参考：<a href=https://vue3js.cn/interview/vue3/goal.html#%E4%B8%80%E3%80%81%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87 target=_blank rel="noopener noreferrer">https://vue3js.cn/interview/vue3/goal.html#%E4%B8%80%E3%80%81%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=谈谈你对-slot-的理解以及-slot-的使用场景>谈谈你对 slot 的理解，以及 slot 的使用场景<a href=#谈谈你对-slot-的理解以及-slot-的使用场景 class=hash-link aria-label="谈谈你对 slot 的理解，以及 slot 的使用场景的直接链接" title="谈谈你对 slot 的理解，以及 slot 的使用场景的直接链接">​</a></h3>
<p>在 HTML 中 slot 元素 ，作为 Web Components 技术套件的一部分，是 Web 组件内的一个占位符。该占位符可以在后期使用自己的标记语言填充：</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-html codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token tag punctuation" style=color:#393A34>&lt;</span><span class="token tag" style=color:#00009f>template</span><span class="token tag" style=color:#00009f> </span><span class="token tag attr-name" style=color:#00a4db>id</span><span class="token tag attr-value punctuation attr-equals" style=color:#393A34>=</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag attr-value" style=color:#e3116c>element-details-template</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token tag punctuation" style=color:#393A34>&lt;</span><span class="token tag" style=color:#00009f>slot</span><span class="token tag" style=color:#00009f> </span><span class="token tag attr-name" style=color:#00a4db>name</span><span class="token tag attr-value punctuation attr-equals" style=color:#393A34>=</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag attr-value" style=color:#e3116c>element-name</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain">Slot template</span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>slot</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>template</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token tag punctuation" style=color:#393A34>&lt;</span><span class="token tag" style=color:#00009f>element-details</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token tag punctuation" style=color:#393A34>&lt;</span><span class="token tag" style=color:#00009f>span</span><span class="token tag" style=color:#00009f> </span><span class="token tag attr-name" style=color:#00a4db>slot</span><span class="token tag attr-value punctuation attr-equals" style=color:#393A34>=</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag attr-value" style=color:#e3116c>element-name</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain">1</span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>span</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>element-details</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token tag punctuation" style=color:#393A34>&lt;</span><span class="token tag" style=color:#00009f>element-details</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token tag punctuation" style=color:#393A34>&lt;</span><span class="token tag" style=color:#00009f>span</span><span class="token tag" style=color:#00009f> </span><span class="token tag attr-name" style=color:#00a4db>slot</span><span class="token tag attr-value punctuation attr-equals" style=color:#393A34>=</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag attr-value" style=color:#e3116c>element-name</span><span class="token tag attr-value punctuation" style=color:#393A34>"</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain">2</span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>span</span><span class="token tag punctuation" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token tag punctuation" style=color:#393A34>&lt;/</span><span class="token tag" style=color:#00009f>element-details</span><span class="token tag punctuation" style=color:#393A34>></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>template 不会展示到页面中，需要用先获取它的引用，然后才会添加到 DOM 中。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">customElements</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>define</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'element-details'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                      </span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">HTMLElement</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token function" style=color:#d73a49>constructor</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                          </span><span class="token keyword" style=color:#00009f>super</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                          </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> template </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token dom variable" style=color:#36acaa>document</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                          </span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>getElementById</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'element-details-template'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                          </span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">content</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                          </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> shadowRoot </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>this</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>attachShadow</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token literal-property property" style=color:#36acaa>mode</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'open'</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                          </span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>appendChild</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">template</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>cloneNode</span><span class="token punctuation" style=color:#393A34>(</span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                      </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>slot：插槽，我们可以理解为 slot 在组件模板中占好了位置，当使用该组件标签时候，组件标签里面的内容就会自动填入（替换组件模板中 slot 位置）。</p>
<p>通过插槽可以让用户可以拓展组件，去更好地复用组件和对其做定制化处理。如果父组件在使用到一个复用组件的时候，获取这个组件在不同的地方有少量的更改，如果去重写组件是一件不明智的事情。通过 slot 插槽向组件内部指定位置传递内容，完成这个复用组件在不同场景的应用</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-的父子组件生命周期钩子函数执行顺序>Vue 的父子组件生命周期钩子函数执行顺序<a href=#vue-的父子组件生命周期钩子函数执行顺序 class=hash-link aria-label="Vue 的父子组件生命周期钩子函数执行顺序的直接链接" title="Vue 的父子组件生命周期钩子函数执行顺序的直接链接">​</a></h3>
<ul>
<li>加载渲染过程</li>
</ul>
<p>父 beforeCreate -> 父 created -> 父 beforeMount-> 子 beforeCreate->子 created->子 beforeMount->子 mounted->父 mounted</p>
<ul>
<li>子组件更新过程</li>
</ul>
<p>父 beforeUpdate->子 beforeUpdate->子 updated->父 updated</p>
<ul>
<li>父组件更新过程</li>
</ul>
<p>父 beforeUpdate ->父 updated</p>
<ul>
<li>销毁过程</li>
</ul>
<p>父 beforeDestroy->子 beforeDestroy->子 destroyed->父 destroyed</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=大量数据渲染时如何优化>大量数据渲染时如何优化<a href=#大量数据渲染时如何优化 class=hash-link aria-label=大量数据渲染时如何优化的直接链接 title=大量数据渲染时如何优化的直接链接>​</a></h3>
<p>我们可以从以下几个方面进行考虑：</p>
<ul>
<li>在大型企业级项目中经常需要渲染大量数据，此时很容易出现卡顿的情况。比如大数据量的表格、树。</li>
<li>处理时要根据情况做不同处理。</li>
<li>可以采取分页的方式获取，避免渲染大量数据。</li>
<li><code>vue-virtual-scroller</code>（opens new window）等虚拟滚动方案，只渲染视口范围内的数据。</li>
<li>如果不需要更新，可以使用 v-once 方式只渲染一次。</li>
<li>通过 v-memo（opens new window）可以缓存结果，结合 v-for 使用，避免数据变化时不必要的 VNode 创建。</li>
<li>可以采用懒加载方式，在用户需要的时候再加载数据，比如 tree 组件子树的懒加载。</li>
</ul>
<p>还是要看具体需求，首先从设计上避免大数据获取和渲染；实在需要这样做可以采用虚表的方式优化渲染；最后优化更新，如果不需要更新可以 v-once 处理，需要更新可以 v-memo 进一步优化大数据更新性能。其他可以采用的是交互方式优化，无线滚动、懒加载等方案。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=v-for-为什么要加-key>v-for 为什么要加 key<a href=#v-for-为什么要加-key class=hash-link aria-label="v-for 为什么要加 key的直接链接" title="v-for 为什么要加 key的直接链接">​</a></h3>
<p>如果不使用 key，Vue 会使用一种最大限度减少动态元素并且尽可能的尝试就地修改/复用相同类型元素的算法。key 是为 Vue 中 vnode 的唯一标记，通过这个 key，我们的 diff 操作可以更准确、更快速</p>
<p><strong>更准确</strong>：因为带 key 就不是直接复用了，在 sameNode 函数 a.key === b.key 对比中可以避免直接复用的情况。所以会更加准确。</p>
<p><strong>更快速</strong>：利用 key 的唯一性生成 map 对象来获取对应节点，比遍历方式更快</p>
<p>相关代码如下</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 判断两个 vnode 的标签和 key 是否相同 如果相同就认为是同一节点进行      复用</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>isSameVnode</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">oldVnode</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> newVnode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> oldVnode</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">tag</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>===</span><span class="token plain"> newVnode</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">tag</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> oldVnode</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>===</span><span class="token plain"> newVnode</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">key</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 根据key来创建老的儿子的index映射表  类似 {'a':0,'b':1} 代表key为'a'的节点在第一个位置 key为'b'的节点在第二个位置</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>makeIndexByKey</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">children</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> map </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  children</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>forEach</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">item</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    map</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">item</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">key</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> index</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> map</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 生成的映射表</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> map </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>makeIndexByKey</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">oldCh</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue是如何解决跨域问题的>Vue是如何解决跨域问题的<a href=#vue是如何解决跨域问题的 class=hash-link aria-label=Vue是如何解决跨域问题的的直接链接 title=Vue是如何解决跨域问题的的直接链接>​</a></h3>
<p>跨域本质是浏览器基于同源策略的一种安全手段同源策略（Sameoriginpolicy），是一种约定，它是浏览器最核心也最基本的安全功能。</p>
<p>所谓同源（即指在同一个域）需要：协议相同（protocol）、主机相同（host）、端口相同（port）</p>
<p>反之非同源请求，也就是协议、端口、主机其中一项不相同的时候，这时候就会产生跨域。</p>
<p>Vue 解决跨域的方法有很多，常用有三种：JSONP、CORS、Proxy</p>
<p>而在 Vue 项目中，我们主要针对 CORS 或 Proxy 这两种方案进行展开：</p>
<p><strong>CORS</strong></p>
<p>CORS （Cross-Origin Resource Sharing，跨域资源共享）是一个系统，它由一系列传输的 HTTP 头组成，这些 HTTP  头决定浏览器是否阻止前端 JavaScript 代码获取跨域请求的响应 CORS 实现起来非常方便，只需要增加一些 HTTP  头，让服务器能声明允许的访问来源，只要后端实现了 CORS，就实现了跨域。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">app.use(async (ctx, next)=> {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  ctx.set('Access-Control-Allow-Origin', '*');</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  ctx.set('Access-Control-Allow-Headers', 'Content-Type, Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild');</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  ctx.set('Access-Control-Allow-Methods', 'PUT, POST, GET, DELETE, OPTIONS');</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  if (ctx.method == 'OPTIONS') {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ctx.body = 200; </span><br></span><span class=token-line style=color:#393A34><span class="token plain">  } else {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    await next();</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">})</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>Proxy</strong></p>
<p>代理（Proxy）也称网络代理，是一种特殊的网络服务，允许一个（一般为客户端）通过这个服务与另一个网络终端（一般为服务器）进行非直接的连接。一些网关、路由器等网络设备具备网络代理功能。一般认为代理服务有利于保障网络终端的隐私或安全，防止攻击。</p>
<p><strong>方案一</strong></p>
<p>如果是通过 vue-cli 脚手架工具搭建项目，我们可以通过 webpack 为我们起一个本地服务器作为请求的代理对象。通过该服务器转发请求至目标服务器，得到结果再转发给前端，但是最终发布上线时如果 web 应用和接口服务器不在一起仍会跨域。</p>
<p>在 vue.config.js 文件，新增以下代码：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">module.exports = {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    devServer: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        host: '127.0.0.1',</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        port: 8084,</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        open: true,// vue项目启动时自动打开浏览器</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        proxy: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            '/api': { // '/api'是代理标识，用于告诉node，url前面是/api的就是使用代理的</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                target: "http://xxx.xxx.xx.xx:8080", //目标地址，一般是指后台服务器地址</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                changeOrigin: true, //是否跨域</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                pathRewrite: { // pathRewrite 的作用是把实际Request Url中的'/api'用""代替</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    '^/api': "" </span><br></span><span class=token-line style=color:#393A34><span class="token plain">                }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>通过 axios 发送请求中，配置请求的根路径。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">axios.defaults.baseURL = '/api'</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>方案二</strong></p>
<p>通过配置 nginx 实现代理：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">server {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    listen    80;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    # server_name www.josephxia.com;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    location / {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        root  /var/www/html;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        index  index.html index.htm;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        try_files $uri $uri/ /index.html;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    location /api {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        proxy_pass  http://127.0.0.1:3000;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        proxy_redirect   off;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        proxy_set_header  Host       $host;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        proxy_set_header  X-Real-IP     $remote_addr;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=谈谈你对-vueangular-以及-react-的理解>谈谈你对 Vue、Angular 以及 React 的理解<a href=#谈谈你对-vueangular-以及-react-的理解 class=hash-link aria-label="谈谈你对 Vue、Angular 以及 React 的理解的直接链接" title="谈谈你对 Vue、Angular 以及 React 的理解的直接链接">​</a></h3>
<p>首先，我们来看一下 Vue 与 AngularJS 的区别</p>
<ul>
<li>Angular 采用 TypeScript 开发, 而 Vue 可以使用 javascript 也可以使用 TypeScript</li>
<li>AngularJS 依赖对数据做脏检查，所以 Watcher 越多越慢；Vue.js 使用基于依赖追踪的观察并且使用异步队列更新，所有的数据都是独立触发的。</li>
<li>AngularJS 社区完善，Vue 内置了很多默认的模版和语法，学习成本较小。</li>
</ul>
<p>接下来，我们看一下 Vue 与 React 的区别</p>
<p>相似点：</p>
<ul>
<li>Virtual DOM。其中最大的一个相似之处就是都使用了 Virtual DOM，也就是能让我们通过操作数据的方式来改变真实的 DOM 状态。因为其实  Virtual DOM 的本质就是一个 JS 对象，它保存了对真实 DOM 的所有描述，是真实 DOM  的一个映射，所以当我们在进行频繁更新元素的时候，改变这个 JS 对象的开销远比直接改变真实 DOM 要小得多。</li>
<li>组件化开发。它们都提倡这种组件化的开发思想，也就是建议将应用分拆成一个个功能明确的模块，再将这些模块整合在一起以满足我们的业务需求。</li>
<li>Props。Vue 和 React 中都有 props 的概念，允许父组件向子组件传递数据。</li>
<li>构建工具、Chrome 插件、配套框架。还有就是它们的构建工具以及 Chrome 插件、配套框架都很完善。</li>
</ul>
<p>不同点：</p>
<ul>
<li>模版编写。最大的不同就是模版的编写，Vue 鼓励你去写近似常规 HTML 的模板，React 推荐你使用 JSX 去书写。</li>
<li>状态管理与对象属性。在 React 中，应用的状态是比较关键的概念，也就是 state 对象，它允许你使用 setState 去更新状态。但是在 Vue 中，state 对象并不是必须的，数据是由 data 属性在 Vue 对象中进行管理。</li>
<li>虚拟 DOM 的处理方式不同。Vue 中的虚拟 DOM 控制了颗粒度，组件层面走 watcher 通知，而组件内部走 vdom 做  diff，这样，既不会有太多 watcher，也不会让 vdom 的规模过大。而 React 走了类似于 CPU 调度的逻辑，把 vdom 这棵树，微观上变成了链表，然后利用浏览器的空闲时间来做 diff。</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vuex-页面刷新数据丢失怎么解决>Vuex 页面刷新数据丢失怎么解决<a href=#vuex-页面刷新数据丢失怎么解决 class=hash-link aria-label="Vuex 页面刷新数据丢失怎么解决的直接链接" title="Vuex 页面刷新数据丢失怎么解决的直接链接">​</a></h3>
<p>需要做 vuex 数据持久化 一般使用本地存储的方案来保存数据 可以自己设计存储方案 也可以使用第三方插件</p>
<p>推荐使用 vuex-persist 插件，它就是为 Vuex 持久化存储而生的一个插件。不需要你手动存取 storage ，而是直接将状态保存至 cookie 或者 localStorage 中</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-router-中如何保护路由>vue-router 中如何保护路由<a href=#vue-router-中如何保护路由 class=hash-link aria-label="vue-router 中如何保护路由的直接链接" title="vue-router 中如何保护路由的直接链接">​</a></h3>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> router </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>createRouter</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token spread operator" style=color:#393A34>...</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 路由守卫</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">router</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>beforeEach</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">to</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> </span><span class="token parameter keyword module" style=color:#00009f>from</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// ...</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 返回 false 以取消导航</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>false</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// 路由独享守卫</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> routes </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token literal-property property" style=color:#36acaa>path</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'/users/:id'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token literal-property property" style=color:#36acaa>component</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token maybe-class-name">UserDetails</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function-variable function" style=color:#d73a49>beforeEnter</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">to</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> </span><span class="token parameter keyword module" style=color:#00009f>from</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// reject the navigation</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>false</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>以下是触发钩子函数的完整顺序：路由导航、keep-alive、和组件生命周期钩子结合起来的，触发顺序，假设是从a组件离开，第一次进入 b 组件。</p>
<ul>
<li>beforeRouteLeave：路由组件的组件离开路由前钩子，可取消路由离开。</li>
<li>beforeEach：路由全局前置守卫，可用于登录验证、全局路由 loading 等。</li>
<li>beforeEnter：路由独享守卫</li>
<li>beforeRouteEnter：路由组件的组件进入路由前钩子。</li>
<li>beforeResolve：路由全局解析守卫</li>
<li>afterEach：路由全局后置钩子</li>
<li>beforeCreate：组件生命周期，不能访问 this。</li>
<li>created：组件生命周期，可以访问 this，不能访问 DOM。</li>
<li>beforeMount：组件生命周期</li>
<li>deactivated：离开缓存组件 a，或者触发 a 的 beforeDestroy 和 destroyed 组件销毁钩子。</li>
<li>mounted：访问/操作 dom。</li>
<li>activated：进入缓存组件，进入 a 的嵌套子组件（如果有的话）。</li>
<li>执行 beforeRouteEnter 回调函数 next。</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=为什么要使用函数式组件有什么优势>为什么要使用函数式组件，有什么优势<a href=#为什么要使用函数式组件有什么优势 class=hash-link aria-label=为什么要使用函数式组件，有什么优势的直接链接 title=为什么要使用函数式组件，有什么优势的直接链接>​</a></h3>
<p>函数组件的特点：</p>
<ul>
<li>函数式组件需要在声明组件是指定 functional<!-- -->:true<!-- -->。</li>
<li>不需要实例化，所以没有 this,this 通过 render 函数的第二个参数 context 来代替。</li>
<li>没有生命周期钩子函数，不能使用计算属性，watch。</li>
<li>不能通过 $emit 对外暴露事件，调用事件只能通过 context.listeners.click 的方式调用外部传入的事件。</li>
<li>因为函数式组件是没有实例化的，所以在外部通过 ref 去引用组件时，实际引用的是 HTMLElement。</li>
<li>函数式组件的 props 可以不用显示声明，所以没有在 props 里面声明的属性都会被自动隐式。解析为 prop,而普通组件所有未声明的属性都解析到 $attrs 里面，并自动挂载到组件根元素上面(可以通过 inheritAttrs 属性禁止)。</li>
</ul>
<p>相比普通的类组件，函数组件有如下的一些优势：</p>
<ul>
<li>由于函数式组件不需要实例化，无状态，没有生命周期，所以渲染性能要好于普通组件；</li>
<li>函数式组件结构比较简单，代码结构更清晰；</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">Vue.component('functional',{ // 构造函数产生虚拟节点的</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    functional:true, // 函数式组件 // data={attrs:{}}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    render(h){</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        return h('div','test')</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">})</span><br></span><span class=token-line style=color:#393A34><span class="token plain">const vm = new Vue({</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    el: '#app'</span><br></span><span class=token-line style=color:#393A34><span class="token plain">})</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-的-tree-shaking>Vue 的 Tree shaking<a href=#vue-的-tree-shaking class=hash-link aria-label="Vue 的 Tree shaking的直接链接" title="Vue 的 Tree shaking的直接链接">​</a></h3>
<p>Tree shaking 是一种通过清除多余代码方式来优化项目打包体积的技术，专业术语叫 Dead code elimination。简单来讲，就是在保持代码运行结果不变的前提下，去除无用的代码。</p>
<p>在 Vue2 中，无论我们使用什么功能，它们最终都会出现在生产代码中。主要原因是 Vue  实例在项目中是单例的，捆绑程序无法检测到该对象的哪些属性在代码中被使用到。而 Vue3 源码引入 tree shaking 特性，将全局 API 进行分块。如果您不使用其某些功能，它们将不会包含在您的基础包中。</p>
<p>Tree shaking 是基于 ES6 模板语法（ import 与 exports ），主要是借助ES6模块的静态编译思想，在编译时就能确定模块的依赖关系，以及输入和输出的变量。Tree shaking 无非就是做了两件事：</p>
<ul>
<li>编译阶段利用 ES6 Module 判断哪些模块已经加载；</li>
<li>判断那些模块和变量未被使用或者引用，进而删除对应代码；</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=讲一讲-vue-的-ssr>讲一讲 Vue 的 SSR<a href=#讲一讲-vue-的-ssr class=hash-link aria-label="讲一讲 Vue 的 SSR的直接链接" title="讲一讲 Vue 的 SSR的直接链接">​</a></h3>
<p>SSR 也就是服务端渲染，也就是将 Vue 在客户端把标签渲染成 HTML 的工作放在服务端完成，然后再把 html 直接返回给客户端。</p>
<p><strong>优点：</strong></p>
<p>SSR 有着更好的 SEO、并且首屏加载速度更快</p>
<p><strong>缺点：</strong> 开发条件会受到限制，服务器端渲染只支持 beforeCreate 和 created 两个钩子，当我们需要一些外部扩展库时需要特殊处理，服务端渲染应用程序也需要处于 Node.js 的运行环境。</p>
<p>要求服务端性能需求更大，更大的负载</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-中使用了哪些设计模式>vue 中使用了哪些设计模式<a href=#vue-中使用了哪些设计模式 class=hash-link aria-label="vue 中使用了哪些设计模式的直接链接" title="vue 中使用了哪些设计模式的直接链接">​</a></h3>
<ul>
<li>工厂模式 - 传入参数即可创建实例。虚拟 DOM 根据参数的不同返回基础标签的 Vnode 和组件 Vnode</li>
<li>单例模式 - 整个程序有且仅有一个实例。vuex 和 vue-router 的插件注册方法 install 判断如果系统存在实例就直接返回掉</li>
<li>发布-订阅模式：（vue 事件机制）</li>
<li>观察者模式：（响应式数据原理）</li>
<li>装饰模式：（@装饰器的用法）</li>
<li>策略模式：策略模式指对象有某个行为，但是在不同的场景中，该行为有不同的实现方案-比如选项的合并策略</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=你都做过哪些-vue-的性能优化>你都做过哪些 Vue 的性能优化<a href=#你都做过哪些-vue-的性能优化 class=hash-link aria-label="你都做过哪些 Vue 的性能优化的直接链接" title="你都做过哪些 Vue 的性能优化的直接链接">​</a></h3>
<blockquote>
<p>这里只列举针对 Vue 的性能优化 整个项目的性能优化是一个大工程</p>
</blockquote>
<ul>
<li>对象层级不要过深，否则性能就会差</li>
<li>不需要响应式的数据不要放到 data 中（可以用 Object.freeze() 冻结数据）</li>
<li>v-if 和 v-show 区分使用场景</li>
<li>computed 和 watch 区分使用场景</li>
<li>v-for 遍历必须加 key，key 最好是 id 值，且避免同时使用 v-if</li>
<li>大数据列表和表格性能优化-虚拟列表/虚拟表格</li>
<li>防止内部泄漏，组件销毁后把全局变量和事件销毁</li>
<li>图片懒加载</li>
<li>路由懒加载</li>
<li>第三方插件的按需引入</li>
<li>适当采用 keep-alive 缓存组件</li>
<li>防抖、节流运用</li>
<li>服务端渲染 SSR or 预渲染</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=class-与-style-如何实现动态绑定>Class 与 Style 如何实现动态绑定<a href=#class-与-style-如何实现动态绑定 class=hash-link aria-label="Class 与 Style 如何实现动态绑定的直接链接" title="Class 与 Style 如何实现动态绑定的直接链接">​</a></h3>
<p>Class 可以通过对象语法和数组语法进行动态绑定，比如：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">//对象语法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;div v-bind:class="{ active: isActive, 'text-danger': hasError }">&lt;/div></span><br></span><span class=token-line style=color:#393A34><span class="token plain">data: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  isActive: true,</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  hasError: false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">//数组语法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;div v-bind:class="[isActive ? activeClass : '', errorClass]">&lt;/div></span><br></span><span class=token-line style=color:#393A34><span class="token plain">data: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  activeClass: 'active',</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  errorClass: 'text-danger'</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Style 也可以通过对象语法和数组语法进行动态绑定，比如：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">//对象语法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;div v-bind:style="{ color: activeColor, fontSize: fontSize + 'px' }">&lt;/div></span><br></span><span class=token-line style=color:#393A34><span class="token plain">data: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  activeColor: 'red',</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  fontSize: 30</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">//数组语法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;div v-bind:style="[styleColor, styleSize]">&lt;/div></span><br></span><span class=token-line style=color:#393A34><span class="token plain">data: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  styleColor: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">     color: 'red'</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   },</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  styleSize:{</span><br></span><span class=token-line style=color:#393A34><span class="token plain">     fontSize:'23px'</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>vue3 中也可以对 style 标签中的内容进行绑定，实际的值会被编译成哈希化的 CSS 自定义属性，因此 CSS 本身仍然是静态的。自定义属性会通过内联样式的方式应用到组件的根元素上，并且在源值变更的时候响应式地更新。</p>
<div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-vue codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">&lt;script setup></span><br></span><span class=token-line style=color:#393A34><span class="token plain">import { ref } from 'vue'</span><br></span><span class=token-line style=color:#393A34><span class="token plain">const theme = ref({</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    color: 'red',</span><br></span><span class=token-line style=color:#393A34><span class="token plain">})</span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;/script></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;template></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  &lt;p>hello&lt;/p></span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;/template></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;style scoped></span><br></span><span class=token-line style=color:#393A34><span class="token plain">p {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  color: v-bind('theme.color');</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">&lt;/style></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=什么是函数式组件>什么是函数式组件<a href=#什么是函数式组件 class=hash-link aria-label=什么是函数式组件的直接链接 title=什么是函数式组件的直接链接>​</a></h3>
<p>函数组件的特点：</p>
<ul>
<li>在渲染过程中不会创建组件实例 (也就是说，没有 <code>this</code>)</li>
<li>也不会触发常规的组件生命周期钩子，不能使用计算属性，watch。</li>
<li>大多数常规组件的配置选项在函数式组件中都不可用，除了 <code>props</code> 和 <code>emits</code>。</li>
<li>因为函数式组件是没有实例化的，所以在外部通过 ref 去引用组件时，实际引用的是 HTMLElement。</li>
<li>函数式组件的 props 可以不用显示声明，所以没有在 props 里面声明的属性都会被自动隐式。解析为 prop,而普通组件所有未声明的属性都解析到 $attrs 里面，并自动挂载到组件根元素上面(可以通过 inheritAttrs 属性禁止)。</li>
</ul>
<p>相比普通的类组件，函数组件有如下的一些优势：</p>
<ul>
<li>由于函数式组件不需要实例化，无状态，没有生命周期，所以渲染性能要好于普通组件；</li>
<li>函数式组件结构比较简单，代码结构更清晰；</li>
</ul>
<p>如果你将一个函数作为第一个参数传入 <code>h</code>，它将会被当作一个函数式组件来对待。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function maybe-class-name" style=color:#d73a49>MyComponent</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">props</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> </span><span class="token parameter punctuation" style=color:#393A34>{</span><span class="token parameter"> slots</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> emit</span><span class="token parameter punctuation" style=color:#393A34>,</span><span class="token parameter"> attrs </span><span class="token parameter punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// ...</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token maybe-class-name">MyComponent</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">props</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>'value'</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token maybe-class-name">MyComponent</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">emits</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>'click'</span><span class="token punctuation" style=color:#393A34>]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=困难>困难<a href=#困难 class=hash-link aria-label=困难的直接链接 title=困难的直接链接>​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vuemixin-的使用场景和原理>Vue.mixin 的使用场景和原理<a href=#vuemixin-的使用场景和原理 class=hash-link aria-label="Vue.mixin 的使用场景和原理的直接链接" title="Vue.mixin 的使用场景和原理的直接链接">​</a></h3>
<p>在日常的开发中，我们经常会遇到在不同的组件中经常会需要用到一些相同或者相似的代码，这些代码的功能相对独立，可以通过 Vue 的 mixin 功能抽离公共的业务逻辑，原理类似“对象的继承”，当组件初始化时会调用 mergeOptions  方法进行合并，采用策略模式针对不同的属性进行合并。当组件和混入对象含有同名选项时，这些选项将以恰当的方式进行“合并”。</p>
<p>相关代码如下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">export default function initMixin(Vue){</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  Vue.mixin = function (mixin) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    //   合并对象</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      this.options=mergeOptions(this.options,mixin)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  };</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">};</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// src/util/index.js</span><br></span><span class=token-line style=color:#393A34><span class="token plain">// 定义生命周期</span><br></span><span class=token-line style=color:#393A34><span class="token plain">export const LIFECYCLE_HOOKS = [</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "beforeCreate",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "created",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "beforeMount",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "mounted",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "beforeUpdate",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "updated",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "beforeDestroy",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  "destroyed",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">];</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// 合并策略</span><br></span><span class=token-line style=color:#393A34><span class="token plain">const strats = {};</span><br></span><span class=token-line style=color:#393A34><span class="token plain">// mixin核心方法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">export function mergeOptions(parent, child) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  const options = {};</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 遍历父亲</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  for (let k in parent) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    mergeFiled(k);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 父亲没有 儿子有</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  for (let k in child) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    if (!parent.hasOwnProperty(k)) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      mergeFiled(k);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  //真正合并字段方法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  function mergeFiled(k) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    if (strats[k]) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      options[k] = strats[k](parent[k], child[k]);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    } else {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      // 默认策略</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      options[k] = child[k] ? child[k] : parent[k];</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  return options;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">} </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Vue.mixin 原理详解 传送门</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=nexttick-使用场景和原理>nextTick 使用场景和原理<a href=#nexttick-使用场景和原理 class=hash-link aria-label="nextTick 使用场景和原理的直接链接" title="nextTick 使用场景和原理的直接链接">​</a></h3>
<p>nextTick 中的回调是在下次 DOM 更新循环结束之后执行的延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM。主要思路就是采用微任务优先的方式调用异步方法去执行 nextTick 包装的方法</p>
<p>相关代码如下</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> callbacks </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> pending </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>flushCallbacks</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  pending </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//把标志还原为false</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 依次执行回调</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> callbacks</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">length</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    callbacks</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> timerFunc</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//定义异步方法  采用优雅降级</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>typeof</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"undefined"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 如果支持promise</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> p </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>resolve</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    p</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>then</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>typeof</span><span class="token plain"> </span><span class="token maybe-class-name">MutationObserver</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"undefined"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// MutationObserver 主要是监听dom变化 也是一个异步方法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> counter </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> observer </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">MutationObserver</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> textNode </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token dom variable" style=color:#36acaa>document</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>createTextNode</span><span class="token punctuation" style=color:#393A34>(</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">counter</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  observer</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>observe</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">textNode</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token literal-property property" style=color:#36acaa>characterData</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    counter </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">counter </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    textNode</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">data</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">counter</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>typeof</span><span class="token plain"> setImmediate </span><span class="token operator" style=color:#393A34>!==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"undefined"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 如果前面都不支持 判断setImmediate</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>setImmediate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword control-flow" style=color:#00009f>else</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 最后降级采用setTimeout</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token function-variable function" style=color:#d73a49>timerFunc</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#393A34>=></span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>setTimeout</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword module" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>nextTick</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">cb</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 除了渲染watcher  还有用户自己手动调用的nextTick 一起被收集到数组</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  callbacks</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">cb</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token plain">pending</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 如果多次调用nextTick  只会执行一次异步 等异步队列清空之后再把标志变为false</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pending </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>timerFunc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=keep-alive-使用场景和原理>keep-alive 使用场景和原理<a href=#keep-alive-使用场景和原理 class=hash-link aria-label="keep-alive 使用场景和原理的直接链接" title="keep-alive 使用场景和原理的直接链接">​</a></h3>
<p>keep-alive 是 Vue 内置的一个组件，可以实现组件缓存，当组件切换时不会对当前组件进行卸载。</p>
<ul>
<li>常用的两个属性 include/exclude，允许组件有条件的进行缓存。</li>
<li>两个生命周期 activated/deactivated，用来得知当前组件是否处于活跃状态。</li>
<li>keep-alive 的中还运用了 LRU(最近最少使用) 算法，选择最近最久未使用的组件予以淘汰。</li>
</ul>
<p>相关代码如下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">export default {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  name: "keep-alive",</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  abstract: true, //抽象组件</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  props: {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    include: patternTypes, //要缓存的组件</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    exclude: patternTypes, //要排除的组件</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    max: [String, Number], //最大缓存数</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  },</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  created() {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    this.cache = Object.create(null); //缓存对象  {a:vNode,b:vNode}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    this.keys = []; //缓存组件的key集合 [a,b]</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  },</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  destroyed() {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    for (const key in this.cache) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      pruneCacheEntry(this.cache, key, this.keys);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  },</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  mounted() {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    //动态监听include  exclude</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    this.$watch("include", (val) => {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      pruneCache(this, (name) => matches(val, name));</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    });</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    this.$watch("exclude", (val) => {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      pruneCache(this, (name) => !matches(val, name));</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    });</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  },</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  render() {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    const slot = this.$slots.default; //获取包裹的插槽默认值</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    const vnode: VNode = getFirstComponentChild(slot); //获取第一个子组件</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    const componentOptions: ?VNodeComponentOptions =</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      vnode && vnode.componentOptions;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    if (componentOptions) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      // check pattern</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      const name: ?string = getComponentName(componentOptions);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      const { include, exclude } = this;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      // 不走缓存</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      if (</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // not included  不包含</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        (include && (!name || !matches(include, name))) ||</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // excluded  排除里面</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        (exclude && name && matches(exclude, name))</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      ) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        //返回虚拟节点</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        return vnode;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      }</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      const { cache, keys } = this;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      const key: ?string =</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        vnode.key == null</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          ? // same constructor may get registered as different local components</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            // so cid alone is not enough (#3269)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            componentOptions.Ctor.cid +</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            (componentOptions.tag ? `::${componentOptions.tag}` : "")</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          : vnode.key;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      if (cache[key]) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        //通过key 找到缓存 获取实例</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        vnode.componentInstance = cache[key].componentInstance;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // make current key freshest</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        remove(keys, key); //通过LRU算法把数组里面的key删掉</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        keys.push(key); //把它放在数组末尾</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      } else {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        cache[key] = vnode; //没找到就换存下来</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        keys.push(key); //把它放在数组末尾</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        // prune oldest entry  //如果超过最大值就把数组第0项删掉</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        if (this.max && keys.length > parseInt(this.max)) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">          pruneCacheEntry(cache, keys[0], keys, this._vnode);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      }</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      vnode.data.keepAlive = true; //标记虚拟节点已经被缓存</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    // 返回虚拟节点</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return vnode || (slot && slot[0]);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  },</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}; </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<blockquote>
<p>扩展补充：LRU 算法是什么？</p>
</blockquote>
<p><img decoding=async loading=lazy src=https://filescdn.proginn.com/679f9b2736e5f50f01c23bef7c6eac23/57da3650ef83a83c859f186e7c00d5a0.webp alt=img class=img_ev3q>lrusuanfa.png</p>
<p>LRU 的核心思想是如果数据最近被访问过，那么将来被访问的几率也更高，所以我们将命中缓存的组件 key 重新插入到 this.keys  的尾部，这样一来，this.keys 中越往头部的数据即将来被访问几率越低，所以当缓存数量达到最大值时，我们就删除将来被访问几率最低的数据，即  this.keys 中第一个缓存的组件。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vueset-方法原理>Vue.set 方法原理<a href=#vueset-方法原理 class=hash-link aria-label="Vue.set 方法原理的直接链接" title="Vue.set 方法原理的直接链接">​</a></h3>
<p>了解 Vue 响应式原理的同学都知道在两种情况下修改数据 Vue 是不会触发视图更新的</p>
<p>1.在实例创建之后添加新的属性到实例上（给响应式对象新增属性）</p>
<p>2.直接更改数组下标来修改数组的值</p>
<p>Vue.set 或者说是$set 原理如下</p>
<p>因为响应式数据 我们给对象和数组本身都增加了__ob__属性，代表的是 Observer 实例。当给对象新增不存在的属性 首先会把新的属性进行响应式跟踪  然后会触发对象__ob__的 dep 收集到的 watcher 去更新，当修改数组索引时我们调用数组本身的 splice 方法去更新数组</p>
<p>相关代码如下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">export function set(target: Array | Object, key: any, val: any): any {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 如果是数组 调用我们重写的splice方法 (这样可以更新视图)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  if (Array.isArray(target) && isValidArrayIndex(key)) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    target.length = Math.max(target.length, key);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    target.splice(key, 1, val);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return val;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 如果是对象本身的属性，则直接添加即可</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  if (key in target && !(key in Object.prototype)) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    target[key] = val;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return val;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  const ob = (target: any).__ob__;</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 如果不是响应式的也不需要将其定义成响应式属性</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  if (!ob) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    target[key] = val;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return val;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 将属性定义成响应式的</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  defineReactive(ob.value, key, val);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 通知视图更新</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  ob.dep.notify();</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  return val;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">} </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>响应式数据原理详解 传送门</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vueextend-作用和原理>Vue.extend 作用和原理<a href=#vueextend-作用和原理 class=hash-link aria-label="Vue.extend 作用和原理的直接链接" title="Vue.extend 作用和原理的直接链接">​</a></h3>
<p>官方解释：Vue.extend 使用基础 Vue 构造器，创建一个“子类”。参数是一个包含组件选项的对象。</p>
<p>其实就是一个子类构造器 是 Vue 组件的核心 api 实现思路就是使用原型继承的方法返回了 Vue 的子类 并且利用 mergeOptions 把传入组件的 options 和父类的 options 进行了合并</p>
<p>相关代码如下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">export default function initExtend(Vue) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  let cid = 0; //组件的唯一标识</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 创建子类继承Vue父类 便于属性扩展</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  Vue.extend = function (extendOptions) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    // 创建子类的构造函数 并且调用初始化方法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    const Sub = function VueComponent(options) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      this._init(options); //调用Vue初始化方法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    };</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    Sub.cid = cid++;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    Sub.prototype = Object.create(this.prototype); // 子类原型指向父类</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    Sub.prototype.constructor = Sub; //constructor指向自己</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    Sub.options = mergeOptions(this.options, extendOptions); //合并自己的options和父类的options</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    return Sub;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  };</span><br></span><span class=token-line style=color:#393A34><span class="token plain">} </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Vue 组件原理详解 传送门</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-修饰符有哪些>Vue 修饰符有哪些<a href=#vue-修饰符有哪些 class=hash-link aria-label="Vue 修饰符有哪些的直接链接" title="Vue 修饰符有哪些的直接链接">​</a></h3>
<p><strong>事件修饰符</strong></p>
<ul>
<li><code>.stop</code> 阻止事件继续传播</li>
<li><code>.prevent</code> 阻止标签默认行为</li>
<li><code>.capture</code> 使用事件捕获模式,即元素自身触发的事件先在此处处理，然后才交由内部元素进行处理</li>
<li><code>.self</code> 只当在 event.target 是当前元素自身时触发处理函数</li>
<li><code>.once</code> 事件将只会触发一次</li>
<li><code>.passive</code> 告诉浏览器你不想阻止事件的默认行为</li>
</ul>
<p><strong>v-model 的修饰符</strong></p>
<ul>
<li><code>.lazy</code> 通过这个修饰符，转变为在 change 事件再同步</li>
<li><code>.number</code> 自动将用户的输入值转化为数值类型</li>
<li><code>.trim</code> 自动过滤用户输入的首尾空格</li>
</ul>
<p><strong>键盘事件的修饰符</strong></p>
<ul>
<li>.enter</li>
<li>.tab</li>
<li>.delete (捕获“删除”和“退格”键)</li>
<li>.esc</li>
<li>.space</li>
<li>.up</li>
<li>.down</li>
<li>.left</li>
<li>.right</li>
</ul>
<p><strong>系统修饰键</strong></p>
<ul>
<li>.ctrl</li>
<li>.alt</li>
<li>.shift</li>
<li>.meta</li>
</ul>
<p><strong>鼠标按钮修饰符</strong></p>
<ul>
<li>.left</li>
<li>.right</li>
<li>.middle</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-模板编译原理>Vue 模板编译原理<a href=#vue-模板编译原理 class=hash-link aria-label="Vue 模板编译原理的直接链接" title="Vue 模板编译原理的直接链接">​</a></h3>
<p>Vue 的编译过程就是将 template 转化为 render 函数的过程 分为以下三步</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">第一步是将 模板字符串 转换成 element ASTs（解析器）</span><br></span><span class=token-line style=color:#393A34><span class="token plain">第二步是对 AST 进行静态节点标记，主要用来做虚拟DOM的渲染优化（优化器）</span><br></span><span class=token-line style=color:#393A34><span class="token plain">第三步是 使用 element ASTs 生成 render 函数代码字符串（代码生成器） </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>相关代码如下</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword module" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>compileToFunctions</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">template</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 我们需要把html字符串变成render函数</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 1.把html代码转成ast语法树  ast用来描述代码本身形成树结构 不仅可以描述html 也能描述css以及js语法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 很多库都运用到了ast 比如 webpack babel eslint等等</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> ast </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>parse</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">template</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 2.优化静态节点</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 这个有兴趣的可以去看源码  不影响核心功能就不实现了</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//   if (options.optimize !== false) {</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//     optimize(ast, options);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//   }</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 3.通过ast 重新生成代码</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 我们最后生成的代码需要和render函数一样</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 类似_c('div',{id:"app"},_c('div',undefined,_v("hello"+_s(name)),_c('span',undefined,_v("world"))))</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// _c代表创建元素 _v代表创建文本 _s代表文Json.stringify--把对象解析成文本</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> code </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>generate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ast</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>//   使用with语法改变作用域为this  之后调用render函数可以使用call改变this 方便code里面的变量取值</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> renderFn </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token class-name">Function</span><span class="token punctuation" style=color:#393A34>(</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token template-string string" style=color:#e3116c>with(this){return </span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>${</span><span class="token template-string interpolation">code</span><span class="token template-string interpolation interpolation-punctuation punctuation" style=color:#393A34>}</span><span class="token template-string string" style=color:#e3116c>}</span><span class="token template-string template-punctuation string" style=color:#e3116c>`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> renderFn</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>模板编译原理详解 传送门</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=生命周期钩子是如何实现的>生命周期钩子是如何实现的<a href=#生命周期钩子是如何实现的 class=hash-link aria-label=生命周期钩子是如何实现的的直接链接 title=生命周期钩子是如何实现的的直接链接>​</a></h3>
<p>Vue 的生命周期钩子核心实现是利用发布订阅模式先把用户传入的的生命周期钩子订阅好（内部采用数组的方式存储）然后在创建组件实例的过程中会一次执行对应的钩子方法（发布）</p>
<p>相关代码如下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">export function callHook(vm, hook) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 依次执行生命周期对应的方法</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  const handlers = vm.$options[hook];</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  if (handlers) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    for (let i = 0; i &lt; handlers.length; i++) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      handlers[i].call(vm); //生命周期里面的this指向当前实例</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">// 调用的时候</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Vue.prototype._init = function (options) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  const vm = this;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  vm.$options = mergeOptions(vm.constructor.options, options);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  callHook(vm, "beforeCreate"); //初始化数据之前</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 初始化状态</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  initState(vm);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  callHook(vm, "created"); //初始化数据之后</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  if (vm.$options.el) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    vm.$mount(vm.$options.el);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}; </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>生命周期实现详解 传送门</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=函数式组件使用场景和原理>函数式组件使用场景和原理<a href=#函数式组件使用场景和原理 class=hash-link aria-label=函数式组件使用场景和原理的直接链接 title=函数式组件使用场景和原理的直接链接>​</a></h3>
<p>函数式组件与普通组件的区别</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">1.函数式组件需要在声明组件是指定 functional:true</span><br></span><span class=token-line style=color:#393A34><span class="token plain">2.不需要实例化，所以没有this,this通过render函数的第二个参数context来代替</span><br></span><span class=token-line style=color:#393A34><span class="token plain">3.没有生命周期钩子函数，不能使用计算属性，watch</span><br></span><span class=token-line style=color:#393A34><span class="token plain">4.不能通过$emit 对外暴露事件，调用事件只能通过context.listeners.click的方式调用外部传入的事件</span><br></span><span class=token-line style=color:#393A34><span class="token plain">5.因为函数式组件是没有实例化的，所以在外部通过ref去引用组件时，实际引用的是HTMLElement</span><br></span><span class=token-line style=color:#393A34><span class="token plain">6.函数式组件的props可以不用显示声明，所以没有在props里面声明的属性都会被自动隐式解析为prop,而普通组件所有未声明的属性都解析到$attrs里面，并自动挂载到组件根元素上面(可以通过inheritAttrs属性禁止) </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>优点 1.由于函数式组件不需要实例化，无状态，没有生命周期，所以渲染性能要好于普通组件 2.函数式组件结构比较简单，代码结构更清晰</p>
<p>使用场景：</p>
<p>一个简单的展示组件，作为容器组件使用 比如 router-view 就是一个函数式组件</p>
<p>“高阶组件”——用于接收一个组件作为参数，返回一个被包装过的组件</p>
<p>相关代码如下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">if (isTrue(Ctor.options.functional)) {</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  // 带有functional的属性的就是函数式组件</span><br></span><span class=token-line style=color:#393A34><span class="token plain">  return createFunctionalComponent(Ctor, propsData, data, context, children);</span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span><span class=token-line style=color:#393A34><span class="token plain">const listeners = data.on;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">data.on = data.nativeOn;</span><br></span><span class=token-line style=color:#393A34><span class="token plain">installComponentHooks(data); // 安装组件相关钩子 （函数式组件没有调用此方法，从而性能高于普通组件） </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=能说下-vue-router-中常用的路由模式实现原理吗>能说下 vue-router 中常用的路由模式实现原理吗<a href=#能说下-vue-router-中常用的路由模式实现原理吗 class=hash-link aria-label="能说下 vue-router 中常用的路由模式实现原理吗的直接链接" title="能说下 vue-router 中常用的路由模式实现原理吗的直接链接">​</a></h3>
<p><strong>hash 模式</strong></p>
<ol>
<li>location.hash 的值实际就是 URL 中#后面的东西 它的特点在于：hash 虽然出现 URL 中，但不会被包含在 HTTP 请求中，对后端完全没有影响，因此改变 hash 不会重新加载页面。</li>
<li>可以为 hash 的改变添加监听事件</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">window.addEventListener("hashchange", funcRef, false); </span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>每一次改变 hash（window.location.hash），都会在浏览器的访问历史中增加一个记录利用 hash 的以上特点，就可以来实现前端路由“更新视图但不重新请求页面”的功能了</p>
<blockquote>
<p>特点：兼容性好但是不美观</p>
</blockquote>
<p><strong>history 模式</strong></p>
<p>利用了 HTML5 History Interface 中新增的 pushState() 和 replaceState() 方法。</p>
<p>这两个方法应用于浏览器的历史记录站，在当前已有的 back、forward、go  的基础之上，它们提供了对历史记录进行修改的功能。这两个方法有个共同的特点：当调用他们修改浏览器历史记录栈后，虽然当前 URL  改变了，但浏览器不会刷新页面，这就为单页应用前端路由“更新视图但不重新请求页面”提供了基础。</p>
<p>特点：虽然美观，但是刷新会出现 404 需要后端进行配置</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=手写-vueextend>手写 Vue.extend<a href=#手写-vueextend class=hash-link aria-label="手写 Vue.extend的直接链接" title="手写 Vue.extend的直接链接">​</a></h3>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//  src/global-api/initExtend.js</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword module" style=color:#00009f>import</span><span class="token plain"> </span><span class="token imports punctuation" style=color:#393A34>{</span><span class="token imports"> mergeOptions </span><span class="token imports punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token keyword module" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"../util/index"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword module" style=color:#00009f>export</span><span class="token plain"> </span><span class="token keyword module" style=color:#00009f>default</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>initExtend</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter maybe-class-name">Vue</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>let</span><span class="token plain"> cid </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//组件的唯一标识</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>// 创建子类继承Vue父类 便于属性扩展</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token maybe-class-name">Vue</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method-variable function-variable method function property-access" style=color:#d73a49>extend</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">extendOptions</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 创建子类的构造函数 并且调用初始化方法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style=color:#d73a49>Sub</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function maybe-class-name" style=color:#d73a49>VueComponent</span><span class="token punctuation" style=color:#393A34>(</span><span class="token parameter">options</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token keyword" style=color:#00009f>this</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>_init</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">options</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//调用Vue初始化方法</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token maybe-class-name">Sub</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">cid</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> cid</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token class-name">Sub</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">prototype</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>create</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>this</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">prototype</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// 子类原型指向父类</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token class-name">Sub</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">prototype</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">constructor</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token maybe-class-name">Sub</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//constructor指向自己</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token maybe-class-name">Sub</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">options</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>mergeOptions</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>this</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">options</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> extendOptions</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>//合并自己的options和父类的options</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token maybe-class-name">Sub</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>具体可以看看这篇 <a href=https://juejin.cn/post/6954173708344770591 target=_blank rel="noopener noreferrer">手写 Vue2.0 源码（八）-组件原理</a></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-router-中路由方法-pushstate-和-replacestate-能否触发-popsate-事件>vue-router 中路由方法 pushState 和 replaceState 能否触发 popSate 事件<a href=#vue-router-中路由方法-pushstate-和-replacestate-能否触发-popsate-事件 class=hash-link aria-label="vue-router 中路由方法 pushState 和 replaceState 能否触发 popSate 事件的直接链接" title="vue-router 中路由方法 pushState 和 replaceState 能否触发 popSate 事件的直接链接">​</a></h3>
<p>答案是：<strong>不能</strong></p>
<p>pushState 和 replaceState</p>
<p>HTML5 新接口，可以改变网址（存在跨域限制）而不刷新页面，这个强大的特性后来用到了单页面应用如：vue-router，react-router-dom 中。</p>
<p>注意:仅改变网址,网页不会真的跳转,也不会获取到新的内容,本质上网页还停留在原页面</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token dom variable" style=color:#36acaa>window</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">history</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>pushState</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">state</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> title</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> targetURL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@状态对象：传给目标路由的信息</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">可为空</span><br></span><span class=token-line style=color:#393A34><span class="token plain">@页面标题：目前所有浏览器都不支持</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">填空字符串即可</span><br></span><span class=token-line style=color:#393A34><span class="token plain">@可选url：目标url，不会检查url是否存在，且不能跨域。如不传该项</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">即给当前url添加data</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token dom variable" style=color:#36acaa>window</span><span class="token punctuation" style=color:#393A34>.</span><span class="token property-access">history</span><span class="token punctuation" style=color:#393A34>.</span><span class="token method function property-access" style=color:#d73a49>replaceState</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">state</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> title</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> targetURL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@类似于pushState</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">但是会直接替换掉当前url</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">而不会在history中留下记录</span><br></span><span class=token-line style=color:#393A34><span class="token plain">复制代码</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>popstate 事件会在点击后退、前进按钮(或调用 history.back()、history.forward()、history.go()方法)时触发</p>
<blockquote>
<p><strong>注意:用 history.pushState()或者 history.replaceState()不会触发 popstate 事件</strong></p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=相比-vue2xvue-3-有哪些性能方面的提升>相比 Vue2.x，Vue 3 有哪些性能方面的提升。<a href=#相比-vue2xvue-3-有哪些性能方面的提升 class=hash-link aria-label="相比 Vue2.x，Vue 3 有哪些性能方面的提升。的直接链接" title="相比 Vue2.x，Vue 3 有哪些性能��方面的提升。的直接链接">​</a></h3>
<p>对于这个问题，我们可以从编译阶段、源码体积和响应式系统三个方面进行回答。</p>
<p>在编译阶段，Vue 3 做了如下一些优化：</p>
<ul>
<li>diff 算法优化</li>
<li>静态提升</li>
<li>事件监听缓存</li>
<li>SSR 优化</li>
</ul>
<p><em><strong>*diff 算法优化*</strong></em></p>
<p>vue3 在 diff 算法中相比 vue2 增加了静态标记。关于这个静态标记，其作用是为了会发生变化的地方添加一个 flag 标记，下次发生变化的时候直接找该地方进行比较，性能得到了进一步的提高。</p>
<p><img decoding=async loading=lazy src="https://mmbiz.qpic.cn/sz_mmbiz_png/aVp1YC8UV0f44JuT1QS7TDTmRpVwoO3qS7aG5Fy3U8KkF82ianVAl58sTN3h7dicE4kELpY9AyaYMqlkkpONiapMA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt=图片 class=img_ev3q></p>
<p><strong>静态提升</strong></p>
<p>Vue3 中对不参与更新的元素，会做静态提升，只会被创建一次，在渲染时直接复用这样就免去了重复的创建节点，大型应用会受益于这个改动，免去了重复的创建操作，优化了运行时候的内存占用。</p>
<p><strong>事件监听缓存</strong></p>
<p>默认情况下绑定事件行为会被视为动态绑定，所以每次都会去追踪它的变化。开启了缓存后，没有了静态标记，也就是说下次 diff 算法的时候直接使用。</p>
<p><em><strong>*SSR优化*</strong></em></p>
<p>当静态内容大到一定量级时候，会用 createStaticVNode 方法在客户端去生成一个 static node，这些静态 node，会被直接 innerHtml，就不需要创建对象，然后根据对象渲染。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=vue-router-路由钩子在生命周期的体现>Vue-router 路由钩子在生命周期的体现<a href=#vue-router-路由钩子在生命周期的体现 class=hash-link aria-label="Vue-router 路由钩子在生命周期的体现的直接链接" title="Vue-router 路由钩子在生命周期的体现的直接链接">​</a></h3>
<p>有的时候，需要通过路由来进行一些操作，比如最常见的登录权限验证，当用户满足条件时，才让其进入导航，否则就取消跳转，并跳到登录页面让其登录。为此有很多种方法可以植入路由的导航过程：全局的，单个路由独享的，或者组件级的。</p>
<p><strong>1，全局路由勾子</strong></p>
<p>vue-router 全局有三个路由钩子：</p>
<ul>
<li>router.beforeEach 全局前置守卫 进入路由之前</li>
<li>router.beforeResolve 全局解析守卫（2.5.0+）在 beforeRouteEnter 调用之后调用</li>
<li>router.afterEach 全局后置钩子 进入路由之后</li>
</ul>
<p>具体来说，为了实现登录拦截，我们可以这么做：</p>
<ol>
<li>beforeEach，判断是否登录了，没登录就跳转到登录页；</li>
<li>afterEach，跳转之后滚动条回到顶部；</li>
</ol>
<p><strong>2，单个路由独享钩子</strong></p>
<p>beforeEnter 如果不想全局配置守卫的话，可以为某些路由单独配置守卫，有三个参数∶ to、from、next，代码如下。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">export default [    </span><br></span><span class=token-line style=color:#393A34><span class="token plain">    {        </span><br></span><span class=token-line style=color:#393A34><span class="token plain">        path: '/',        </span><br></span><span class=token-line style=color:#393A34><span class="token plain">        name: 'login',        </span><br></span><span class=token-line style=color:#393A34><span class="token plain">        component: login,        </span><br></span><span class=token-line style=color:#393A34><span class="token plain">        beforeEnter: (to, from, next) => {          </span><br></span><span class=token-line style=color:#393A34><span class="token plain">            console.log('即将进入登录页面')          </span><br></span><span class=token-line style=color:#393A34><span class="token plain">            next()        </span><br></span><span class=token-line style=color:#393A34><span class="token plain">        }    </span><br></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br></span><span class=token-line style=color:#393A34><span class="token plain">]</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p><strong>3，</strong> <strong>组件内钩子</strong></p>
<p>组件内钩子主要有三个：beforeRouteUpdate、beforeRouteEnter、beforeRouteLeave。这三个钩子都有三个参数∶to、from、next。</p>
<ul>
<li>beforeRouteEnter∶ 进入组件前触发</li>
<li>beforeRouteUpdate∶ 当前地址改变并且改组件被复用时触发，举例来说，带有动态参数的路径 foo/∶id，在 /foo/1 和 /foo/2 之间跳转的时候，由于会渲染同样的 foa 组件，这个钩子在这种情况下就会被调用</li>
<li>beforeRouteLeave∶ 离开组件被调用</li>
</ul>
<p>注意点，beforeRouteEnter 组件内还访问不到 this，因为该守卫执行前组件实例还没有被创建，需要传一个回调给 next 来访问，例如：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">beforeRouteEnter(to, from, next) {      </span><br></span><span class=token-line style=color:#393A34><span class="token plain">    next(target => {        </span><br></span><span class=token-line style=color:#393A34><span class="token plain">        if (from.path == '/classProcess') {          </span><br></span><span class=token-line style=color:#393A34><span class="token plain">            target.isFromProcess = true        </span><br></span><span class=token-line style=color:#393A34><span class="token plain">        }      </span><br></span><span class=token-line style=color:#393A34><span class="token plain">    })    </span><br></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label=复制代码到剪贴板 title=复制 class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>以下是触发钩子函数的完整顺序：路由导航、keep-alive、和组件生命周期钩子结合起来的，触发顺序，假设是从a组件离开，第一次进入 b 组件。</p>
<ul>
<li>beforeRouteLeave：路由组件的组件离开路由前钩子，可取消路由离开。</li>
<li>beforeEach：路由全局前置守卫，可用于登录验证、全局路由 loading 等。</li>
<li>beforeEnter：路由独享守卫</li>
<li>beforeRouteEnter：路由组件的组件进入路由前钩子。</li>
<li>beforeResolve：路由全局解析守卫</li>
<li>afterEach：路由全局后置钩子</li>
<li>beforeCreate：组件生命周期，不能访问 tAis。</li>
<li>created;组件生命周期，可以访问 tAis，不能访问 dom。</li>
<li>beforeMount：组件生命周期</li>
<li>deactivated：离开缓存组件 a，或者触发 a 的 beforeDestroy 和 destroyed 组件销毁钩子。</li>
<li>mounted：访问/操作 dom。</li>
<li>activated：进入缓存组件，进入 a 的嵌套子组件（如果有的话）。</li>
<li>执行 beforeRouteEnter 回调函数 next。</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id=参考文章>参考文章<a href=#参考文章 class=hash-link aria-label=参考文章的直接链接 title=参考文章的直接链接>​</a></h2>
<table><thead><tr><th>作者<th>链接<tbody><tr><td>Big shark@LX<td><a href=https://juejin.cn/post/6961222829979697165 target=_blank rel="noopener noreferrer">https://juejin.cn/post/6961222829979697165</a></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/my-docs/面试-自检/2.1-Vue面试题.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label=文件选项卡><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/面试-自检/1.4-前端知识点><div class=pagination-nav__sublabel>上一页</div><div class=pagination-nav__label>1.4-前端知识点</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/面试-自检/2.2-React 面试题"><div class=pagination-nav__sublabel>下一页</div><div class=pagination-nav__label>2.2-React 面试题</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#vue三大功能 class="table-of-contents__link toc-highlight">Vue三大功能</a><li><a href=#简单 class="table-of-contents__link toc-highlight">简单</a><ul><li><a href=#组件通讯方式有哪些方法 class="table-of-contents__link toc-highlight">组件通讯方式有哪些方法</a><li><a href=#nexttick-原理 class="table-of-contents__link toc-highlight">nextTick 原理</a><li><a href=#vue30-了解多少 class="table-of-contents__link toc-highlight">vue3.0 了解多少</a><li><a href=#vue-diff-原理 class="table-of-contents__link toc-highlight">Vue diff 原理</a><li><a href=#mvc-和-mvvm-区别 class="table-of-contents__link toc-highlight">MVC 和 MVVM 区别</a><li><a href=#data-为什么是函数 class="table-of-contents__link toc-highlight">data 为什么是函数</a><li><a href=#生命周期方法有哪些一般在哪一步发请求 class="table-of-contents__link toc-highlight">生命周期方法有哪些一般在哪一步发请求</a><li><a href=#v-if-和-v-show-的区别 class="table-of-contents__link toc-highlight">v-if 和 v-show 的区别</a><li><a href=#内置指令都有那些 class="table-of-contents__link toc-highlight">内置指令都有那些</a><li><a href=#如何写一个自定义指令 class="table-of-contents__link toc-highlight">如何写一个自定义指令</a><li><a href=#怎样理解-vue-的单向数据流 class="table-of-contents__link toc-highlight">怎样理解 Vue 的单向数据流</a><li><a href=#computed-和-watch-的区别和运用的场景 class="table-of-contents__link toc-highlight">computed 和 watch 的区别和运用的场景</a><li><a href=#v-if-与-v-for-为什么不建议一起使用 class="table-of-contents__link toc-highlight">v-if 与 v-for 为什么不建议一起使用</a><li><a href=#vue-事件绑定原理 class="table-of-contents__link toc-highlight">Vue 事件绑定原理</a><li><a href=#scoped-样式穿透是什么 class="table-of-contents__link toc-highlight">Scoped 样式穿透是什么</a></ul><li><a href=#中等 class="table-of-contents__link toc-highlight">中等</a><ul><li><a href=#为什么要使用-proxy class="table-of-contents__link toc-highlight">为什么要使用 proxy</a><li><a href=#vue30-和-20-的响应式原理区别 class="table-of-contents__link toc-highlight">Vue3.0 和 2.0 的响应式原理区别</a><li><a href=#相比-vue-2vue-3-有哪些性能方面的提升 class="table-of-contents__link toc-highlight">相比 Vue 2，Vue 3 有哪些性能方面的提升。</a><li><a href=#谈谈你对-slot-的理解以及-slot-的使用场景 class="table-of-contents__link toc-highlight">谈谈你对 slot 的理解，以及 slot 的使用场景</a><li><a href=#vue-的父子组件生命周期钩子函数执行顺序 class="table-of-contents__link toc-highlight">Vue 的父子组件生命周期钩子函数执行顺序</a><li><a href=#大量数据渲染时如何优化 class="table-of-contents__link toc-highlight">大量数据渲染时如何优化</a><li><a href=#v-for-为什么要加-key class="table-of-contents__link toc-highlight">v-for 为什么要加 key</a><li><a href=#vue是如何解决跨域问题的 class="table-of-contents__link toc-highlight">Vue是如何解决跨域问题的</a><li><a href=#谈谈你对-vueangular-以及-react-的理解 class="table-of-contents__link toc-highlight">谈谈你对 Vue、Angular 以及 React 的理解</a><li><a href=#vuex-页面刷新数据丢失怎么解决 class="table-of-contents__link toc-highlight">Vuex 页面刷新数据丢失怎么解决</a><li><a href=#vue-router-中如何保护路由 class="table-of-contents__link toc-highlight">vue-router 中如何保护路由</a><li><a href=#为什么要使用函数式组件有什么优势 class="table-of-contents__link toc-highlight">为什么要使用函数式组件，有什么优势</a><li><a href=#vue-的-tree-shaking class="table-of-contents__link toc-highlight">Vue 的 Tree shaking</a><li><a href=#讲一讲-vue-的-ssr class="table-of-contents__link toc-highlight">讲一讲 Vue 的 SSR</a><li><a href=#vue-中使用了哪些设计模式 class="table-of-contents__link toc-highlight">vue 中使用了哪些设计模式</a><li><a href=#你都做过哪些-vue-的性能优化 class="table-of-contents__link toc-highlight">你都做过哪些 Vue 的性能优化</a><li><a href=#class-与-style-如何实现动态绑定 class="table-of-contents__link toc-highlight">Class 与 Style 如何实现动态绑定</a><li><a href=#什么是函数式组件 class="table-of-contents__link toc-highlight">什么是函数式组件</a></ul><li><a href=#困难 class="table-of-contents__link toc-highlight">困难</a><ul><li><a href=#vuemixin-的使用场景和原理 class="table-of-contents__link toc-highlight">Vue.mixin 的使用场景和原理</a><li><a href=#nexttick-使用场景和原理 class="table-of-contents__link toc-highlight">nextTick 使用场景和原理</a><li><a href=#keep-alive-使用场景和原理 class="table-of-contents__link toc-highlight">keep-alive 使用场景和原理</a><li><a href=#vueset-方法原理 class="table-of-contents__link toc-highlight">Vue.set 方法原理</a><li><a href=#vueextend-作用和原理 class="table-of-contents__link toc-highlight">Vue.extend 作用和原理</a><li><a href=#vue-修饰符有哪些 class="table-of-contents__link toc-highlight">Vue 修饰符有哪些</a><li><a href=#vue-模板编译原理 class="table-of-contents__link toc-highlight">Vue 模板编译原理</a><li><a href=#生命周期钩子是如何实现的 class="table-of-contents__link toc-highlight">生命周期钩子是如何实现的</a><li><a href=#函数式组件使用场景和原理 class="table-of-contents__link toc-highlight">函数式组件使用场景和原理</a><li><a href=#能说下-vue-router-中常用的路由模式实现原理吗 class="table-of-contents__link toc-highlight">能说下 vue-router 中常用的路由模式实现原理吗</a><li><a href=#手写-vueextend class="table-of-contents__link toc-highlight">手写 Vue.extend</a><li><a href=#vue-router-中路由方法-pushstate-和-replacestate-能否触发-popsate-事件 class="table-of-contents__link toc-highlight">vue-router 中路由方法 pushState 和 replaceState 能否触发 popSate 事件</a><li><a href=#相比-vue2xvue-3-有哪些性能方面的提升 class="table-of-contents__link toc-highlight">相比 Vue2.x，Vue 3 有哪些性能方面的提升。</a><li><a href=#vue-router-路由钩子在生命周期的体现 class="table-of-contents__link toc-highlight">Vue-router 路由钩子在生命周期的体现</a></ul><li><a href=#参考文章 class="table-of-contents__link toc-highlight">参考文章</a></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>社区</div><ul class="footer__items clean-list"><li class=footer__item><a href="https://space.bilibili.com/488063421?spm_id_from=333.1007.0.0" target=_blank rel="noopener noreferrer" class=footer__link-item>bilibili<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://github.com/inshadow1 target=_blank rel="noopener noreferrer" class=footer__link-item>Github<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>联系</div><ul class="footer__items clean-list"><li class=footer__item><a href=# class=footer__link-item>微信号：q1601698207</a><li class=footer__item><a href=https://github.com/facebook/docusaurus target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 Yelv. Built with Docusaurus.<br><a href=https://beian.miit.gov.cn>鄂ICP备2025094277号</a></div></div></div></footer></div>