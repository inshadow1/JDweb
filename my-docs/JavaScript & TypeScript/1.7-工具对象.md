---
sidebar_position: 27
---

> Create by **fall** on 26 May 2021
> Recently revised in 06 Apr 2023

## Math

Math ç”¨äº Number ç±»å‹æ•°æ®å¤„ç†ã€‚å®ƒä¸æ”¯æŒ BigIntã€‚

| æ–¹æ³•             | ä½œç”¨                                                        |
| ---------------- | ----------------------------------------------------------- |
| `Math.abs()`     | è¿”å›å–ç»å¯¹å€¼                                                |
| `Math.max()`     | ä¼ å…¥é€—å·åˆ†å‰²çš„å¤šä¸ªæ•°ï¼Œè¿”å›æœ€å¤§çš„å‚æ•°                        |
| `Math.min()`     | ä¼ å…¥é€—å·åˆ†å‰²çš„å¤šä¸ªæ•°ï¼Œè¿”å›æœ€å°çš„å‚æ•°                        |
| `Math.round()`   | å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°                                      |
| `Math.ceil()`    | è¿”å›å‘ä¸Šå–æ•´çš„å€¼                                            |
| `Math.floor()`   | è¿”å›å‘ä¸‹å–æ•´çš„å€¼                                            |
| `Math.random()`  | è¿”å› 0~1 éšæœºæ•°ï¼Œæ— éœ€ä¼ å…¥å€¼                                 |
| `Math.E`         | å¸¸æ•° eâ‰ˆ2.71828                                              |
| `Math.trunc()`   | è¿”å›è¯¥æ•°å€¼çš„æ•´æ•°éƒ¨åˆ†                                        |
| `Math.sign()`    | è¿”å›æ•°å€¼çš„ç±»å‹ï¼Œ1 è¡¨ç¤ºæ­£æ•°ï¼Œ-1 è¡¨ç¤ºè´Ÿæ•°ï¼Œ0                  |
| `Math.cbrt()`    | è¿”å›æ•°å€¼ç«‹æ–¹æ ¹                                              |
| `Math.clz32()`   | è¿”å›æ•°å€¼çš„ 32 ä½æ— ç¬¦å·æ•´æ•°å½¢å¼ï¼Œå³32-è¯¥æ•°å€¼çš„äºŒè¿›åˆ¶è¡¨ç¤ºä½æ•° |
| `Math.imul(a,b)` | è¿”å›ä¸¤ä¸ªæ•°ç›¸ä¹˜                                              |
| `Math.fround()`  | è¿”å›æ•°å€¼çš„ 32 ä½å•ç²¾åº¦æµ®ç‚¹æ•°å½¢å¼                            |
| `Math.pow(x,y)`  | æ±‚ x çš„ y æ¬¡æ–¹                                              |

```js
Math.abs(-130) // 130
Math.max(22,66,99) // 99
Math.min(-22,66) // -22
Math.round(Math.PI) // 3
Math.round(Math.E) // 3
Math.ceil(1.1) // 2 å‘ä¸Šå–æ•´
Math.floor(1.9) // 1 å‘ä¸‹å–æ•´
```

- `Math.hypot()`  è¿”å›æ‰€æœ‰æ•°å€¼å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ `Math.hypot(4,4,4,4) == 8`    
- `Math.expm1()`ï¼š  è¿”å›`e^n - 1`
- `Math.log1p()`ï¼šè¿”å› 1 + n çš„è‡ªç„¶å¯¹æ•°(`Math.log(1 + n)`)
- `Math.log10()`ï¼šè¿”å›ä»¥ 10 ä¸ºåº•çš„ n çš„å¯¹æ•°
- `Math.log2()`ï¼šè¿”å›ä»¥ 2 ä¸ºåº•çš„nçš„å¯¹æ•°
- `Math.sinh()`ï¼šè¿”å› n çš„åŒæ›²æ­£å¼¦
- `Math.cosh()`ï¼šè¿”å› n çš„åŒæ›²ä½™å¼¦
- `Math.tanh()`ï¼šè¿”å› n çš„åŒæ›²æ­£åˆ‡
- `Math.asinh()`ï¼šè¿”å› n çš„ååŒæ›²æ­£å¼¦
- `Math.acosh()`ï¼šè¿”å› n çš„ååŒæ›²ä½™å¼¦
- `Math.atanh()`ï¼šè¿”å› n çš„ååŒæ›²æ­£åˆ‡

## RegExp

> æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¯¦æƒ…å¯è§[ã€æ­£åˆ™ã€‘](./1.6-æ­£åˆ™.md)

### å¯¹è±¡ç‰¹æ€§

```js
// æ­£åˆ™è¡¨è¾¾å¼çš„å£°æ˜
const reg1 = new RegExp('hello','ig') 
const reg2 = new RegExp(/xYz\d+/gi, i) // å¦‚æœä¼ å…¥äº†ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥ç¬¬äºŒä¸ªä¸ºå‡†
const reg3 = RegExp('hello','ig')
const reg4 = /hello/gi
// i è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼Œg è¡¨ç¤ºå¯ä»¥åŒæ—¶é€‰å–å¤šä¸ªï¼Œm è¡¨ç¤ºå¯ä»¥æ¢è¡ŒåŒ¹é…ï¼Œæ¯ä¸€è¡Œçš„å†…å®¹ç‹¬ç«‹ 
reg.flags // å¯ä»¥è¿”å›å½“å‰æ­£åˆ™çš„æ‰€æœ‰ä¿®é¥°ç¬¦
```

**ä¿®é¥°ç¬¦** 

- `u` å¤„ç†å¤§äº `\uFFFF `çš„ `Unicode` å­—ç¬¦
- `i` è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™
- `g` è¡¨ç¤ºå¯ä»¥åŒæ—¶é€‰å–å¤šä¸ª
- `m` è¡¨ç¤ºå¯ä»¥æ¢è¡ŒåŒ¹é…ï¼Œæ¯ä¸€è¡Œçš„å†…å®¹ç‹¬ç«‹
- `y` åŒæ ·æ˜¯å…¨å±€åŒ¹é…ï¼Œåªä¸è¿‡åŒ¹é…å¿…é¡»è¿åœ¨ä¸€èµ·
- `s` dotAllï¼Œåªè¦æœ‰ç‚¹ï¼Œå¯ä»¥ç”¨`.`ä»£æ›¿æ‰€æœ‰å­—ç¬¦

`u` ä¿®é¥°ç¬¦ï¼šå«ä¹‰ä¸º `Unicode` æ¨¡å¼ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº `\uFFFF` çš„ `Unicode` å­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå¾…åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­å¯èƒ½åŒ…å«æœ‰å¤§äº `\uFFFF` çš„å­—ç¬¦ï¼Œå°±å¿…é¡»åŠ ä¸Š `u` ä¿®é¥°ç¬¦ï¼Œæ‰èƒ½æ­£ç¡®å¤„ç†ã€‚

```js
// åŠ ä¸Š u ä¿®é¥°ç¬¦æ‰èƒ½è®© . å­—ç¬¦æ­£ç¡®è¯†åˆ«å¤§äº \uFFFF çš„å­—ç¬¦
/^.$/.test('ğŸ¤£')   // false
/^.$/u.test('ğŸ¤£')  // true

// å¤§æ‹¬å· Unicode å­—ç¬¦è¡¨ç¤ºæ³•å¿…é¡»åŠ ä¸Š u ä¿®é¥°ç¬¦
/\u{61}/.test('a')   // false
/\u{61}/u.test('a')  // true

// æœ‰ u ä¿®é¥°ç¬¦ï¼Œé‡è¯æ‰èƒ½æ­£ç¡®åŒ¹é…å¤§äº \uFFFF çš„å­—ç¬¦ 
/ğŸ¤£{2}/.test('ğŸ¤£ğŸ¤£')  // false
/ğŸ¤£{2}/u.test('ğŸ¤£ğŸ¤£') // true
```

`RegExp.prototype.unicode` å±æ€§è¡¨ç¤ºæ­£åˆ™æ˜¯å¦è®¾ç½®äº† `u` ä¿®é¥°ç¬¦ï¼š

```js
/ğŸ¤£/.unicode   // false
/ğŸ¤£/u.unicode  // true
```

`y` ä¿®é¥°ç¬¦ï¼Œä¸ `g` ä¿®é¥°ç¬¦ç±»ä¼¼ä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼›ä¸åŒçš„æ˜¯ `g` æ˜¯å‰©ä½™å­—ç¬¦ä¸­åŒ¹é…å³å¯ï¼Œè€Œ `y` åˆ™æ˜¯å¿…é¡»åœ¨å‰©ä½™çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹åŒ¹é…æ‰è¡Œï¼Œæ‰€ä»¥ `y` ä¿®é¥°ç¬¦ä¹Ÿå«é»è¿ä¿®é¥°ç¬¦ï¼š

```js
let s = 'aaa_aa_a'
let r1 = /a+/g
let r2 = /a+/y

r1.exec(s)  // ["aaa"]
r2.exec(s)  // ["aaa"]

r1.exec(s)  // ["aa"]
r2.exec(s)  // null
```

`RegExp.prototype.sticky` å±æ€§è¡¨ç¤ºæ˜¯å¦è®¾ç½®äº† `y` ä¿®é¥°ç¬¦ï¼š

```js
/abc/y.sticky  // true
```

`s` ä¿®é¥°ç¬¦ï¼Œå¼€å¯ dotAll æ¨¡å¼ï¼ŒES2018å¼•å…¥ï¼Œé€šè¿‡ `.` è¡¨ç¤ºä»»æ„å­—ç¬¦

```js
/fall.again/.test('fall\nagain') // false
/fall.again/s.test('fall\nagain') // true
```

å…·ååŒ¹é…ï¼Œå¯ä»¥å°†æ•è·çš„å­—ç¬¦ä¸²è¿›è¡Œå‘½åï¼Œé€šè¿‡å‘½åè¿›è¡Œå¿«é€ŸæŸ¥æ‰¾

æ²¡æœ‰ä½¿ç”¨å…·ååŒ¹é…

```js
let day = /(\d{4})-(\d{2})-(\d{2})/
let result = day.exec('2021-08-12')
// result[0] === '2021-08-12'
// result[1] === '2021'
// result[2] === '08'
// result[3] === '12'
```

ä½¿ç”¨å…·ååŒ¹é…

```js
let day = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/
let result = day.exec('2021-08-12')
// result.groups { year: "2021", month: "08", day: "12" }'
```

é…åˆç»“æ„èµ‹å€¼

```js
let {groups: {year, month, day}} = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/.exec('2021-08-12')
console.log(year, month, day)  // 2021 08 12
```

åè¡Œæ–­è¨€ `(?<=y)x`ï¼Œ`x` åªæœ‰åœ¨ `y` åé¢æ‰èƒ½åŒ¹é…ï¼š

```js
/(?<=\$)\d+/.exec('I have $100.')  // ['100']
// å¦å®šæ–­è¨€ï¼š (?<!y)xï¼Œx åªæœ‰ä¸åœ¨ y åé¢æ‰èƒ½åŒ¹é…ï¼š

/(?<!\$)\d+/.exec('I have $100.')  // ['00']
```

### å®ä¾‹æ–¹æ³•

- `reg.test()` æµ‹è¯•æ˜¯å¦ç¬¦åˆï¼Œè¿”å›`true` æˆ–è€… `false`
- `reg.dotAll()` æ£€æµ‹è¯¥æ­£åˆ™æ˜¯å¦å¤„åœ¨ dotAll æ¨¡å¼
- `reg.exec()` è¿”å›ç¬¦åˆçš„å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ã€‚

## JSON

JSON å¯¹è±¡åªæœ‰ä¸¤ä¸ªå®ä¾‹æ–¹æ³•ï¼Œå³

- `JSON.stringify()`
- `JSON.parse()`

### å®ä¾‹æ–¹æ³•

`JSON.stringify` 

åŸºæœ¬ç”¨æ³•ï¼š`JSON.stringify(value[, replacer [, space]])`

ç¬¬ä¸‰ä¸ªå‚æ•°ä½œç”¨æ˜¯æŒ‡å®š space ä¸ªç©ºæ ¼çš„ç¼©è¿›ï¼Œæƒ³è®©ä»£ç æ›´å¥½çœ‹ä¸€ç‚¹ï¼Œå°±å†™ä¸Šç©ºæ ¼ç¼©è¿›ï¼ˆå¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¯¹è±¡çš„è°ƒè¯•å¯èƒ½ä¼šç”¨åˆ°è¯¥å‚æ•°ï¼‰ã€‚

`0xD800` åˆ° `0xDFFF` ä¹‹é—´çš„ç ç‚¹ä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œæ‰€ä»¥ `JSON.stringify()` å¯¹å•ä¸ªç ç‚¹è¿›è¡Œæ“ä½œï¼Œå¦‚æœç¬¦åˆ `UTF-8` æ ‡å‡†ï¼Œä¼šè¿”å›å¯¹åº”çš„å­—ç¬¦ï¼Œå¦‚æœä¸æ»¡è¶³ä¼šè¿”å›å¯¹åº”çš„ç ç‚¹ã€‚

```js
let replacerFun = function (key, value) {
  console.log(key, value)
  if (key === 'name') { // å¦‚æœkey ç­‰äº name<ç›´æ¥è¿”å› undefined
    return undefined // è¿”å› undefined æ—¶ï¼Œè¯¥é”®å€¼å¯¹ç›´æ¥å¿½ç•¥ï¼Œ
  }
  return value
}
let myIntro = {
  name: 'fall',
  age: 25,
  like: 'FE'
}
JSON.stringify(myIntro, replacerFun) // {"age":25,"like":"FE"}
```

**å®ç°å¯¹è±¡çš„æ·±æ‹·è´**

```js
let info = {
  name:'fall'
  age: 25,
  like: 'FE'
}
function deepClone() {
  return JSON.parse(JSON.stringify(myIntro))
}
let copyMe = deepClone(myIntro)
copyMe.like = 'Front End'
console.log(myIntro, copyMe)
// { age: 25, like: 'FE' } { age: 25, like: 'Front End' }
```

> ç‰¹åˆ«æ³¨æ„ï¼š`JSON.stringify(Infinity)` ä¹‹åï¼Œä¼šå­˜å‚¨çš„æ˜¯ nullï¼Œè¯»å–åï¼Œä¸æ˜¯ Infinity
>
> ä»¥ä¸‹æƒ…å†µä½¿ç”¨ `JSON.stringify()` å¯èƒ½ä¼šå‡ºé”™ï¼Œè¯·ç¡®ä¿ä½¿ç”¨å‰æ²¡æœ‰ä¸€ä¸‹æƒ…å†µå‡ºç°ã€‚
>
> - è½¬æ¢å±æ€§å€¼ä¸­æœ‰ toJSON æ–¹æ³•æ—¶ã€‚æ–¹æ³•ä¸ä¼šè¢«JSON.stringify è¯†åˆ«ï¼Œä½†å¦‚æœæ˜¯ toJSONï¼Œè¯¥æ–¹æ³•ä¼šç›´æ¥è¢«æ‰§è¡Œï¼Œå¹¶ä¸”ä¸ä¼šè¿”å›ç”Ÿæˆçš„å­—ç¬¦ä¸²ã€‚è¯¦è§ä¾‹1ã€‚
> - è¢«è½¬æ¢å€¼ä¸­æœ‰ undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol å€¼ã€‚è¯¦è§ä¾‹2ã€ä¾‹3
> - å€¼ä¸º NaN å’Œ Infinityã€‚è¯¦è§ä¾‹2ã€ä¾‹3
> - ä»¥ symbol ä¸ºå±æ€§é”®çš„å±æ€§
> - åŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ŒobjAå¼•ç”¨ objBï¼Œå¹¶ä¸” objB å¼•ç”¨ objA
> - å…·æœ‰ä¸å¯æšä¸¾çš„å±æ€§å€¼æ—¶

```js
var num = Infinity
JSON.stringify(num) // "null"
```

```js
// ä¾‹1ï¼š
let author = {
  name:'fall',
  age:23,
  toJSON:function(){
    return "æˆåŠŸ"
  }
}
JSON.stringify(author) // "\"æˆåŠŸ\""
// ä¾‹2ï¼š
let author = {
  wife:undefined,
  money:Infinity,
  string:NaN,
  girlfriend:Symbol("she")
}
JSON.stringify(author) // "{\"money\":null,\"like\":null}"
// ä¾‹3
let nothing = [undefined,Infinity,NaN,Symbol("she")]
JSON.stringify(nothing)
// ä¾‹4
let author = Object.create(null, {
  name: { value: "fall", enumerable: true },
  age: { value: "23", enumerable: false },
})
JSON.stringify(author)
// {"name":"fall"}
```

## Proxy

ä»£ç†ï¼Œç”¨æ¥å®šä¹‰åŸºæœ¬æ“ä½œçš„è‡ªå®šä¹‰è¡Œä¸ºï¼Œå¯¹è¢«ä»£ç†å¯¹è±¡ `target` æ“ä½œä¹‹å‰ä¼šå…ˆè¿›è¡Œæ‹¦æˆªã€‚

- å®è´¨ä¸Šæ˜¯ç›®æ ‡å¯¹è±¡`target`çš„åŒ…è£…
- å¯ä»¥é€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¯¹ `target` è¿›è¡Œæ“ä½œï¼Œä¸¤è€…ç›¸äº’ç‹¬ç«‹å­˜åœ¨ï¼Œè¿›è¡Œæ“ä½œ
- åªæœ‰é€šè¿‡ proxyæ“ä½œæ—¶ï¼Œæ‰ä¼šè¢«é¢„è®¾çš„æ–¹æ³•æ‹¦æˆªã€‚ç›´æ¥æ“ä½œå¯¹è±¡ï¼Œä¸ä¼šå—åˆ°ä»»ä½•æ‹¦æˆªå½±å“ã€‚

```js
// åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡å†…æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯ targetï¼Œè¡¨ç¤ºè¢«ç›‘å¬å¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ˜¯ handlerï¼Œè¡¨ç¤ºåšå¦‚ä½•å¤„ç†
// let proxy = new Proxy(target,handler)
// ä»£ç†å¯¹è±¡çš„ä½¿ç”¨
let instance = new Proxy({user:'fall'},{
  get(target,propKey,receiver){
    return `ä½ å¥½å•Šï¼Œ${target.name}`
  }
})
// åœ¨å¯¹è¢«ä»£ç†å¯¹è±¡æ“ä½œæ—¶ï¼Œèƒ½è¿›è¡Œæ‹¦æˆªï¼Œå¹¶ä¸”è·å–çš„æ˜¯ä»£ç†å¤„ç†åçš„è¿”å›å€¼
instance.name // 'ä½ å¥½å•Šï¼Œfall'
```

å¦‚æœ `handler` æ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œé‚£ä¹ˆå¯¹å®ä¾‹çš„æ“ä½œå°±ä¼šè½¬å‘åˆ°ç›®æ ‡å¯¹è±¡èº«ä¸Šï¼ˆå¯¹ä»£ç†èµ‹å€¼ï¼Œç›´æ¥ä½œç”¨äº targetï¼‰

```js
let target = {}
let proxy = new Proxy(target, {})
proxy.name = 'å¸ƒå…°'
target.name  // 'å¸ƒå…°'
```

### handler

- `get` ç”¨äºæ‹¦æˆªå±æ€§çš„è¯»å–æ“ä½œ
- `set` ç”¨äºæ‹¦æˆªå¯¹è±¡çš„å±æ€§æ“ä½œ
- `has` æ‹¦æˆª `propKey in proxy` çš„æ“ä½œï¼Œè¡¨ç¤ºå±æ€§æ˜¯å¦å­˜åœ¨ã€‚
- `deleteProperty ` æ‹¦æˆª `delete` æ“ä½œ
- `ownKeys` æ‹¦æˆª `Object.keys()` `for...in` ç­‰å¾ªç¯
- `getOwnPropertyDescriptor` è·å–å¯¹è±¡ä¸Šå±æ€§çš„æè¿°å¯¹è±¡æ—¶çš„ä»£ç†
- `defineProperty` å‘½åå¯¹å‘ä¸Šçš„å±æ€§æè¿°æ—¶çš„ä»£ç†
- `preventExtensions` è®¾ç½®é˜²æ­¢æ‰©å±•å±æ€§æ˜¯çš„ä»£ç†
- `getPrototypeOf` è·å–
- `isExtensible` å¯å¦æ‰©å±•çš„
- `setPrototypeOf`
- `apply`
- `construct`

```js
let target={
  name:'fall'
}
let proxy = new Proxy(target, {
  get(target,propKey,receiver){},
  // æ‹¦æˆªå¯¹è±¡å±æ€§çš„è¯»å–ï¼Œtarget æŒ‡çš„æ˜¯è¢«ä»£ç†çš„å¯¹è±¡ï¼ŒpropKey æŒ‡å—åˆ°æ“ä½œçš„å¯¹è±¡ï¼Œreceiver è¡¨ç¤ºè¯¥ Proxy ä»£ç†å¯¹è±¡
  set(target,propKey,value,receiver){},
  // æ‹¦æˆªå¯¹äºå¯¹è±¡ä¸­å±æ€§å€¼çš„è®¾ç½®ï¼Œtarget æŒ‡çš„æ˜¯è¢«ä»£ç†çš„å¯¹è±¡ï¼ŒpropKey æŒ‡å—åˆ°æ“ä½œçš„å¯¹è±¡ï¼Œvalueè¡¨ç¤ºå±æ€§å¯¹åº”çš„å€¼ï¼Œreceiver è¡¨ç¤ºè¯¥ Proxy ä»£ç†å¯¹è±¡
  has(target,propKey){},
  // æ‹¦æˆª propKey in proxy æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼
  deleteProperty(target,propKey){},
  // æ‹¦æˆªåˆ é™¤ propKey çš„æ“ä½œ
  ownKeys(target){},
  // æ‹¦æˆªå¤šä¸ªObjectæ“ä½œï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„åŒ…æ‹¬æ‰€æœ‰å€¼ï¼Œä¸åŒäºObject.keys()ï¼Œå¯ä»¥è¿”å›Symbolå¯¹è±¡
})
```

### é™æ€æ–¹æ³•

`Proxy.revocable()` å®šä¹‰ä¸€ä¸ªå¯æ’¤é”€çš„ Proxy

```js
let target = {}
let handler = {}
let {proxy, revoke} = Proxy.revocable(target, handler)

proxy.foo = 123
proxy.foo  // 123
revoke() // æ‰§è¡Œç»“æ„çš„ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œå°±å¯ä»¥æ’¤é”€è¯¥ proxy
proxy.foo  // TypeError
```

### ç¤ºä¾‹

get ç¤ºä¾‹

```js
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  get(target,propKey,receiver){
    console.log(target) // target æŒ‡å‘çš„æ˜¯ staff 
    console.log(propKey) // propKey æŒ‡å‘çš„æ˜¯ key age
    console.log(receiver) // æŒ‡å‘çš„æ˜¯ proxyStaffï¼ˆä¸€èˆ¬ä¸ç”¨æ·»åŠ è¿™ä¸ªå‚æ•°ï¼‰
    // return `è°è®©ä½ è·å–è¿™ä¸ª${propKey}æ•°æ®çš„ï¼Ÿä¸ç»™ï¼`
    return 'nothing' // å¦‚æœæƒ³è¦ä½¿ç”¨é»˜è®¤è·å–å€¼çš„æ“ä½œï¼Œä½¿ç”¨è¯¥è¿”å›å€¼
  },
})
console.log(proxyStaff.age)
// å¦‚æœè·å–æœ¬èº«ä¸å­˜åœ¨çš„å€¼ï¼Œåˆ™è¿”å› undefined
// å¦‚æœå®šä¹‰äº† return 'nothing'ï¼Œé‚£ä¹ˆ
proxyStaff.career // 'nothing'
```

set ç¤ºä¾‹

```js
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  set(target,propKey,value,receiver){
    console.log(target)   // target æŒ‡å‘çš„æ˜¯ staff 
    console.log(propKey) // propKey æŒ‡å‘çš„æ˜¯ key age
    console.log(value) // æŒ‡å‘çš„æ˜¯èµ‹çš„å€¼ æ­¤å¤„ä¸º 23
    console.log(receiver)// æŒ‡å‘ä»£ç†å¯¹è±¡ï¼Œæ­¤å¤„æŒ‡å‘ proxyStaff
    target[propKey] = value
    // è¯¥å…³é”®å­—ä¸éœ€è¦ return ï¼Œåœ¨è¿™é‡Œæ— æ„ä¹‰  
  }
})
proxyStaff.age = 23
```

has ç¤ºä¾‹

```js
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  has(target,propKey){
    console.log(target)   // target æŒ‡å‘çš„æ˜¯ staff 
    console.log(propKey) // propKey æŒ‡å‘çš„æ˜¯ key age
    return propKey in target 
  }
})
if('age' in proxyStaff){
  console.log(proxyStaff.age)
}
```

deleteProperty ç¤ºä¾‹

```js
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  deleteProperty(target,propKey){
    return delete proxyStaff.age // æ­¤å¤„åªèƒ½è¿”å› true & falseï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸ
  }
})
if('age' in proxyStaff){
  delete proxyStaff.age 
  console.log(proxyStaff)
}
```

ownKeys ç¤ºä¾‹

```js
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  ownKeys(target){
    return Object.keys(target) 
    // ç”¨äºæ‹¦æˆª Object.getOwnPropertyNames()ã€Object.keys()ã€Object.getOwnPropertySymbols()ã€for...in ç­‰å¾ªç¯ç±»æ“ä½œ
  }
})
console.log(Object.keys(proxyStaff))
```

`getOwnPropertyDescriptor` æ–¹æ³•

```js
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  getOwnPropertyDescriptor(target,propKey){
    return Object.getOwnPropertyDescriptor(target,propKey) 
    // ç”¨äºæ‹¦æˆª Object.getOwnPropertyDescriptor()
  }
})
console.log(Object.getOwnPropertyDescriptor(proxyStaff,'name'))
```

`defineProperty` æ–¹æ³•

```js
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  defineProperty(target,propKey,propKeyDesc){
    return Object.defineProperty(target,propKey,propKeyDesc) 
    // ç”¨äºæ‹¦æˆª Object.defineProperty() propKeyDesc æ˜¯å¯å®šä¹‰çš„å¯¹è±¡çš„å±æ€§
  }
})
console.log(Object.defineProperty(proxyStaff,'hobby',{value:'beauty'}))
```

`preventExtension` æ–¹æ³•

```js
let staff = {
  name:'fall'
}
const proxyStaff = new Proxy(staff,{
  preventExtensions(target){
    return Object.preventExtensions(target) 
    // ç”¨äºæ‹¦æˆª Object.defineProperty() propKeyDesc æ˜¯å¯å®šä¹‰çš„å¯¹è±¡çš„å±æ€§
  }
})
Object.preventExtensions(proxyStaff)
proxyStaff.age = 23
console.log(proxyStaff.age) // undefined
```

`getPrototypeOf` æ–¹æ³•

```js
let staff = {
  name:'fall'
}
const proxyStaff = new Proxy(staff,{
  getPrototypeOf(target){
    return Object.getPrototypeOf(target) 
  }
})
console.log(Object.getPrototypeOf(proxyStaff)) 
```

`isExtensible` æ–¹æ³•

```js
let staff = {
  name:'fall'
}
const proxyStaff = new Proxy(staff,{
  isExtensible(target){
    return Object.isExtensible(target)// è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å¯ä»¥æ‰©å±•
    // return false  // ç›´æ¥è¿”å› false ä¼šæŠ¥é”™
  }
})
console.log(Object.isExtensible(proxyStaff)) 
```

`setPrototypeOf` æ–¹æ³•

```js
// è°ƒç”¨ Object.setPrototypeOf() æ—¶ï¼Œä¼šè§¦å‘è¯¥å‡½æ•°
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  setPrototypeOf(target,proto){
    // è®¾ç½®åŸå‹æ–¹æ³•ä¼šè°ƒç”¨è¯¥å‡½æ•°
    console.log(`å‘${target}çš„ä¸Šï¼Œè®¾ç½®äº†${proto}åŸå‹`);
    return Object.setPrototypeOf(target,proto) 
  }
})
console.log(Object.setPrototypeOf(proxyStaff,{}))
```

apply æ–¹æ³•

```js
// è°ƒç”¨ Object.setPrototypeOf() æ—¶ï¼Œä¼šè§¦å‘è¯¥å‡½æ•°
function app(x,y){return x+y}
const proxyStaff = new Proxy(app,{
  apply(target,object,args){
    // object æ˜¯ this å‚æ•°çš„æŒ‡å‘
    // args æ˜¯å‚æ•°åˆ—è¡¨
    console.log('è°ƒç”¨äº†è¯¥appæ–¹æ³•') 
    return app.call(object,...args) 
  }
})
console.log(app(5,6))
```

construct æ–¹æ³•

```js
// è°ƒç”¨ Object.setPrototypeOf() æ—¶ï¼Œä¼šè§¦å‘è¯¥å‡½æ•°
function App(x,y){return x+y}
const proxyStaff = new Proxy(App,{
  construct(target,args){
    console.log(args[0]);
    return new App(...args)
  }
})
console.log(new proxyStaff(42,12))
```

## Reflect

Reflect ä¸æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä¸èƒ½é€šè¿‡ `new` è¿›è¡Œè°ƒç”¨ï¼Œæ›´åƒæ˜¯ Mathï¼Œæä¾›äº†å¾ˆå¤šé™æ€æ–¹æ³•æä¾›è°ƒç”¨ã€‚



Reflect çš„ä½œç”¨æ˜¯æ¢å¤åˆ°åŸæ¥çš„é»˜è®¤å€¼æ“ä½œ

- å®ƒæä¾›æ‹¦æˆª `JavaScript` æ“ä½œçš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¸ `proxy handlers` çš„æ–¹æ³•ç›¸åŒã€‚
- è®¾è®¡çš„ç›®çš„ï¼š
  - å°† `Object` å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•æ”¾åˆ° `Reflect` ä¸Šï¼›
  - ä¿®æ”¹æŸäº› `Object` æ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ï¼›
  - è®© `Object` æ“ä½œå˜æˆå‡½æ•°è¡Œä¸º
  - `Proxy handles` ä¸ `Reflect` æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œå‰è€…ç”¨äºå®šä¹‰è‡ªå®šä¹‰è¡Œä¸ºï¼Œè€Œåè€…ç”¨äºæ¢å¤é»˜è®¤è¡Œä¸ºï¼› 

### é™æ€æ–¹æ³•

- `Reflect.apply(target, thisArgument, argumentsList)` å¯¹ä¸€ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨æ“ä½œï¼ŒåŒæ—¶å¯ä»¥ä¼ å…¥ä¸€ä¸ªæ•°ç»„ä½œä¸ºè°ƒç”¨å‚æ•°ã€‚å’Œ `Function.prototype.apply()` åŠŸèƒ½ç±»ä¼¼ï¼›
- `Reflect.construct(target, argumentsList[, newTarget])` å¯¹æ„é€ å‡½æ•°è¿›è¡Œ `new` æ“ä½œï¼Œç›¸å½“äºæ‰§è¡Œ `new target(...args)`ï¼›
- `Reflect.defineProperty(target, propertyKey, attributes)` å’Œ `Object.defineProperty()` ç±»ä¼¼ã€‚å¦‚æœè®¾ç½®æˆåŠŸå°±ä¼šè¿”å› `true`ï¼›
- `Reflect.deleteProperty(target, propertyKey)` ä½œä¸ºå‡½æ•°çš„ `delete` æ“ä½œç¬¦ï¼Œç›¸å½“äºæ‰§è¡Œ `delete target[name]`ï¼›
- `Reflect.get(target, propertyKey[, receiver])` è·å–å¯¹è±¡èº«ä¸ŠæŸä¸ªå±æ€§çš„å€¼ï¼Œç±»ä¼¼äº `target[name]`ï¼›
- `Reflect.getOwnPropertyDescriptor(target, propertyKey)` ç±»ä¼¼äº `Object.getOwnPropertyDescriptor()`ã€‚å¦‚æœå¯¹è±¡ä¸­å­˜åœ¨è¯¥å±æ€§ï¼Œåˆ™è¿”å›å¯¹åº”çš„å±æ€§æè¿°ç¬¦,  å¦åˆ™è¿”å› `undefined`ï¼›
- `Reflect.getPrototypeOf(target)` ç±»ä¼¼äº `Object.getPrototypeOf()`ï¼›
- `Reflect.has(target, propertyKey)` åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨æŸä¸ªå±æ€§ï¼Œå’Œ `in` è¿ç®—ç¬¦ çš„åŠŸèƒ½å®Œå…¨ç›¸åŒï¼›
- `Reflect.isExtensible(target)` ç±»ä¼¼äº `Object.isExtensible()`ï¼›
- `Reflect.ownKeys(target)` è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰è‡ªèº«å±æ€§ï¼ˆä¸åŒ…å«ç»§æ‰¿å±æ€§ï¼‰çš„æ•°ç»„ã€‚(ç±»ä¼¼äº `Object.keys()`, ä½†ä¸ä¼šå— `enumerable` å½±å“)ï¼›
- `Reflect.preventExtensions(target)` ç±»ä¼¼äº `Object.preventExtensions()`ã€‚è¿”å›ä¸€ä¸ª `Boolean`ï¼›
- `Reflect.set(target, propertyKey, value[, receiver])` å°†å€¼åˆ†é…ç»™å±æ€§çš„å‡½æ•°ã€‚è¿”å›ä¸€ä¸ª `Boolean`ï¼Œå¦‚æœæ›´æ–°æˆåŠŸï¼Œåˆ™è¿”å› `true`ï¼›
- `Reflect.setPrototypeOf(target, prototype)` è®¾ç½®å¯¹è±¡åŸå‹çš„å‡½æ•°. è¿”å›ä¸€ä¸ª `Boolean`ï¼Œ å¦‚æœæ›´æ–°æˆåŠŸï¼Œåˆ™è¿”å› `true`ï¼›

Proxy å’Œ Reflect æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œæ‰€ä»¥åˆèµ·æ¥å°±æœ‰ä¸€ä¸ªç¤ºä¾‹

### ç¤ºä¾‹

```js
// è¿™æ®µä»£ç ä¸­æœ‰åœ°æ–¹å®Œè›‹äº†ï¼Œåº”è¯¥æ˜¯reflectæ˜¯ç”¨é”™äº†ï¼Œçœ‹çœ‹é”™åœ¨å“ªäº†
let staff = {
  name:'fall',
  age:13
}
const proxyStaff = new Proxy(staff,{
  get(target,propKey,receiver){
    console.log(target) // target æŒ‡å‘çš„æ˜¯ staff 
    console.log(propKey) // propKey æŒ‡å‘çš„æ˜¯ key age
    console.log(receiver) // æŒ‡å‘çš„æ˜¯ proxyStaffï¼ˆä¸€èˆ¬å°±ä¸ç”¨æ·»åŠ è¿™ä¸ªå‚æ•°äº†ï¼‰
    // return `è°è®©ä½ è·å–è¿™ä¸ª${propKey}æ•°æ®çš„ï¼Ÿä¸ç»™ï¼`
    return Reflect.get(target, propKey) // å¦‚æœæƒ³è¦ä½¿ç”¨é»˜è®¤è·å–å€¼çš„æ“ä½œï¼Œä½¿ç”¨è¯¥è¿”å›å€¼
  },
  set(target,propKey,value){
    console.log(target)   // target æŒ‡å‘çš„æ˜¯ staff 
    console.log(propKey) // propKey æŒ‡å‘çš„æ˜¯ key age
    console.log(value) // æŒ‡å‘çš„æ˜¯èµ‹çš„å€¼ æ­¤å¤„ä¸º 23
    // target[propKey] = receiver //åœ¨æ­¤å¤„æ„ä¸ºï¼šå°†staff.age è®¾ç½®ä¸º 23 
    return Reflect.set(target,propKey,value) // å¦‚æœæƒ³è¦ä½¿ç”¨é»˜è®¤è·å–å€¼çš„æ“ä½œï¼Œä½¿ç”¨è¯¥è¿”å›å€¼
  },
  deleteProperty(target,propKey){
    console.log(target) 			// target æŒ‡å‘çš„æ˜¯ staff 
    console.log(propKey)			// propKey æŒ‡å‘çš„æ˜¯ key age
    return Reflect.deleteProperty(target,propKey) // å¦‚æœæƒ³è¦ä½¿ç”¨é»˜è®¤è·å–å€¼çš„æ“ä½œï¼Œä½¿ç”¨è¯¥è¿”å›å€¼
  } 
})

delete proxyStaff.age
proxyStaff.age= 23
console.log(proxyStaff.age);
```

## å‚è€ƒæ–‡ç« 

| ä½œè€…   | é“¾æ¥                                   |
| ------ | -------------------------------------- |
| Gopal1 | https://www.jianshu.com/p/b714dc8e068e |
|        |                                        |



